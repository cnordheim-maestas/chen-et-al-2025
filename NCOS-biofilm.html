<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Caitlin Nordheim-Maestas">

<title>NCOS biofilm</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="NCOS-biofilm_files/libs/clipboard/clipboard.min.js"></script>
<script src="NCOS-biofilm_files/libs/quarto-html/quarto.js"></script>
<script src="NCOS-biofilm_files/libs/quarto-html/popper.min.js"></script>
<script src="NCOS-biofilm_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="NCOS-biofilm_files/libs/quarto-html/anchor.min.js"></script>
<link href="NCOS-biofilm_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="NCOS-biofilm_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="NCOS-biofilm_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="NCOS-biofilm_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="NCOS-biofilm_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article toc-left">
<div id="quarto-sidebar-toc-left" class="sidebar toc-left">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#goal-re-create-renweis-visualizations-in-r-and-run-stats-across-treatments-and-time" id="toc-goal-re-create-renweis-visualizations-in-r-and-run-stats-across-treatments-and-time" class="nav-link active" data-scroll-target="#goal-re-create-renweis-visualizations-in-r-and-run-stats-across-treatments-and-time">Goal: Re-create Renwei’s visualizations in R and run stats across treatments and time</a></li>
  <li><a href="#data-reformatting-and-cleaning" id="toc-data-reformatting-and-cleaning" class="nav-link" data-scroll-target="#data-reformatting-and-cleaning">Data reformatting and cleaning</a></li>
  <li><a href="#visualizations" id="toc-visualizations" class="nav-link" data-scroll-target="#visualizations">Visualizations</a>
  <ul class="collapse">
  <li><a href="#b-pond-water" id="toc-b-pond-water" class="nav-link" data-scroll-target="#b-pond-water">2b: Pond water</a>
  <ul class="collapse">
  <li><a href="#renweis-figure" id="toc-renweis-figure" class="nav-link" data-scroll-target="#renweis-figure">Renwei’s figure</a></li>
  <li><a href="#caitlins-version" id="toc-caitlins-version" class="nav-link" data-scroll-target="#caitlins-version">Caitlin’s version</a></li>
  </ul></li>
  <li><a href="#b-eda" id="toc-b-eda" class="nav-link" data-scroll-target="#b-eda">2b EDA</a>
  <ul class="collapse">
  <li><a href="#visualize-y-var-bd-load" id="toc-visualize-y-var-bd-load" class="nav-link" data-scroll-target="#visualize-y-var-bd-load">visualize y var: bd load</a></li>
  </ul></li>
  <li><a href="#b-stats" id="toc-b-stats" class="nav-link" data-scroll-target="#b-stats">2b Stats</a></li>
  <li><a href="#null" id="toc-null" class="nav-link" data-scroll-target="#null">null</a></li>
  <li><a href="#best-model-bd-daymicrobestb" id="toc-best-model-bd-daymicrobestb" class="nav-link" data-scroll-target="#best-model-bd-daymicrobestb">Best model: Bd ~ day*microbes*TB</a></li>
  <li><a href="#bd-day-treatment" id="toc-bd-day-treatment" class="nav-link" data-scroll-target="#bd-day-treatment">Bd ~ day + treatment</a></li>
  <li><a href="#no-interactions-bd-day-microbes-pw-tb" id="toc-no-interactions-bd-day-microbes-pw-tb" class="nav-link" data-scroll-target="#no-interactions-bd-day-microbes-pw-tb">No interactions: Bd ~ day + microbes + PW + TB</a></li>
  </ul></li>
  <li><a href="#b-aquatic-environmental-biofilm-on-bd-growth" id="toc-b-aquatic-environmental-biofilm-on-bd-growth" class="nav-link" data-scroll-target="#b-aquatic-environmental-biofilm-on-bd-growth">3b Aquatic environmental biofilm on Bd growth:</a>
  <ul class="collapse">
  <li><a href="#renweis-figure-1" id="toc-renweis-figure-1" class="nav-link" data-scroll-target="#renweis-figure-1">Renwei’s figure</a></li>
  <li><a href="#ggplot-version-replicating-renweis-ae" id="toc-ggplot-version-replicating-renweis-ae" class="nav-link" data-scroll-target="#ggplot-version-replicating-renweis-ae">ggplot version: replicating Renwei’s AE</a></li>
  <li><a href="#caitlins-version-ae" id="toc-caitlins-version-ae" class="nav-link" data-scroll-target="#caitlins-version-ae">Caitlin’s version AE</a></li>
  <li><a href="#b-eda-1" id="toc-b-eda-1" class="nav-link" data-scroll-target="#b-eda-1">3b EDA</a>
  <ul class="collapse">
  <li><a href="#visualize-y-var-bd-load-1" id="toc-visualize-y-var-bd-load-1" class="nav-link" data-scroll-target="#visualize-y-var-bd-load-1">visualize y var: bd load</a></li>
  </ul></li>
  <li><a href="#b-stats-1" id="toc-b-stats-1" class="nav-link" data-scroll-target="#b-stats-1">3b Stats</a></li>
  <li><a href="#null-1" id="toc-null-1" class="nav-link" data-scroll-target="#null-1">null</a></li>
  <li><a href="#bd-daymedium" id="toc-bd-daymedium" class="nav-link" data-scroll-target="#bd-daymedium">Bd ~ day*medium</a></li>
  </ul></li>
  <li><a href="#b-monolayer-biofilm-on-bd-growth" id="toc-b-monolayer-biofilm-on-bd-growth" class="nav-link" data-scroll-target="#b-monolayer-biofilm-on-bd-growth">4b Monolayer biofilm on Bd growth:</a>
  <ul class="collapse">
  <li><a href="#renweis-figure-2" id="toc-renweis-figure-2" class="nav-link" data-scroll-target="#renweis-figure-2">Renwei’s figure</a></li>
  <li><a href="#ggplot-version-replicating-renweis-ml" id="toc-ggplot-version-replicating-renweis-ml" class="nav-link" data-scroll-target="#ggplot-version-replicating-renweis-ml">ggplot version: replicating Renwei’s ML</a></li>
  <li><a href="#caitlins-version-ml" id="toc-caitlins-version-ml" class="nav-link" data-scroll-target="#caitlins-version-ml">Caitlin’s version ML</a></li>
  </ul></li>
  <li><a href="#b-eda-2" id="toc-b-eda-2" class="nav-link" data-scroll-target="#b-eda-2">4b EDA</a>
  <ul class="collapse">
  <li><a href="#visualize-y-var-bd-load-2" id="toc-visualize-y-var-bd-load-2" class="nav-link" data-scroll-target="#visualize-y-var-bd-load-2">visualize y var: bd load</a></li>
  <li><a href="#b-stats-2" id="toc-b-stats-2" class="nav-link" data-scroll-target="#b-stats-2">4b Stats</a></li>
  <li><a href="#null-2" id="toc-null-2" class="nav-link" data-scroll-target="#null-2">null</a></li>
  <li><a href="#best-model-bd-daymicrobestb-1" id="toc-best-model-bd-daymicrobestb-1" class="nav-link" data-scroll-target="#best-model-bd-daymicrobestb-1">Best model: Bd ~ day*microbes*TB</a></li>
  </ul></li>
  </ul>
</nav>
</div>
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">NCOS biofilm</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Caitlin Nordheim-Maestas </p>
          </div>
  </div>
    
  
    
  </div>
  

</header>

<section id="goal-re-create-renweis-visualizations-in-r-and-run-stats-across-treatments-and-time" class="level1">
<h1>Goal: Re-create Renwei’s visualizations in R and run stats across treatments and time</h1>
<p>See Renwei’s excel version here: <a href="https://drive.google.com/file/d/1Dy_jAW0lTQZohf7V-l5VxQ_LrNLP9Aai/view?usp=sharing" class="uri">https://drive.google.com/file/d/1Dy_jAW0lTQZohf7V-l5VxQ_LrNLP9Aai/view?usp=sharing</a></p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="do">## read in and clean data</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse) <span class="co"># for cleaning and viewing data</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(here) <span class="co"># for importing data</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggpubr)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rstatix)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(multcomp)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(nlme)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(emmeans)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>fig_2b_raw <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="fu">here</span>(<span class="st">"data"</span>, <span class="st">"final_NCOS_2024_reformatted_for_R.xlsx - Fig2B.csv"</span>))</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>fig_3b_raw <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="fu">here</span>(<span class="st">"data"</span>, <span class="st">"final_NCOS_2024_reformatted_for_R.xlsx - Fig3B.csv"</span>))</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>fig_4b_raw <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="fu">here</span>(<span class="st">"data"</span>, <span class="st">"final_NCOS_2024_reformatted_for_R.xlsx - Fig4B.csv"</span>))</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="co"># set up custom theme</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>myCustomTheme <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">family =</span> <span class="st">"Times"</span>, <span class="at">color =</span> <span class="st">"black"</span>),</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">family =</span> <span class="st">"Times"</span>, <span class="at">color =</span> <span class="st">"black"</span>),</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">r =</span> <span class="dv">15</span>), <span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">family =</span> <span class="st">"Times"</span>, <span class="at">color =</span> <span class="st">"black"</span>), <span class="co"># Add space between y-axis label and axis</span></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>          <span class="at">title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">family =</span> <span class="st">"Times"</span>),</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>          <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">face =</span> <span class="st">"italic"</span>, <span class="at">family =</span> <span class="st">"Times"</span>),</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>          <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">family =</span> <span class="st">"Times"</span>), <span class="co"># Increase legend text size</span></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>          <span class="at">panel.grid.major.x =</span> <span class="fu">element_blank</span>(), <span class="co"># Remove major vertical grid lines</span></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>          <span class="at">panel.grid.minor.x =</span> <span class="fu">element_blank</span>()) <span class="co"># Set axes ticks color to black</span></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="data-reformatting-and-cleaning" class="level1">
<h1>Data reformatting and cleaning</h1>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="do">## 2B</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="co"># add column for microbes or no</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>pw <span class="ot">&lt;-</span> fig_2b_raw <span class="sc">%&gt;%</span> </span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">microbes =</span> <span class="fu">case_when</span>(</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_detect</span>(sample_ID, <span class="st">"</span><span class="sc">\\</span><span class="st">+microorganism"</span>) <span class="sc">~</span> <span class="st">"y"</span>,</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"n"</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span> </span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add column for TB or no</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">TB =</span> <span class="fu">case_when</span>(</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_detect</span>(sample_ID, <span class="st">"TB"</span>) <span class="sc">~</span> <span class="st">"y"</span>,</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"n"</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span> </span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add column for PW or no</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">PW =</span> <span class="fu">case_when</span>(</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_detect</span>(sample_ID, <span class="st">"PW"</span>) <span class="sc">~</span> <span class="st">"y"</span>,</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"n"</span></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>pw_summary <span class="ot">&lt;-</span> pw <span class="sc">%&gt;%</span> </span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(day, sample_ID) <span class="sc">%&gt;%</span> </span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">reframe</span>(<span class="at">mean =</span> <span class="fu">mean</span>(adh_plus_sup), <span class="co"># calculate the mean</span></span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>            <span class="at">n =</span> <span class="fu">length</span>(adh_plus_sup), <span class="co"># count the number of observations</span></span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>            <span class="at">df =</span> n <span class="sc">-</span> <span class="dv">1</span>, <span class="co"># calculate the degrees of freedom</span></span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>            <span class="at">sd =</span> <span class="fu">sd</span>(adh_plus_sup), <span class="co"># calculate the standard deviation</span></span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>            <span class="at">se =</span> sd<span class="sc">/</span><span class="fu">sqrt</span>(n), <span class="co"># calculate the standard error</span></span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>          ) <span class="sc">%&gt;%</span> </span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">microbes =</span> <span class="fu">case_when</span>(</span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_detect</span>(sample_ID, <span class="st">"</span><span class="sc">\\</span><span class="st">+microorganism"</span>) <span class="sc">~</span> <span class="st">"y"</span>,<span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"n"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add column for TB or no</span></span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">TB =</span> <span class="fu">case_when</span>(<span class="fu">str_detect</span>(sample_ID, <span class="st">"TB"</span>) <span class="sc">~</span> <span class="st">"y"</span>, <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"n"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add column for PW or no</span></span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">PW =</span> <span class="fu">case_when</span>(<span class="fu">str_detect</span>(sample_ID, <span class="st">"PW"</span>) <span class="sc">~</span> <span class="st">"y"</span>, <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"n"</span>)) </span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a><span class="do">## aquatic environmental biofilm (4b but I think its supposed to be 3b)</span></span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a><span class="co"># add column for microbes or no</span></span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true" tabindex="-1"></a>ae <span class="ot">&lt;-</span> fig_3b_raw <span class="sc">%&gt;%</span> </span>
<span id="cb2-38"><a href="#cb2-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">sample_ID =</span> Adherent.sample.ID) <span class="sc">%&gt;%</span> </span>
<span id="cb2-39"><a href="#cb2-39" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-40"><a href="#cb2-40" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add columns for components y/n</span></span>
<span id="cb2-41"><a href="#cb2-41" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add column for TB or no</span></span>
<span id="cb2-42"><a href="#cb2-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">TB =</span> <span class="fu">case_when</span>(</span>
<span id="cb2-43"><a href="#cb2-43" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_detect</span>(sample_ID, <span class="st">"TB"</span>) <span class="sc">~</span> <span class="st">"y"</span>,</span>
<span id="cb2-44"><a href="#cb2-44" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"n"</span></span>
<span id="cb2-45"><a href="#cb2-45" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span> </span>
<span id="cb2-46"><a href="#cb2-46" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add column for PW or no</span></span>
<span id="cb2-47"><a href="#cb2-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">PW =</span> <span class="fu">case_when</span>(</span>
<span id="cb2-48"><a href="#cb2-48" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_detect</span>(sample_ID, <span class="st">"PW"</span>) <span class="sc">~</span> <span class="st">"y"</span>,</span>
<span id="cb2-49"><a href="#cb2-49" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"n"</span></span>
<span id="cb2-50"><a href="#cb2-50" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb2-51"><a href="#cb2-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-52"><a href="#cb2-52" aria-hidden="true" tabindex="-1"></a><span class="do">## Monolayer (3b but I think its supposed tobe 4b)</span></span>
<span id="cb2-53"><a href="#cb2-53" aria-hidden="true" tabindex="-1"></a><span class="co"># add column for microbes or no</span></span>
<span id="cb2-54"><a href="#cb2-54" aria-hidden="true" tabindex="-1"></a>monolayer <span class="ot">&lt;-</span> fig_4b_raw <span class="sc">%&gt;%</span> </span>
<span id="cb2-55"><a href="#cb2-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">sample_ID =</span> sample.ID) <span class="sc">%&gt;%</span> </span>
<span id="cb2-56"><a href="#cb2-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">adh_plus_sup =</span> ahd_plus_sup) <span class="sc">%&gt;%</span> </span>
<span id="cb2-57"><a href="#cb2-57" aria-hidden="true" tabindex="-1"></a>  <span class="co"># rename sample_id to only include treatment, not day</span></span>
<span id="cb2-58"><a href="#cb2-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sample_ID =</span> <span class="fu">str_replace</span>(sample_ID, <span class="st">"-D[0-9]+$"</span>, <span class="st">""</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb2-59"><a href="#cb2-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-60"><a href="#cb2-60" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add columns for components y/n</span></span>
<span id="cb2-61"><a href="#cb2-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">microbes =</span> <span class="fu">case_when</span>(</span>
<span id="cb2-62"><a href="#cb2-62" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_detect</span>(sample_ID, <span class="st">"</span><span class="sc">\\</span><span class="st">+microbes"</span>) <span class="sc">~</span> <span class="st">"y"</span>,</span>
<span id="cb2-63"><a href="#cb2-63" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"n"</span></span>
<span id="cb2-64"><a href="#cb2-64" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span> </span>
<span id="cb2-65"><a href="#cb2-65" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add column for TB or no</span></span>
<span id="cb2-66"><a href="#cb2-66" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">TB =</span> <span class="fu">case_when</span>(</span>
<span id="cb2-67"><a href="#cb2-67" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_detect</span>(sample_ID, <span class="st">"TB"</span>) <span class="sc">~</span> <span class="st">"y"</span>,</span>
<span id="cb2-68"><a href="#cb2-68" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"n"</span></span>
<span id="cb2-69"><a href="#cb2-69" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span> </span>
<span id="cb2-70"><a href="#cb2-70" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add column for PW or no</span></span>
<span id="cb2-71"><a href="#cb2-71" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">PW =</span> <span class="fu">case_when</span>(</span>
<span id="cb2-72"><a href="#cb2-72" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_detect</span>(sample_ID, <span class="st">"PW"</span>) <span class="sc">~</span> <span class="st">"y"</span>,</span>
<span id="cb2-73"><a href="#cb2-73" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"n"</span></span>
<span id="cb2-74"><a href="#cb2-74" aria-hidden="true" tabindex="-1"></a>  ))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="visualizations" class="level1">
<h1>Visualizations</h1>
<section id="b-pond-water" class="level2">
<h2 class="anchored" data-anchor-id="b-pond-water">2b: Pond water</h2>
<section id="renweis-figure" class="level3">
<h3 class="anchored" data-anchor-id="renweis-figure">Renwei’s figure</h3>
<div class="quarto-figure quarto-figure-left">
<figure class="figure">
<p><img src="data/fig_2b_Renweiexcelversion.jpg" class="img-fluid figure-img" style="width:4in"></p>
</figure>
</div>
</section>
<section id="caitlins-version" class="level3">
<h3 class="anchored" data-anchor-id="caitlins-version">Caitlin’s version</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>fig_2b <span class="ot">&lt;-</span> pw_summary <span class="sc">%&gt;%</span> </span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># reorder to match Renwei's plot</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sample_ID =</span> <span class="fu">factor</span>(sample_ID, </span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>                            <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"1%TB"</span>, <span class="st">"MQ"</span>, <span class="st">"1%TB+PW+microorganism"</span>, <span class="st">"PW+microorganism"</span>, <span class="st">"1%TB+PW-microorganism"</span>, <span class="st">"PW-microorganism"</span>, <span class="st">"Added Bd"</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> day, </span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> mean, </span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>           <span class="at">color =</span> sample_ID)) <span class="sc">+</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> mean <span class="sc">-</span> se, <span class="co"># plot the standard error</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>                    <span class="at">ymax =</span> mean <span class="sc">+</span> se),</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>                <span class="at">width =</span> <span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="fl">1e3</span>, <span class="fl">1e8</span>), </span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>                <span class="at">breaks =</span> <span class="fu">c</span>(<span class="fl">1e3</span>, <span class="fl">1e4</span>, <span class="fl">1e5</span>, <span class="fl">1e6</span>, <span class="fl">1e7</span>, <span class="fl">1e8</span>)) <span class="sc">+</span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># vibes</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a> <span class="co"># vibes</span></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Day"</span>,</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Bd Quantity per sample (ZE/well)"</span>,</span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">"Medium"</span>,       <span class="co"># Title for color legend</span></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>       <span class="at">linetype =</span> <span class="st">"Microbes Present"</span>  <span class="co"># Title for linetype legend</span></span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>       ) <span class="sc">+</span></span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"1%TB"</span> <span class="ot">=</span> <span class="st">"#CCBB44"</span>, </span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"MQ"</span> <span class="ot">=</span> <span class="st">"#228833"</span>, </span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"1%TB+PW+microorganism"</span> <span class="ot">=</span> <span class="st">"#4477AA"</span>, </span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"PW+microorganism"</span> <span class="ot">=</span> <span class="st">"#EE6677"</span>, </span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"1%TB+PW-microorganism"</span> <span class="ot">=</span> <span class="st">"#66CCEE"</span>,</span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>                                <span class="co">#"Added Bd" = "#BBBBBB" # removed bc not really a medium</span></span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"PW-microorganism"</span> <span class="ot">=</span> <span class="st">"#AA3377"</span>),  <span class="co"># Assign specific colors to match RC's plot</span></span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a>                    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"1%TB"</span> <span class="ot">=</span> <span class="st">"TB"</span>,</span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"MQ"</span> <span class="ot">=</span> <span class="st">"MQ"</span>,</span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"1%TB+PW+microorganism"</span> <span class="ot">=</span> <span class="st">"TB + PW + MO"</span>,</span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"PW+microorganism"</span> <span class="ot">=</span> <span class="st">"PW + MO"</span>,</span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"1%TB+PW-microorganism"</span> <span class="ot">=</span> <span class="st">"TB + PW - MO"</span>,</span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"PW-microorganism"</span> <span class="ot">=</span> <span class="st">"PW - MO"</span>,</span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"Added Bd"</span> <span class="ot">=</span> <span class="st">"Initial Bd"</span>)) <span class="sc">+</span> <span class="co"># Custom labels for the color legend</span></span>
<span id="cb3-36"><a href="#cb3-36" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">linetype =</span> microbes)) <span class="sc">+</span> </span>
<span id="cb3-37"><a href="#cb3-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_linetype_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"n"</span> <span class="ot">=</span> <span class="st">"dashed"</span>, </span>
<span id="cb3-38"><a href="#cb3-38" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">"y"</span> <span class="ot">=</span> <span class="st">"solid"</span>),</span>
<span id="cb3-39"><a href="#cb3-39" aria-hidden="true" tabindex="-1"></a>                        <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"n"</span> <span class="ot">=</span> <span class="st">"N"</span>, <span class="st">"y"</span> <span class="ot">=</span> <span class="st">"Y"</span>)) <span class="sc">+</span>  <span class="co"># Change labels to uppercase N and Y</span></span>
<span id="cb3-40"><a href="#cb3-40" aria-hidden="true" tabindex="-1"></a> <span class="fu">myCustomTheme</span>()<span class="sc">+</span></span>
<span id="cb3-41"><a href="#cb3-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">7</span>),</span>
<span id="cb3-42"><a href="#cb3-42" aria-hidden="true" tabindex="-1"></a>                   <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Initial</span><span class="sc">\n</span><span class="st">Bd"</span>, <span class="st">"1"</span>, <span class="st">"3"</span>, <span class="st">"5"</span>, <span class="st">"7"</span>))</span>
<span id="cb3-43"><a href="#cb3-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"right"</span>) <span class="co"># Adjust the legend position to overlap with the plot</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>fig_2b</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="NCOS-biofilm_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Questions for group:</p>
<p>Connect initial Bd lines to day 1? Not measured for each medium, just a count of the dosing stock</p>
<p>Legend: diff color per treatment, or make the blues the same and the pinks the same color and differentiate between microbes with the dotted lines</p>
<p>Legend: how important is it to you to have the dotted lines in the correct colors? I keep fighting and losing this battle</p>
</section>
</section>
<section id="b-eda" class="level2">
<h2 class="anchored" data-anchor-id="b-eda">2b EDA</h2>
<section id="visualize-y-var-bd-load" class="level3">
<h3 class="anchored" data-anchor-id="visualize-y-var-bd-load">visualize y var: bd load</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># untransformed</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>pw_noday0 <span class="ot">&lt;-</span> pw <span class="sc">%&gt;%</span> </span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(day <span class="sc">!=</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">log_adh_plus_sup =</span> <span class="fu">log</span>(adh_plus_sup)) <span class="co"># note: no zeroes so not log + 1</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggqqplot</span>(pw_noday0, <span class="st">"adh_plus_sup"</span>, <span class="at">title =</span> <span class="st">"untransformed"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="NCOS-biofilm_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(pw_noday0<span class="sc">$</span>adh_plus_sup) <span class="co"># nope</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  pw_noday0$adh_plus_sup
W = 0.49498, p-value = 2.434e-14</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(pw_noday0<span class="sc">$</span>adh_plus_sup) <span class="co"># note</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="NCOS-biofilm_files/figure-html/unnamed-chunk-6-2.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># transformed</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggqqplot</span>(pw_noday0, <span class="st">"log_adh_plus_sup"</span>, <span class="at">title =</span> <span class="st">"log transformed"</span>) <span class="co"># gorgeous</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="NCOS-biofilm_files/figure-html/unnamed-chunk-6-3.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(pw_noday0<span class="sc">$</span>log_adh_plus_sup) <span class="co"># better</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="NCOS-biofilm_files/figure-html/unnamed-chunk-6-4.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(pw_noday0<span class="sc">$</span>log_adh_plus_sup) <span class="co"># p-value = 0.01361, does not pass shapiro, but this has an n of 72 which is more than the recommended &lt;50 samples</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  pw_noday0$log_adh_plus_sup
W = 0.95623, p-value = 0.01361</code></pre>
</div>
</div>
</section>
</section>
<section id="b-stats" class="level2">
<h2 class="anchored" data-anchor-id="b-stats">2b Stats</h2>
<p>y var: amount of Bd</p>
<p>x vars: day, treatment, microbes y/n, pw y/n, tb y/n</p>
<p>Best model: Bd ~ day*microbes*TB</p>
<p>Question: Does the amount of Bd in the sample differ across the treatments of presence of microbes, TB, and day?</p>
<p>Model: 3-way ANOVA</p>
<p>Answer: Yes, there is a significant effect of day, presence of microbes, presence of TB as well as the interactions between day and microbes, day and TB, and a third-order interaction of day, microbes, and TB (three-way ANOVA, I recommend using a results table, it’s a lot of p and f and df values to list)</p>
<p>First-order comparisons:</p>
<p>Samples with: the presence of microbes are associated with lower Bd with TB have higher Bd days 1-7 and 3-7 are different, with day 1 having higher Bd than day 3 and day 3 having higher bd than day 7</p>
<p>I dont recommend writing out all second-order and third-order comparisons, but you can say something like there is an influence of the interaction of microbes and the day, and TB and the day.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># quick check: we want day as a FACTOR</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>pw_noday0 <span class="ot">&lt;-</span> pw_noday0 <span class="sc">%&gt;%</span> </span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">day =</span> <span class="fu">as.factor</span>(day))</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(pw_noday0<span class="sc">$</span>day)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> Factor w/ 4 levels "1","3","5","7": 1 2 3 4 1 2 3 4 1 2 ...</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set MQ as reference</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>pw_noday0<span class="sc">$</span>sample_ID <span class="ot">&lt;-</span> <span class="fu">factor</span>(pw_noday0<span class="sc">$</span>sample_ID)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>pw_noday0<span class="sc">$</span>sample_ID <span class="ot">&lt;-</span> <span class="fu">relevel</span>(pw_noday0<span class="sc">$</span>sample_ID, <span class="at">ref =</span> <span class="st">"MQ"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="null" class="level2">
<h2 class="anchored" data-anchor-id="null">null</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>null <span class="ot">&lt;-</span> <span class="fu">lm</span>(log_adh_plus_sup <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> pw_noday0)</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="fu">AIC</span>(null) <span class="co">#326.4356</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 326.4356</code></pre>
</div>
</div>
</section>
<section id="best-model-bd-daymicrobestb" class="level2">
<h2 class="anchored" data-anchor-id="best-model-bd-daymicrobestb">Best model: Bd ~ day*microbes*TB</h2>
<p>Q: is it more appropriate to also do random effect of treatment? We can try it</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># build model</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>mod3 <span class="ot">&lt;-</span> <span class="fu">aov</span>(log_adh_plus_sup <span class="sc">~</span> day<span class="sc">*</span>microbes<span class="sc">*</span>TB,</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> pw_noday0)</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="co"># diagnostic plot</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mod3) <span class="co"># looks good</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="NCOS-biofilm_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># look at results</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                Df Sum Sq Mean Sq F value   Pr(&gt;F)    
day              3  35.40   11.80  26.683 7.55e-11 ***
microbes         1 227.46  227.46 514.326  &lt; 2e-16 ***
TB               1  20.99   20.99  47.463 5.27e-09 ***
day:microbes     3  31.49   10.50  23.736 4.83e-10 ***
day:TB           3  11.71    3.90   8.825 6.96e-05 ***
microbes:TB      1   0.01    0.01   0.027    0.871    
day:microbes:TB  3  19.49    6.50  14.691 3.57e-07 ***
Residuals       56  24.77    0.44                     
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod3) <span class="co"># day, microbes, tb are all significant, interactions: day:TB, day:microbes, day:microbes:TB, NOT microbes:TB </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Response: log_adh_plus_sup
                Df  Sum Sq Mean Sq  F value    Pr(&gt;F)    
day              3  35.401  11.800  26.6826 7.545e-11 ***
microbes         1 227.459 227.459 514.3256 &lt; 2.2e-16 ***
TB               1  20.990  20.990  47.4626 5.272e-09 ***
day:microbes     3  31.492  10.497  23.7362 4.835e-10 ***
day:TB           3  11.708   3.903   8.8245 6.959e-05 ***
microbes:TB      1   0.012   0.012   0.0266    0.8709    
day:microbes:TB  3  19.491   6.497  14.6913 3.575e-07 ***
Residuals       56  24.766   0.442                       
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">AIC</span>(mod3) <span class="co"># 161.4887 BEST MODEL</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 161.4887</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">TukeyHSD</span>(mod3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  Tukey multiple comparisons of means
    95% family-wise confidence level

Fit: aov(formula = log_adh_plus_sup ~ day * microbes * TB, data = pw_noday0)

$day
          diff        lwr        upr     p adj
3-1  0.7878386  0.2008757  1.3748015 0.0042180
5-1 -0.1715069 -0.7584698  0.4154560 0.8659958
7-1 -1.1817503 -1.7687133 -0.5947874 0.0000106
5-3 -0.9593455 -1.5463084 -0.3723826 0.0003575
7-3 -1.9695889 -2.5565519 -1.3826260 0.0000000
7-5 -1.0102434 -1.5972063 -0.4232805 0.0001640

$microbes
         diff       lwr       upr p adj
y-n -3.770435 -4.103482 -3.437388     0

$TB
        diff       lwr      upr p adj
y-n 1.079872 0.7658719 1.393871     0

$`day:microbes`
              diff        lwr          upr     p adj
3:n-1:n  2.0190482  1.1643151  2.873781272 0.0000000
5:n-1:n  0.7307543 -0.1239788  1.585487425 0.1467318
7:n-1:n -0.1829562 -1.0376893  0.671776933 0.9973752
1:y-1:n -1.4212365 -2.4680665 -0.374406495 0.0018175
3:y-1:n -3.0958170 -4.1426470 -2.048987015 0.0000000
5:y-1:n -3.3972659 -4.4440959 -2.350435887 0.0000000
7:y-1:n -4.6005751 -5.6474051 -3.553745166 0.0000000
5:n-3:n -1.2882938 -2.1430269 -0.433560744 0.0003749
7:n-3:n -2.2020043 -3.0567374 -1.347271236 0.0000000
1:y-3:n -3.4402846 -4.4871146 -2.393454665 0.0000000
3:y-3:n -5.1148652 -6.1616952 -4.068035184 0.0000000
5:y-3:n -5.4163140 -6.4631440 -4.369484057 0.0000000
7:y-3:n -6.6196233 -7.6664533 -5.572793336 0.0000000
7:n-5:n -0.9137105 -1.7684436 -0.058977390 0.0281386
1:y-5:n -2.1519908 -3.1988208 -1.105160818 0.0000007
3:y-5:n -3.8265713 -4.8734013 -2.779741338 0.0000000
5:y-5:n -4.1280202 -5.1748502 -3.081190210 0.0000000
7:y-5:n -5.3313295 -6.3781595 -4.284499489 0.0000000
1:y-7:n -1.2382803 -2.2851103 -0.191450326 0.0101173
3:y-7:n -2.9128608 -3.9596908 -1.866030845 0.0000000
5:y-7:n -3.2143097 -4.2611397 -2.167479718 0.0000000
7:y-7:n -4.4176190 -5.4644490 -3.370788997 0.0000000
3:y-1:y -1.6745805 -2.8833557 -0.465805374 0.0013660
5:y-1:y -1.9760294 -3.1848045 -0.767254247 0.0000920
7:y-1:y -3.1793387 -4.3881138 -1.970563526 0.0000000
5:y-3:y -0.3014489 -1.5102240  0.907326273 0.9932578
7:y-3:y -1.5047582 -2.7135333 -0.295983006 0.0056058
7:y-5:y -1.2033093 -2.4120844  0.005465867 0.0518517

$`day:TB`
               diff        lwr        upr     p adj
3:n-1:n -0.31984147 -1.3068022  0.6671193 0.9693765
5:n-1:n -0.89827967 -1.8852404  0.0886811 0.0996625
7:n-1:n -1.64257839 -2.6295392 -0.6556176 0.0000660
1:y-1:n -0.06776878 -1.0547296  0.9191920 0.9999987
3:y-1:n  1.82774990  0.8407891  2.8147107 0.0000077
5:y-1:n  0.48749705 -0.4994637  1.4744578 0.7741316
7:y-1:n -0.78869107 -1.7756518  0.1982697 0.2102592
5:n-3:n -0.57843820 -1.5653990  0.4085226 0.5929738
7:n-3:n -1.32273692 -2.3096977 -0.3357761 0.0021720
1:y-3:n  0.25207268 -0.7348881  1.2390335 0.9922154
3:y-3:n  2.14759136  1.1606306  3.1345521 0.0000002
5:y-3:n  0.80733852 -0.1796223  1.7942993 0.1868555
7:y-3:n -0.46884960 -1.4558104  0.5181112 0.8065094
7:n-5:n -0.74429872 -1.7312595  0.2426621 0.2740380
1:y-5:n  0.83051089 -0.1564499  1.8174717 0.1605121
3:y-5:n  2.72602956  1.7390688  3.7129903 0.0000000
5:y-5:n  1.38577672  0.3988159  2.3727375 0.0011240
7:y-5:n  0.10958860 -0.8773722  1.0965494 0.9999654
1:y-7:n  1.57480960  0.5878488  2.5617704 0.0001422
3:y-7:n  3.47032828  2.4833675  4.4572891 0.0000000
5:y-7:n  2.13007544  1.1431147  3.1170362 0.0000002
7:y-7:n  0.85388732 -0.1330735  1.8408481 0.1369020
3:y-1:y  1.89551868  0.9085579  2.8824795 0.0000034
5:y-1:y  0.55526584 -0.4316949  1.5422266 0.6414793
7:y-1:y -0.72092229 -1.7078831  0.2660385 0.3121153
5:y-3:y -1.34025284 -2.3272136 -0.3532921 0.0018119
7:y-3:y -2.61644097 -3.6034017 -1.6294802 0.0000000
7:y-5:y -1.27618812 -2.2631489 -0.2892274 0.0034913

$`microbes:TB`
             diff        lwr       upr     p adj
y:n-n:n -3.797570 -4.4201381 -3.175002 0.0000000
n:y-n:n  1.061782  0.5534571  1.570107 0.0000051
y:y-n:n -2.681519 -3.3040869 -2.058950 0.0000000
n:y-y:n  4.859352  4.2367836  5.481920 0.0000000
y:y-y:n  1.116051  0.3971714  1.834931 0.0007332
y:y-n:y -3.743301 -4.3658687 -3.120732 0.0000000

$`day:microbes:TB`
                   diff         lwr         upr     p adj
3:n:n-1:n:n  0.05749676 -1.31922254  1.43421605 1.0000000
5:n:n-1:n:n -0.74013256 -2.11685186  0.63658673 0.8518690
7:n:n-1:n:n -1.55909281 -2.93581210 -0.18237351 0.0129270
1:y:n-1:n:n -3.33334170 -5.01947160 -1.64721181 0.0000003
3:y:n-1:n:n -4.40785962 -6.09398951 -2.72172973 0.0000000
5:y:n-1:n:n -4.54791558 -6.23404547 -2.86178569 0.0000000
7:y:n-1:n:n -5.14289125 -6.82902114 -3.45676135 0.0000000
1:n:y-1:n:n -1.34250560 -2.71922489  0.03421370 0.0631902
3:n:y-1:n:n  2.63809398  1.26137469  4.01481328 0.0000006
5:n:y-1:n:n  0.85913561 -0.51758368  2.23585490 0.6679804
7:n:y-1:n:n -0.14932513 -1.52604442  1.22739416 1.0000000
1:y:y-1:n:n -0.85163685 -2.53776675  0.83449304 0.9018958
3:y:y-1:n:n -3.12627998 -4.81240987 -1.44015008 0.0000015
5:y:y-1:n:n -3.58912176 -5.27525166 -1.90299187 0.0000000
7:y:y-1:n:n -5.40076465 -7.08689455 -3.71463476 0.0000000
5:n:n-3:n:n -0.79762932 -2.17434862  0.57908997 0.7707712
7:n:n-3:n:n -1.61658957 -2.99330886 -0.23987027 0.0081769
1:y:n-3:n:n -3.39083846 -5.07696835 -1.70470857 0.0000002
3:y:n-3:n:n -4.46535638 -6.15148627 -2.77922648 0.0000000
5:y:n-3:n:n -4.60541234 -6.29154223 -2.91928244 0.0000000
7:y:n-3:n:n -5.20038800 -6.88651790 -3.51425811 0.0000000
1:n:y-3:n:n -1.40000236 -2.77672165 -0.02328306 0.0424718
3:n:y-3:n:n  2.58059722  1.20387793  3.95731652 0.0000011
5:n:y-3:n:n  0.80163885 -0.57508044  2.17835815 0.7644997
7:n:y-3:n:n -0.20682189 -1.58354118  1.16989741 0.9999999
1:y:y-3:n:n -0.90913361 -2.59526351  0.77699628 0.8491350
3:y:y-3:n:n -3.18377673 -4.86990663 -1.49764684 0.0000009
5:y:y-3:n:n -3.64661852 -5.33274841 -1.96048863 0.0000000
7:y:y-3:n:n -5.45826141 -7.14439131 -3.77213152 0.0000000
7:n:n-5:n:n -0.81896024 -2.19567954  0.55775905 0.7366289
1:y:n-5:n:n -2.59320914 -4.27933903 -0.90707924 0.0000986
3:y:n-5:n:n -3.66772706 -5.35385695 -1.98159716 0.0000000
5:y:n-5:n:n -3.80778302 -5.49391291 -2.12165312 0.0000000
7:y:n-5:n:n -4.40275868 -6.08888858 -2.71662879 0.0000000
1:n:y-5:n:n -0.60237303 -1.97909233  0.77434626 0.9675176
3:n:y-5:n:n  3.37822655  2.00150725  4.75494584 0.0000000
5:n:y-5:n:n  1.59926818  0.22254888  2.97598747 0.0093999
7:n:y-5:n:n  0.59080743 -0.78591186  1.96752673 0.9724639
1:y:y-5:n:n -0.11150429 -1.79763418  1.57462560 1.0000000
3:y:y-5:n:n -2.38614741 -4.07227731 -0.70001752 0.0004691
5:y:y-5:n:n -2.84898920 -4.53511909 -1.16285930 0.0000135
7:y:y-5:n:n -4.66063209 -6.34676198 -2.97450219 0.0000000
1:y:n-7:n:n -1.77424889 -3.46037879 -0.08811900 0.0299112
3:y:n-7:n:n -2.84876681 -4.53489671 -1.16263692 0.0000135
5:y:n-7:n:n -2.98882277 -4.67495267 -1.30269288 0.0000045
7:y:n-7:n:n -3.58379844 -5.26992833 -1.89766854 0.0000000
1:n:y-7:n:n  0.21658721 -1.16013208  1.59330650 0.9999998
3:n:y-7:n:n  4.19718679  2.82046750  5.57390608 0.0000000
5:n:y-7:n:n  2.41822842  1.04150913  3.79494771 0.0000056
7:n:y-7:n:n  1.40976768  0.03304838  2.78648697 0.0396267
1:y:y-7:n:n  0.70745595 -0.97867394  2.39358585 0.9773798
3:y:y-7:n:n -1.56718717 -3.25331706  0.11894273 0.0953784
5:y:y-7:n:n -2.03002895 -3.71615885 -0.34389906 0.0058560
7:y:y-7:n:n -3.84167185 -5.52780174 -2.15554195 0.0000000
3:y:n-1:y:n -1.07451792 -3.02149301  0.87245718 0.8261232
5:y:n-1:y:n -1.21457388 -3.16154897  0.73240122 0.6685132
7:y:n-1:y:n -1.80954954 -3.75652464  0.13742555 0.0954136
1:n:y-1:y:n  1.99083610  0.30470621  3.67696600 0.0076070
3:n:y-1:y:n  5.97143568  4.28530579  7.65756558 0.0000000
5:n:y-1:y:n  4.19247731  2.50634742  5.87860721 0.0000000
7:n:y-1:y:n  3.18401657  1.49788668  4.87014647 0.0000009
1:y:y-1:y:n  2.48170485  0.53472975  4.42867994 0.0025857
3:y:y-1:y:n  0.20706173 -1.73991337  2.15403682 1.0000000
5:y:y-1:y:n -0.25578006 -2.20275516  1.69119504 1.0000000
7:y:y-1:y:n -2.06742295 -4.01439805 -0.12044785 0.0271360
5:y:n-3:y:n -0.14005596 -2.08703106  1.80691914 1.0000000
7:y:n-3:y:n -0.73503163 -2.68200672  1.21194347 0.9915324
1:n:y-3:y:n  3.06535402  1.37922413  4.75148392 0.0000024
3:n:y-3:y:n  7.04595360  5.35982371  8.73208350 0.0000000
5:n:y-3:y:n  5.26699523  3.58086534  6.95312512 0.0000000
7:n:y-3:y:n  4.25853449  2.57240460  5.94466438 0.0000000
1:y:y-3:y:n  3.55622277  1.60924767  5.50319786 0.0000022
3:y:y-3:y:n  1.28157964 -0.66539545  3.22855474 0.5832391
5:y:y-3:y:n  0.81873786 -1.12823724  2.76571296 0.9769270
7:y:y-3:y:n -0.99290503 -2.93988013  0.95407006 0.8951597
7:y:n-5:y:n -0.59497567 -2.54195076  1.35199943 0.9990943
1:n:y-5:y:n  3.20540998  1.51928009  4.89153988 0.0000008
3:n:y-5:y:n  7.18600956  5.49987967  8.87213946 0.0000000
5:n:y-5:y:n  5.40705119  3.72092130  7.09318108 0.0000000
7:n:y-5:y:n  4.39859045  2.71246056  6.08472034 0.0000000
1:y:y-5:y:n  3.69627873  1.74930363  5.64325382 0.0000008
3:y:y-5:y:n  1.42163560 -0.52533949  3.36861070 0.4074884
5:y:y-5:y:n  0.95879382 -0.98818128  2.90576892 0.9180041
7:y:y-5:y:n -0.85284907 -2.79982417  1.09412602 0.9672064
1:n:y-7:y:n  3.80038565  2.11425575  5.48651554 0.0000000
3:n:y-7:y:n  7.78098523  6.09485533  9.46711512 0.0000000
5:n:y-7:y:n  6.00202686  4.31589696  7.68815675 0.0000000
7:n:y-7:y:n  4.99356612  3.30743622  6.67969601 0.0000000
1:y:y-7:y:n  4.29125439  2.34427929  6.23822949 0.0000000
3:y:y-7:y:n  2.01661127  0.06963617  3.96358637 0.0352829
5:y:y-7:y:n  1.55376948 -0.39320561  3.50074458 0.2665792
7:y:y-7:y:n -0.25787341 -2.20484850  1.68910169 1.0000000
3:n:y-1:n:y  3.98059958  2.60388029  5.35731887 0.0000000
5:n:y-1:n:y  2.20164121  0.82492192  3.57836050 0.0000445
7:n:y-1:n:y  1.19318047 -0.18353882  2.56989976 0.1607629
1:y:y-1:n:y  0.49086874 -1.19526115  2.17699864 0.9994806
3:y:y-1:n:y -1.78377438 -3.46990427 -0.09764448 0.0282490
5:y:y-1:n:y -2.24661616 -3.93274606 -0.56048627 0.0012972
7:y:y-1:n:y -4.05825905 -5.74438895 -2.37212916 0.0000000
5:n:y-3:n:y -1.77895837 -3.15567766 -0.40223908 0.0021014
7:n:y-3:n:y -2.78741911 -4.16413840 -1.41069982 0.0000001
1:y:y-3:n:y -3.48973084 -5.17586073 -1.80360094 0.0000001
3:y:y-3:n:y -5.76437396 -7.45050385 -4.07824406 0.0000000
5:y:y-3:n:y -6.22721574 -7.91334564 -4.54108585 0.0000000
7:y:y-3:n:y -8.03885863 -9.72498853 -6.35272874 0.0000000
7:n:y-5:n:y -1.00846074 -2.38518003  0.36825855 0.4021260
1:y:y-5:n:y -1.71077247 -3.39690236 -0.02464257 0.0434314
3:y:y-5:n:y -3.98541559 -5.67154548 -2.29928569 0.0000000
5:y:y-5:n:y -4.44825737 -6.13438727 -2.76212748 0.0000000
7:y:y-5:n:y -6.25990026 -7.94603016 -4.57377037 0.0000000
1:y:y-7:n:y -0.70231172 -2.38844162  0.98381817 0.9787964
3:y:y-7:n:y -2.97695485 -4.66308474 -1.29082495 0.0000049
5:y:y-7:n:y -3.43979663 -5.12592653 -1.75366674 0.0000001
7:y:y-7:n:y -5.25143952 -6.93756942 -3.56530963 0.0000000
3:y:y-1:y:y -2.27464312 -4.22161822 -0.32766802 0.0087341
5:y:y-1:y:y -2.73748491 -4.68446000 -0.79050981 0.0005257
7:y:y-1:y:y -4.54912780 -6.49610290 -2.60215270 0.0000000
5:y:y-3:y:y -0.46284179 -2.40981688  1.48413331 0.9999557
7:y:y-3:y:y -2.27448468 -4.22145977 -0.32750958 0.0087420
7:y:y-5:y:y -1.81164289 -3.75861799  0.13533220 0.0945214</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># comparisons</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>em <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(mod3, <span class="sc">~</span> day <span class="sc">*</span> microbes <span class="sc">*</span> TB)</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform the Tukey test for pairwise comparisons</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>tukey_results <span class="ot">&lt;-</span> <span class="fu">contrast</span>(em, <span class="at">method =</span> <span class="st">"tukey"</span>)</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a><span class="co"># View the results</span></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(tukey_results)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> contrast            estimate    SE df t.ratio p.value
 day1 n n - day3 n n  -0.0575 0.384 56  -0.150  1.0000
 day1 n n - day5 n n   0.7401 0.384 56   1.928  0.8519
 day1 n n - day7 n n   1.5591 0.384 56   4.061  0.0129
 day1 n n - day1 y n   3.3333 0.470 56   7.089  &lt;.0001
 day1 n n - day3 y n   4.4079 0.470 56   9.374  &lt;.0001
 day1 n n - day5 y n   4.5479 0.470 56   9.672  &lt;.0001
 day1 n n - day7 y n   5.1429 0.470 56  10.937  &lt;.0001
 day1 n n - day1 n y   1.3425 0.384 56   3.497  0.0632
 day1 n n - day3 n y  -2.6381 0.384 56  -6.871  &lt;.0001
 day1 n n - day5 n y  -0.8591 0.384 56  -2.238  0.6680
 day1 n n - day7 n y   0.1493 0.384 56   0.389  1.0000
 day1 n n - day1 y y   0.8516 0.470 56   1.811  0.9019
 day1 n n - day3 y y   3.1263 0.470 56   6.648  &lt;.0001
 day1 n n - day5 y y   3.5891 0.470 56   7.633  &lt;.0001
 day1 n n - day7 y y   5.4008 0.470 56  11.485  &lt;.0001
 day3 n n - day5 n n   0.7976 0.384 56   2.077  0.7708
 day3 n n - day7 n n   1.6166 0.384 56   4.210  0.0082
 day3 n n - day1 y n   3.3908 0.470 56   7.211  &lt;.0001
 day3 n n - day3 y n   4.4654 0.470 56   9.496  &lt;.0001
 day3 n n - day5 y n   4.6054 0.470 56   9.794  &lt;.0001
 day3 n n - day7 y n   5.2004 0.470 56  11.059  &lt;.0001
 day3 n n - day1 n y   1.4000 0.384 56   3.646  0.0425
 day3 n n - day3 n y  -2.5806 0.384 56  -6.721  &lt;.0001
 day3 n n - day5 n y  -0.8016 0.384 56  -2.088  0.7645
 day3 n n - day7 n y   0.2068 0.384 56   0.539  1.0000
 day3 n n - day1 y y   0.9091 0.470 56   1.933  0.8491
 day3 n n - day3 y y   3.1838 0.470 56   6.771  &lt;.0001
 day3 n n - day5 y y   3.6466 0.470 56   7.755  &lt;.0001
 day3 n n - day7 y y   5.4583 0.470 56  11.607  &lt;.0001
 day5 n n - day7 n n   0.8190 0.384 56   2.133  0.7366
 day5 n n - day1 y n   2.5932 0.470 56   5.515  0.0001
 day5 n n - day3 y n   3.6677 0.470 56   7.800  &lt;.0001
 day5 n n - day5 y n   3.8078 0.470 56   8.098  &lt;.0001
 day5 n n - day7 y n   4.4028 0.470 56   9.363  &lt;.0001
 day5 n n - day1 n y   0.6024 0.384 56   1.569  0.9675
 day5 n n - day3 n y  -3.3782 0.384 56  -8.799  &lt;.0001
 day5 n n - day5 n y  -1.5993 0.384 56  -4.165  0.0094
 day5 n n - day7 n y  -0.5908 0.384 56  -1.539  0.9725
 day5 n n - day1 y y   0.1115 0.470 56   0.237  1.0000
 day5 n n - day3 y y   2.3861 0.470 56   5.074  0.0005
 day5 n n - day5 y y   2.8490 0.470 56   6.059  &lt;.0001
 day5 n n - day7 y y   4.6606 0.470 56   9.911  &lt;.0001
 day7 n n - day1 y n   1.7742 0.470 56   3.773  0.0299
 day7 n n - day3 y n   2.8488 0.470 56   6.058  &lt;.0001
 day7 n n - day5 y n   2.9888 0.470 56   6.356  &lt;.0001
 day7 n n - day7 y n   3.5838 0.470 56   7.621  &lt;.0001
 day7 n n - day1 n y  -0.2166 0.384 56  -0.564  1.0000
 day7 n n - day3 n y  -4.1972 0.384 56 -10.932  &lt;.0001
 day7 n n - day5 n y  -2.4182 0.384 56  -6.298  &lt;.0001
 day7 n n - day7 n y  -1.4098 0.384 56  -3.672  0.0396
 day7 n n - day1 y y  -0.7075 0.470 56  -1.504  0.9774
 day7 n n - day3 y y   1.5672 0.470 56   3.333  0.0954
 day7 n n - day5 y y   2.0300 0.470 56   4.317  0.0059
 day7 n n - day7 y y   3.8417 0.470 56   8.170  &lt;.0001
 day1 y n - day3 y n   1.0745 0.543 56   1.979  0.8261
 day1 y n - day5 y n   1.2146 0.543 56   2.237  0.6685
 day1 y n - day7 y n   1.8095 0.543 56   3.333  0.0954
 day1 y n - day1 n y  -1.9908 0.470 56  -4.234  0.0076
 day1 y n - day3 n y  -5.9714 0.470 56 -12.699  &lt;.0001
 day1 y n - day5 n y  -4.1925 0.470 56  -8.916  &lt;.0001
 day1 y n - day7 n y  -3.1840 0.470 56  -6.771  &lt;.0001
 day1 y n - day1 y y  -2.4817 0.543 56  -4.570  0.0026
 day1 y n - day3 y y  -0.2071 0.543 56  -0.381  1.0000
 day1 y n - day5 y y   0.2558 0.543 56   0.471  1.0000
 day1 y n - day7 y y   2.0674 0.543 56   3.808  0.0271
 day3 y n - day5 y n   0.1401 0.543 56   0.258  1.0000
 day3 y n - day7 y n   0.7350 0.543 56   1.354  0.9915
 day3 y n - day1 n y  -3.0654 0.470 56  -6.519  &lt;.0001
 day3 y n - day3 n y  -7.0460 0.470 56 -14.984  &lt;.0001
 day3 y n - day5 n y  -5.2670 0.470 56 -11.201  &lt;.0001
 day3 y n - day7 n y  -4.2585 0.470 56  -9.056  &lt;.0001
 day3 y n - day1 y y  -3.5562 0.543 56  -6.549  &lt;.0001
 day3 y n - day3 y y  -1.2816 0.543 56  -2.360  0.5832
 day3 y n - day5 y y  -0.8187 0.543 56  -1.508  0.9769
 day3 y n - day7 y y   0.9929 0.543 56   1.829  0.8952
 day5 y n - day7 y n   0.5950 0.543 56   1.096  0.9991
 day5 y n - day1 n y  -3.2054 0.470 56  -6.817  &lt;.0001
 day5 y n - day3 n y  -7.1860 0.470 56 -15.282  &lt;.0001
 day5 y n - day5 n y  -5.4071 0.470 56 -11.499  &lt;.0001
 day5 y n - day7 n y  -4.3986 0.470 56  -9.354  &lt;.0001
 day5 y n - day1 y y  -3.6963 0.543 56  -6.807  &lt;.0001
 day5 y n - day3 y y  -1.4216 0.543 56  -2.618  0.4075
 day5 y n - day5 y y  -0.9588 0.543 56  -1.766  0.9180
 day5 y n - day7 y y   0.8528 0.543 56   1.571  0.9672
 day7 y n - day1 n y  -3.8004 0.470 56  -8.082  &lt;.0001
 day7 y n - day3 n y  -7.7810 0.470 56 -16.547  &lt;.0001
 day7 y n - day5 n y  -6.0020 0.470 56 -12.764  &lt;.0001
 day7 y n - day7 n y  -4.9936 0.470 56 -10.619  &lt;.0001
 day7 y n - day1 y y  -4.2913 0.543 56  -7.903  &lt;.0001
 day7 y n - day3 y y  -2.0166 0.543 56  -3.714  0.0353
 day7 y n - day5 y y  -1.5538 0.543 56  -2.862  0.2666
 day7 y n - day7 y y   0.2579 0.543 56   0.475  1.0000
 day1 n y - day3 n y  -3.9806 0.384 56 -10.368  &lt;.0001
 day1 n y - day5 n y  -2.2016 0.384 56  -5.734  &lt;.0001
 day1 n y - day7 n y  -1.1932 0.384 56  -3.108  0.1608
 day1 n y - day1 y y  -0.4909 0.470 56  -1.044  0.9995
 day1 n y - day3 y y   1.7838 0.470 56   3.793  0.0282
 day1 n y - day5 y y   2.2466 0.470 56   4.778  0.0013
 day1 n y - day7 y y   4.0583 0.470 56   8.630  &lt;.0001
 day3 n y - day5 n y   1.7790 0.384 56   4.633  0.0021
 day3 n y - day7 n y   2.7874 0.384 56   7.260  &lt;.0001
 day3 n y - day1 y y   3.4897 0.470 56   7.421  &lt;.0001
 day3 n y - day3 y y   5.7644 0.470 56  12.258  &lt;.0001
 day3 n y - day5 y y   6.2272 0.470 56  13.243  &lt;.0001
 day3 n y - day7 y y   8.0389 0.470 56  17.095  &lt;.0001
 day5 n y - day7 n y   1.0085 0.384 56   2.627  0.4021
 day5 n y - day1 y y   1.7108 0.470 56   3.638  0.0434
 day5 n y - day3 y y   3.9854 0.470 56   8.475  &lt;.0001
 day5 n y - day5 y y   4.4483 0.470 56   9.460  &lt;.0001
 day5 n y - day7 y y   6.2599 0.470 56  13.312  &lt;.0001
 day7 n y - day1 y y   0.7023 0.470 56   1.494  0.9788
 day7 n y - day3 y y   2.9770 0.470 56   6.331  &lt;.0001
 day7 n y - day5 y y   3.4398 0.470 56   7.315  &lt;.0001
 day7 n y - day7 y y   5.2514 0.470 56  11.168  &lt;.0001
 day1 y y - day3 y y   2.2746 0.543 56   4.189  0.0087
 day1 y y - day5 y y   2.7375 0.543 56   5.042  0.0005
 day1 y y - day7 y y   4.5491 0.543 56   8.378  &lt;.0001
 day3 y y - day5 y y   0.4628 0.543 56   0.852  1.0000
 day3 y y - day7 y y   2.2745 0.543 56   4.189  0.0087
 day5 y y - day7 y y   1.8116 0.543 56   3.336  0.0945

P value adjustment: tukey method for comparing a family of 16 estimates </code></pre>
</div>
</div>
</section>
<section id="bd-day-treatment" class="level2">
<h2 class="anchored" data-anchor-id="bd-day-treatment">Bd ~ day + treatment</h2>
<p>If it is important to you to have p-values comparing at the treatment level, you can use this instead, but I think it provides less information than the model above, and it has a higher aic value</p>
<p>Significant Contrasts (p-value &lt; 0.05):</p>
<ol type="1">
<li><strong>MQ - (1%TB+PW+microorganism)</strong>: p-value = <code>&lt;.0001</code></li>
<li><strong>MQ - (PW+microorganism)</strong>: p-value = <code>&lt;.0001</code></li>
<li><strong>1%TB - (1%TB+PW+microorganism)</strong>: p-value = <code>&lt;.0001</code></li>
<li><strong>1%TB - (PW+microorganism)</strong>: p-value = <code>&lt;.0001</code></li>
<li><strong>(1%TB+PW-microorganism) - (1%TB+PW+microorganism)</strong>: p-value = <code>&lt;.0001</code></li>
<li><strong>(1%TB+PW-microorganism) - (PW+microorganism)</strong>: p-value = <code>&lt;.0001</code></li>
<li><strong>(1%TB+PW+microorganism) - (PW-microorganism)</strong>: p-value = <code>&lt;.0001</code></li>
<li><strong>(PW-microorganism) - (PW+microorganism)</strong>: p-value = <code>&lt;.0001</code></li>
</ol>
<p>Non-Significant Contrasts (p-value ≥ 0.05):</p>
<ol type="1">
<li><strong>MQ - 1%TB</strong>: p-value = <code>0.3017</code></li>
<li><strong>MQ - (1%TB+PW-microorganism)</strong>: p-value = <code>0.0500</code> (marginal significance)</li>
<li><strong>MQ - (PW-microorganism)</strong>: p-value = <code>0.9917</code></li>
<li><strong>1%TB - (1%TB+PW-microorganism)</strong>: p-value = <code>0.9586</code></li>
<li><strong>1%TB - (PW-microorganism)</strong>: p-value = <code>0.6577</code></li>
<li><strong>(1%TB+PW-microorganism) - (PW-microorganism)</strong>: p-value = <code>0.1888</code></li>
<li><strong>(1%TB+PW+microorganism) - (PW-microorganism)</strong>: p-value = <code>0.1940</code></li>
</ol>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># build model</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>mod <span class="ot">&lt;-</span> <span class="fu">lm</span>(log_adh_plus_sup <span class="sc">~</span> day <span class="sc">+</span> sample_ID,</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> pw_noday0)</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a><span class="co"># diagnostic plot</span></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mod)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="NCOS-biofilm_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># look at results</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = log_adh_plus_sup ~ day + sample_ID, data = pw_noday0)

Residuals:
    Min      1Q  Median      3Q     Max 
-4.3472 -0.4091 -0.0416  0.5842  2.2986 

Coefficients:
                               Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)                     13.3614     0.4131  32.341  &lt; 2e-16 ***
day3                             0.7878     0.3895   2.023   0.0474 *  
day5                            -0.1715     0.3895  -0.440   0.6612    
day7                            -1.1818     0.3895  -3.034   0.0035 ** 
sample_ID1%TB                    1.0008     0.4770   2.098   0.0399 *  
sample_ID1%TB+PW-microorganism   1.4021     0.4770   2.939   0.0046 ** 
sample_ID1%TB+PW+microorganism  -2.5418     0.4770  -5.328 1.42e-06 ***
sample_IDPW-microorganism        0.2793     0.4770   0.586   0.5603    
sample_IDPW+microorganism       -3.6579     0.4770  -7.668 1.36e-10 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.169 on 63 degrees of freedom
Multiple R-squared:  0.7683,    Adjusted R-squared:  0.7389 
F-statistic: 26.12 on 8 and 63 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod) <span class="co"># day is significant, sample id is too</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Response: log_adh_plus_sup
          Df  Sum Sq Mean Sq F value    Pr(&gt;F)    
day        3  35.401  11.800  8.6421 6.907e-05 ***
sample_ID  5 249.895  49.979 36.6028 &lt; 2.2e-16 ***
Residuals 63  86.023   1.365                      
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">AIC</span>(mod) <span class="co"># 237.1393</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 237.1393</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># comparisons by day</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>emmeans<span class="sc">::</span><span class="fu">emmeans</span>(mod, pairwise <span class="sc">~</span> day) <span class="co"># pairwise comparisons</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$emmeans
 day emmean    SE df lower.CL upper.CL
 1     12.8 0.275 63     12.2     13.3
 3     13.6 0.275 63     13.0     14.1
 5     12.6 0.275 63     12.1     13.2
 7     11.6 0.275 63     11.0     12.1

Results are averaged over the levels of: sample_ID 
Confidence level used: 0.95 

$contrasts
 contrast    estimate   SE df t.ratio p.value
 day1 - day3   -0.788 0.39 63  -2.023  0.1907
 day1 - day5    0.172 0.39 63   0.440  0.9712
 day1 - day7    1.182 0.39 63   3.034  0.0180
 day3 - day5    0.959 0.39 63   2.463  0.0758
 day3 - day7    1.970 0.39 63   5.057  &lt;.0001
 day5 - day7    1.010 0.39 63   2.594  0.0558

Results are averaged over the levels of: sample_ID 
P value adjustment: tukey method for comparing a family of 4 estimates </code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># comparisons by treatment</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>emmeans<span class="sc">::</span><span class="fu">emmeans</span>(mod, pairwise <span class="sc">~</span> sample_ID) <span class="co"># pairwise comparisons</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$emmeans
 sample_ID             emmean    SE df lower.CL upper.CL
 MQ                     13.22 0.337 63    12.55     13.9
 1%TB                   14.22 0.337 63    13.55     14.9
 1%TB+PW-microorganism  14.62 0.337 63    13.95     15.3
 1%TB+PW+microorganism  10.68 0.337 63    10.00     11.4
 PW-microorganism       13.50 0.337 63    12.83     14.2
 PW+microorganism        9.56 0.337 63     8.89     10.2

Results are averaged over the levels of: day 
Confidence level used: 0.95 

$contrasts
 contrast                                          estimate    SE df t.ratio
 MQ - 1%TB                                           -1.001 0.477 63  -2.098
 MQ - (1%TB+PW-microorganism)                        -1.402 0.477 63  -2.939
 MQ - (1%TB+PW+microorganism)                         2.542 0.477 63   5.328
 MQ - (PW-microorganism)                             -0.279 0.477 63  -0.586
 MQ - (PW+microorganism)                              3.658 0.477 63   7.668
 1%TB - (1%TB+PW-microorganism)                      -0.401 0.477 63  -0.841
 1%TB - (1%TB+PW+microorganism)                       3.543 0.477 63   7.426
 1%TB - (PW-microorganism)                            0.721 0.477 63   1.512
 1%TB - (PW+microorganism)                            4.659 0.477 63   9.766
 (1%TB+PW-microorganism) - (1%TB+PW+microorganism)    3.944 0.477 63   8.267
 (1%TB+PW-microorganism) - (PW-microorganism)         1.123 0.477 63   2.353
 (1%TB+PW-microorganism) - (PW+microorganism)         5.060 0.477 63  10.607
 (1%TB+PW+microorganism) - (PW-microorganism)        -2.821 0.477 63  -5.914
 (1%TB+PW+microorganism) - (PW+microorganism)         1.116 0.477 63   2.340
 (PW-microorganism) - (PW+microorganism)              3.937 0.477 63   8.253
 p.value
  0.3017
  0.0500
  &lt;.0001
  0.9917
  &lt;.0001
  0.9586
  &lt;.0001
  0.6577
  &lt;.0001
  &lt;.0001
  0.1888
  &lt;.0001
  &lt;.0001
  0.1940
  &lt;.0001

Results are averaged over the levels of: day 
P value adjustment: tukey method for comparing a family of 6 estimates </code></pre>
</div>
</div>
</section>
<section id="no-interactions-bd-day-microbes-pw-tb" class="level2">
<h2 class="anchored" data-anchor-id="no-interactions-bd-day-microbes-pw-tb">No interactions: Bd ~ day + microbes + PW + TB</h2>
<p>This is nt a great model, but I kept it for yall to see</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># build model</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>mod2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(log_adh_plus_sup <span class="sc">~</span> day <span class="sc">+</span> microbes <span class="sc">+</span> PW <span class="sc">+</span> TB,</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> pw_noday0)</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a><span class="co"># diagnostic plot</span></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mod2) <span class="co"># looks better tbh</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="NCOS-biofilm_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># look at results</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = log_adh_plus_sup ~ day + microbes + PW + TB, data = pw_noday0)

Residuals:
    Min      1Q  Median      3Q     Max 
-4.3258 -0.4235 -0.0630  0.6102  2.3167 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  13.3219     0.3588  37.127  &lt; 2e-16 ***
day3          0.7878     0.3836   2.054 0.044018 *  
day5         -0.1715     0.3836  -0.447 0.656285    
day7         -1.1818     0.3836  -3.081 0.003026 ** 
microbesy    -3.9406     0.3322 -11.862  &lt; 2e-16 ***
PWy           0.3403     0.3322   1.024 0.309477    
TBy           1.0799     0.2712   3.981 0.000175 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.151 on 65 degrees of freedom
Multiple R-squared:  0.7682,    Adjusted R-squared:  0.7468 
F-statistic:  35.9 on 6 and 65 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod2) <span class="co"># day, microbes, tb are all significant</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Response: log_adh_plus_sup
          Df  Sum Sq Mean Sq  F value    Pr(&gt;F)    
day        3  35.401  11.800   8.9106 4.993e-05 ***
microbes   1 227.459 227.459 171.7584 &lt; 2.2e-16 ***
PW         1   1.390   1.390   1.0493 0.3094769    
TB         1  20.990  20.990  15.8501 0.0001755 ***
Residuals 65  86.079   1.324                       
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">AIC</span>(mod2) <span class="co"># 233.1865 better model!</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 233.1865</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co"># comparisons</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>emmeans<span class="sc">::</span><span class="fu">emmeans</span>(mod2, pairwise <span class="sc">~</span> day) <span class="co"># same pattern as previous model, day 1-7 and 3-7</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$emmeans
 day emmean    SE df lower.CL upper.CL
 1     12.1 0.288 65     11.5     12.6
 3     12.8 0.288 65     12.3     13.4
 5     11.9 0.288 65     11.3     12.5
 7     10.9 0.288 65     10.3     11.5

Results are averaged over the levels of: microbes, PW, TB 
Confidence level used: 0.95 

$contrasts
 contrast    estimate    SE df t.ratio p.value
 day1 - day3   -0.788 0.384 65  -2.054  0.1794
 day1 - day5    0.172 0.384 65   0.447  0.9700
 day1 - day7    1.182 0.384 65   3.081  0.0156
 day3 - day5    0.959 0.384 65   2.501  0.0692
 day3 - day7    1.970 0.384 65   5.135  &lt;.0001
 day5 - day7    1.010 0.384 65   2.634  0.0504

Results are averaged over the levels of: microbes, PW, TB 
P value adjustment: tukey method for comparing a family of 4 estimates </code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>emmeans<span class="sc">::</span><span class="fu">emmeans</span>(mod2, pairwise <span class="sc">~</span> microbes) <span class="co"># microbes p &lt;.0001, no microbes sig more</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$emmeans
 microbes emmean    SE df lower.CL upper.CL
 n         13.89 0.166 65    13.56     14.2
 y          9.95 0.288 65     9.38     10.5

Results are averaged over the levels of: day, PW, TB 
Confidence level used: 0.95 

$contrasts
 contrast estimate    SE df t.ratio p.value
 n - y        3.94 0.332 65  11.862  &lt;.0001

Results are averaged over the levels of: day, PW, TB </code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>emmeans<span class="sc">::</span><span class="fu">emmeans</span>(mod2, pairwise <span class="sc">~</span> TB) <span class="co"># TB p = 0.0002, with TB is sig more</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$emmeans
 TB emmean    SE df lower.CL upper.CL
 n    11.4 0.214 65       11     11.8
 y    12.5 0.214 65       12     12.9

Results are averaged over the levels of: day, microbes, PW 
Confidence level used: 0.95 

$contrasts
 contrast estimate    SE df t.ratio p.value
 n - y       -1.08 0.271 65  -3.981  0.0002

Results are averaged over the levels of: day, microbes, PW </code></pre>
</div>
</div>
</section>
</section>
<section id="b-aquatic-environmental-biofilm-on-bd-growth" class="level1">
<h1>3b Aquatic environmental biofilm on Bd growth:</h1>
<p>All microbe-depleted, NO microbe+ treatment (from RC’s 3b figure legend)</p>
<section id="renweis-figure-1" class="level3">
<h3 class="anchored" data-anchor-id="renweis-figure-1">Renwei’s figure</h3>
<p><img src="data/3bRenwei.jpg" class="img-fluid" style="width:4in"></p>
</section>
<section id="ggplot-version-replicating-renweis-ae" class="level3">
<h3 class="anchored" data-anchor-id="ggplot-version-replicating-renweis-ae">ggplot version: replicating Renwei’s AE</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>ae_summary <span class="ot">&lt;-</span> ae <span class="sc">%&gt;%</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(day, sample_ID) <span class="sc">%&gt;%</span></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">reframe</span>(<span class="at">mean =</span> <span class="fu">mean</span>(adh), <span class="co"># calculate the mean</span></span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">n =</span> <span class="fu">length</span>(adh), <span class="co"># count the number of observations</span></span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">df =</span> n <span class="sc">-</span> <span class="dv">1</span>, <span class="co"># calculate the degrees of freedom</span></span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">sd =</span> <span class="fu">sd</span>(adh), <span class="co"># calculate the standard deviation</span></span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">se =</span> sd<span class="sc">/</span><span class="fu">sqrt</span>(n), <span class="co"># calculate the standard error</span></span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a>          ) <span class="sc">%&gt;%</span></span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add column for TB or no</span></span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">TB =</span> <span class="fu">case_when</span>(<span class="fu">str_detect</span>(sample_ID, <span class="st">"TB"</span>) <span class="sc">~</span> <span class="st">"y"</span>, <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"n"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb53-11"><a href="#cb53-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add column for PW or no</span></span>
<span id="cb53-12"><a href="#cb53-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">PW =</span> <span class="fu">case_when</span>(<span class="fu">str_detect</span>(sample_ID, <span class="st">"PW"</span>) <span class="sc">~</span> <span class="st">"y"</span>, <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"n"</span>))</span>
<span id="cb53-13"><a href="#cb53-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-14"><a href="#cb53-14" aria-hidden="true" tabindex="-1"></a>ae_summary <span class="sc">%&gt;%</span></span>
<span id="cb53-15"><a href="#cb53-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># reorder to match Renwei's plot</span></span>
<span id="cb53-16"><a href="#cb53-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sample_ID =</span> <span class="fu">factor</span>(sample_ID,</span>
<span id="cb53-17"><a href="#cb53-17" aria-hidden="true" tabindex="-1"></a>                            <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"1%TB+AEbiofilm"</span>, <span class="st">"MQ+AEbiofilm"</span>,</span>
<span id="cb53-18"><a href="#cb53-18" aria-hidden="true" tabindex="-1"></a>                                       <span class="st">"PW+AEBiofilm"</span>,   <span class="st">"Added Bd"</span>  ))) <span class="sc">%&gt;%</span></span>
<span id="cb53-19"><a href="#cb53-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-20"><a href="#cb53-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> day,</span>
<span id="cb53-21"><a href="#cb53-21" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> mean,</span>
<span id="cb53-22"><a href="#cb53-22" aria-hidden="true" tabindex="-1"></a>           <span class="at">color =</span> sample_ID)) <span class="sc">+</span></span>
<span id="cb53-23"><a href="#cb53-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb53-24"><a href="#cb53-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> mean <span class="sc">-</span> se, <span class="co"># plot the standard error</span></span>
<span id="cb53-25"><a href="#cb53-25" aria-hidden="true" tabindex="-1"></a>                    <span class="at">ymax =</span> mean <span class="sc">+</span> se),</span>
<span id="cb53-26"><a href="#cb53-26" aria-hidden="true" tabindex="-1"></a>                <span class="at">width =</span> <span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb53-27"><a href="#cb53-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb53-28"><a href="#cb53-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="fl">1e3</span>, <span class="fl">1e7</span>),</span>
<span id="cb53-29"><a href="#cb53-29" aria-hidden="true" tabindex="-1"></a>                <span class="at">breaks =</span> <span class="fu">c</span>(<span class="fl">1e3</span>, <span class="fl">1e4</span>, <span class="fl">1e5</span>, <span class="fl">1e6</span>, <span class="fl">1e7</span>)) <span class="sc">+</span></span>
<span id="cb53-30"><a href="#cb53-30" aria-hidden="true" tabindex="-1"></a>  <span class="co"># vibes</span></span>
<span id="cb53-31"><a href="#cb53-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Day"</span>,</span>
<span id="cb53-32"><a href="#cb53-32" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Bd Quantity per sample (ZE/well)"</span>,</span>
<span id="cb53-33"><a href="#cb53-33" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Environmental Biofilm"</span>,</span>
<span id="cb53-34"><a href="#cb53-34" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">"only adherent Bd visualized here (the only data we have)"</span>) <span class="sc">+</span></span>
<span id="cb53-35"><a href="#cb53-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"1%TB+AEbiofilm"</span><span class="ot">=</span> <span class="st">"orange"</span>,</span>
<span id="cb53-36"><a href="#cb53-36" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"MQ+AEbiofilm"</span> <span class="ot">=</span> <span class="st">"blue"</span>,</span>
<span id="cb53-37"><a href="#cb53-37" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"PW+AEBiofilm"</span> <span class="ot">=</span> <span class="st">"magenta"</span>,</span>
<span id="cb53-38"><a href="#cb53-38" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"Added Bd"</span> <span class="ot">=</span> <span class="st">"darkgrey"</span>)) <span class="sc">+</span> <span class="co"># Assign specific colors to match RC's plot</span></span>
<span id="cb53-39"><a href="#cb53-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb53-40"><a href="#cb53-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb53-41"><a href="#cb53-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.major.x =</span> <span class="fu">element_blank</span>(), <span class="co"># Remove major vertical grid lines</span></span>
<span id="cb53-42"><a href="#cb53-42" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor.x =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span> <span class="co"># Remove minor vertical grid lines</span></span>
<span id="cb53-43"><a href="#cb53-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">7</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="NCOS-biofilm_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="caitlins-version-ae" class="level3">
<h3 class="anchored" data-anchor-id="caitlins-version-ae">Caitlin’s version AE</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>ae_summary <span class="ot">&lt;-</span> ae <span class="sc">%&gt;%</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(day, sample_ID) <span class="sc">%&gt;%</span></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">reframe</span>(<span class="at">mean =</span> <span class="fu">mean</span>(adh), <span class="co"># calculate the mean</span></span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">n =</span> <span class="fu">length</span>(adh), <span class="co"># count the number of observations</span></span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">df =</span> n <span class="sc">-</span> <span class="dv">1</span>, <span class="co"># calculate the degrees of freedom</span></span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">sd =</span> <span class="fu">sd</span>(adh), <span class="co"># calculate the standard deviation</span></span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">se =</span> sd<span class="sc">/</span><span class="fu">sqrt</span>(n), <span class="co"># calculate the standard error</span></span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a>          ) <span class="sc">%&gt;%</span></span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add column for TB or no</span></span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">TB =</span> <span class="fu">case_when</span>(<span class="fu">str_detect</span>(sample_ID, <span class="st">"TB"</span>) <span class="sc">~</span> <span class="st">"y"</span>, <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"n"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb54-11"><a href="#cb54-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add column for PW or no</span></span>
<span id="cb54-12"><a href="#cb54-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">PW =</span> <span class="fu">case_when</span>(<span class="fu">str_detect</span>(sample_ID, <span class="st">"PW"</span>) <span class="sc">~</span> <span class="st">"y"</span>, <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"n"</span>))</span>
<span id="cb54-13"><a href="#cb54-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-14"><a href="#cb54-14" aria-hidden="true" tabindex="-1"></a>ae_summary <span class="sc">%&gt;%</span></span>
<span id="cb54-15"><a href="#cb54-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># reorder to match Renwei's plot</span></span>
<span id="cb54-16"><a href="#cb54-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sample_ID =</span> <span class="fu">factor</span>(sample_ID,</span>
<span id="cb54-17"><a href="#cb54-17" aria-hidden="true" tabindex="-1"></a>                            <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"1%TB+AEbiofilm"</span>, <span class="st">"MQ+AEbiofilm"</span>,</span>
<span id="cb54-18"><a href="#cb54-18" aria-hidden="true" tabindex="-1"></a>                                       <span class="st">"PW+AEBiofilm"</span>,   <span class="st">"Added Bd"</span>  ))) <span class="sc">%&gt;%</span></span>
<span id="cb54-19"><a href="#cb54-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-20"><a href="#cb54-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> day,</span>
<span id="cb54-21"><a href="#cb54-21" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> mean,</span>
<span id="cb54-22"><a href="#cb54-22" aria-hidden="true" tabindex="-1"></a>           <span class="at">color =</span> sample_ID)) <span class="sc">+</span></span>
<span id="cb54-23"><a href="#cb54-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb54-24"><a href="#cb54-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> mean <span class="sc">-</span> se, <span class="co"># plot the standard error</span></span>
<span id="cb54-25"><a href="#cb54-25" aria-hidden="true" tabindex="-1"></a>                    <span class="at">ymax =</span> mean <span class="sc">+</span> se),</span>
<span id="cb54-26"><a href="#cb54-26" aria-hidden="true" tabindex="-1"></a>                <span class="at">width =</span> <span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb54-27"><a href="#cb54-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb54-28"><a href="#cb54-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="fl">1e3</span>, <span class="fl">1e7</span>),</span>
<span id="cb54-29"><a href="#cb54-29" aria-hidden="true" tabindex="-1"></a>                <span class="at">breaks =</span> <span class="fu">c</span>(<span class="fl">1e3</span>, <span class="fl">1e4</span>, <span class="fl">1e5</span>, <span class="fl">1e6</span>, <span class="fl">1e7</span>)) <span class="sc">+</span></span>
<span id="cb54-30"><a href="#cb54-30" aria-hidden="true" tabindex="-1"></a>  <span class="co"># vibes</span></span>
<span id="cb54-31"><a href="#cb54-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Day"</span>,</span>
<span id="cb54-32"><a href="#cb54-32" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Bd Quantity in AE Biofilm (ZE/well)"</span>,</span>
<span id="cb54-33"><a href="#cb54-33" aria-hidden="true" tabindex="-1"></a>        <span class="at">color =</span> <span class="st">"Medium with</span><span class="sc">\n</span><span class="st">AE Biofilm"</span>)<span class="sc">+</span> <span class="co"># Title for color legend</span></span>
<span id="cb54-34"><a href="#cb54-34" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb54-35"><a href="#cb54-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"1%TB+AEbiofilm"</span><span class="ot">=</span> <span class="st">"#4477AA"</span>,</span>
<span id="cb54-36"><a href="#cb54-36" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"MQ+AEbiofilm"</span> <span class="ot">=</span> <span class="st">"#228833"</span>,</span>
<span id="cb54-37"><a href="#cb54-37" aria-hidden="true" tabindex="-1"></a>                                <span class="co">#"Added Bd" = "darkgrey",</span></span>
<span id="cb54-38"><a href="#cb54-38" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"PW+AEBiofilm"</span> <span class="ot">=</span> <span class="st">"#AA3377"</span>),</span>
<span id="cb54-39"><a href="#cb54-39" aria-hidden="true" tabindex="-1"></a>                    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"1%TB+AEbiofilm"</span> <span class="ot">=</span> <span class="st">"TB Broth"</span>,</span>
<span id="cb54-40"><a href="#cb54-40" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"MQ+AEbiofilm"</span> <span class="ot">=</span> <span class="st">"MQ Water"</span>,</span>
<span id="cb54-41"><a href="#cb54-41" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"PW+AEBiofilm"</span> <span class="ot">=</span> <span class="st">"Filtered</span><span class="sc">\n</span><span class="st">Pond Water"</span>,</span>
<span id="cb54-42"><a href="#cb54-42" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"Added Bd"</span> <span class="ot">=</span> <span class="st">"Initial Bd"</span>)) <span class="sc">+</span> <span class="co"># Custom labels</span></span>
<span id="cb54-43"><a href="#cb54-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-44"><a href="#cb54-44" aria-hidden="true" tabindex="-1"></a> <span class="fu">myCustomTheme</span>()<span class="sc">+</span></span>
<span id="cb54-45"><a href="#cb54-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">7</span>),</span>
<span id="cb54-46"><a href="#cb54-46" aria-hidden="true" tabindex="-1"></a>                   <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Initial</span><span class="sc">\n</span><span class="st">Bd"</span>, <span class="st">"1"</span>, <span class="st">"3"</span>, <span class="st">"5"</span>, <span class="st">"7"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="NCOS-biofilm_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="b-eda-1" class="level2">
<h2 class="anchored" data-anchor-id="b-eda-1">3b EDA</h2>
<section id="visualize-y-var-bd-load-1" class="level3">
<h3 class="anchored" data-anchor-id="visualize-y-var-bd-load-1">visualize y var: bd load</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co"># untransformed</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>ae_noday0 <span class="ot">&lt;-</span> ae <span class="sc">%&gt;%</span> </span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(day <span class="sc">!=</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">log_adh =</span> <span class="fu">log</span>(adh)) <span class="co"># note: no zeroes so not log + 1</span></span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggqqplot</span>(ae_noday0, <span class="st">"adh"</span>, <span class="at">title =</span> <span class="st">"untransformed"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="NCOS-biofilm_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(ae_noday0<span class="sc">$</span>adh) <span class="co"># nope</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  ae_noday0$adh
W = 0.69154, p-value = 2.089e-07</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(ae_noday0<span class="sc">$</span>adh) <span class="co"># note</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="NCOS-biofilm_files/figure-html/unnamed-chunk-14-2.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="co"># transformed</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggqqplot</span>(ae_noday0, <span class="st">"log_adh"</span>, <span class="at">title =</span> <span class="st">"log transformed"</span>) <span class="co"># gorgeous</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="NCOS-biofilm_files/figure-html/unnamed-chunk-14-3.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(ae_noday0<span class="sc">$</span>log_adh) <span class="co"># better</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="NCOS-biofilm_files/figure-html/unnamed-chunk-14-4.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(ae_noday0<span class="sc">$</span>log_adh) <span class="co"># p-value = 0.1699 def normal</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  ae_noday0$log_adh
W = 0.95671, p-value = 0.1699</code></pre>
</div>
</div>
</section>
</section>
<section id="b-stats-1" class="level2">
<h2 class="anchored" data-anchor-id="b-stats-1">3b Stats</h2>
<p>y var: amount of Bd in adherent</p>
<p>x vars: day &amp; medium (MQ, TB, PW)</p>
<p>Bd ~ day*medium</p>
<p>Question: Does the amount of Bd in the aquatic environmental biofilm differ across the media tested and across the days?</p>
<p>Model: 2-way ANOVA</p>
<p>Answer: Yes, there is a significant effect of day, presence of microbes, presence of TB as well as the interactions between day and microbes, day and TB, and a third-order interaction of day, microbes, and TB (three-way ANOVA, I recommend using a results table, it’s a lot of p and f and df values to list)</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="co"># quick check: we want day as a FACTOR</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>ae_noday0 <span class="ot">&lt;-</span> ae_noday0 <span class="sc">%&gt;%</span> </span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">day =</span> <span class="fu">as.factor</span>(day)) <span class="sc">%&gt;%</span> </span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a><span class="co"># column for medium</span></span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a><span class="fu">mutate</span>(<span class="at">medium =</span> sample_ID)</span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(ae_noday0<span class="sc">$</span>day)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> Factor w/ 4 levels "1","3","5","7": 1 2 3 4 1 2 3 4 1 2 ...</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set MQ as reference</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>ae_noday0<span class="sc">$</span>sample_ID <span class="ot">&lt;-</span> <span class="fu">factor</span>(ae_noday0<span class="sc">$</span>sample_ID)</span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>ae_noday0<span class="sc">$</span>sample_ID <span class="ot">&lt;-</span> <span class="fu">relevel</span>(ae_noday0<span class="sc">$</span>sample_ID, <span class="at">ref =</span> <span class="st">"MQ+AEbiofilm"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="null-1" class="level2">
<h2 class="anchored" data-anchor-id="null-1">null</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>null <span class="ot">&lt;-</span> <span class="fu">lm</span>(log_adh <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> ae_noday0)</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a><span class="fu">AIC</span>(null) <span class="co">#146.5865</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 146.5865</code></pre>
</div>
</div>
</section>
<section id="bd-daymedium" class="level2">
<h2 class="anchored" data-anchor-id="bd-daymedium">Bd ~ day*medium</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="co"># build model</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>mod1 <span class="ot">&lt;-</span> <span class="fu">aov</span>(log_adh <span class="sc">~</span> day<span class="sc">*</span>medium,</span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> ae_noday0)</span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a><span class="co"># diagnostic plot</span></span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mod1) <span class="co"># kinda not homoskedastic</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="NCOS-biofilm_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="co"># look at results</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>            Df Sum Sq Mean Sq F value   Pr(&gt;F)    
day          3  40.24  13.413  110.10 3.64e-14 ***
medium       2  60.07  30.036  246.55  &lt; 2e-16 ***
day:medium   6   7.42   1.236   10.14 1.30e-05 ***
Residuals   24   2.92   0.122                     
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod1) <span class="co"># all significant and interaction sig</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Response: log_adh
           Df Sum Sq Mean Sq F value    Pr(&gt;F)    
day         3 40.239 13.4129 110.100 3.642e-14 ***
medium      2 60.073 30.0364 246.553 &lt; 2.2e-16 ***
day:medium  6  7.415  1.2359  10.145 1.301e-05 ***
Residuals  24  2.924  0.1218                      
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="fu">AIC</span>(mod1) <span class="co"># 37.78083 better than null</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 37.78083</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="fu">TukeyHSD</span>(mod1) <span class="co"># all days sig diff from each other, all media sig diff from each other, second order is a bit messy</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  Tukey multiple comparisons of means
    95% family-wise confidence level

Fit: aov(formula = log_adh ~ day * medium, data = ae_noday0)

$day
          diff       lwr        upr     p adj
3-1 -1.1493419 -1.603234 -0.6954497 0.0000018
5-1 -2.1306208 -2.584513 -1.6767286 0.0000000
7-1 -2.8046545 -3.258547 -2.3507623 0.0000000
5-3 -0.9812789 -1.435171 -0.5273867 0.0000210
7-3 -1.6553126 -2.109205 -1.2014204 0.0000000
7-5 -0.6740337 -1.127926 -0.2201415 0.0021838

$medium
                                  diff        lwr         upr     p adj
MQ+AEbiofilm-1%TB+AEbiofilm  2.9323391  2.5764935  3.28818480 0.0000000
PW+AEBiofilm-1%TB+AEbiofilm  2.4957994  2.1399538  2.85164510 0.0000000
PW+AEBiofilm-MQ+AEbiofilm   -0.4365397 -0.7923854 -0.08069402 0.0142222

$`day:medium`
                                         diff         lwr         upr     p adj
3:1%TB+AEbiofilm-1:1%TB+AEbiofilm -2.04493896 -3.07249206 -1.01738586 0.0000113
5:1%TB+AEbiofilm-1:1%TB+AEbiofilm -2.09173123 -3.11928433 -1.06417813 0.0000078
7:1%TB+AEbiofilm-1:1%TB+AEbiofilm -1.99414642 -3.02169952 -0.96659332 0.0000169
1:MQ+AEbiofilm-1:1%TB+AEbiofilm    3.09761537  2.07006227  4.12516848 0.0000000
3:MQ+AEbiofilm-1:1%TB+AEbiofilm    1.98759548  0.96004238  3.01514858 0.0000179
5:MQ+AEbiofilm-1:1%TB+AEbiofilm    0.61984147 -0.40771163  1.64739458 0.5802121
7:MQ+AEbiofilm-1:1%TB+AEbiofilm   -0.10651243 -1.13406553  0.92104068 0.9999997
1:PW+AEBiofilm-1:1%TB+AEbiofilm    2.29587354  1.26832044  3.32342665 0.0000016
3:PW+AEBiofilm-1:1%TB+AEbiofilm    2.00280682  0.97525371  3.03035992 0.0000158
5:PW+AEBiofilm-1:1%TB+AEbiofilm    0.47351640 -0.55403671  1.50106950 0.8683022
7:PW+AEBiofilm-1:1%TB+AEbiofilm   -0.91981565 -1.94736875  0.10773746 0.1093965
5:1%TB+AEbiofilm-3:1%TB+AEbiofilm -0.04679227 -1.07434537  0.98076083 1.0000000
7:1%TB+AEbiofilm-3:1%TB+AEbiofilm  0.05079254 -0.97676056  1.07834564 1.0000000
1:MQ+AEbiofilm-3:1%TB+AEbiofilm    5.14255433  4.11500123  6.17010744 0.0000000
3:MQ+AEbiofilm-3:1%TB+AEbiofilm    4.03253444  3.00498134  5.06008754 0.0000000
5:MQ+AEbiofilm-3:1%TB+AEbiofilm    2.66478043  1.63722733  3.69233354 0.0000001
7:MQ+AEbiofilm-3:1%TB+AEbiofilm    1.93842653  0.91087343  2.96597964 0.0000266
1:PW+AEBiofilm-3:1%TB+AEbiofilm    4.34081250  3.31325940  5.36836561 0.0000000
3:PW+AEBiofilm-3:1%TB+AEbiofilm    4.04774578  3.02019267  5.07529888 0.0000000
5:PW+AEBiofilm-3:1%TB+AEbiofilm    2.51845536  1.49090225  3.54600846 0.0000003
7:PW+AEBiofilm-3:1%TB+AEbiofilm    1.12512331  0.09757021  2.15267642 0.0234402
7:1%TB+AEbiofilm-5:1%TB+AEbiofilm  0.09758481 -0.92996829  1.12513791 0.9999999
1:MQ+AEbiofilm-5:1%TB+AEbiofilm    5.18934660  4.16179350  6.21689970 0.0000000
3:MQ+AEbiofilm-5:1%TB+AEbiofilm    4.07932671  3.05177361  5.10687981 0.0000000
5:MQ+AEbiofilm-5:1%TB+AEbiofilm    2.71157270  1.68401960  3.73912581 0.0000001
7:MQ+AEbiofilm-5:1%TB+AEbiofilm    1.98521880  0.95766570  3.01277191 0.0000182
1:PW+AEBiofilm-5:1%TB+AEbiofilm    4.38760477  3.36005167  5.41515788 0.0000000
3:PW+AEBiofilm-5:1%TB+AEbiofilm    4.09453805  3.06698494  5.12209115 0.0000000
5:PW+AEBiofilm-5:1%TB+AEbiofilm    2.56524763  1.53769452  3.59280073 0.0000002
7:PW+AEBiofilm-5:1%TB+AEbiofilm    1.17191558  0.14436248  2.19946869 0.0161067
1:MQ+AEbiofilm-7:1%TB+AEbiofilm    5.09176179  4.06420869  6.11931489 0.0000000
3:MQ+AEbiofilm-7:1%TB+AEbiofilm    3.98174190  2.95418880  5.00929500 0.0000000
5:MQ+AEbiofilm-7:1%TB+AEbiofilm    2.61398789  1.58643479  3.64154100 0.0000001
7:MQ+AEbiofilm-7:1%TB+AEbiofilm    1.88763399  0.86008089  2.91518710 0.0000404
1:PW+AEBiofilm-7:1%TB+AEbiofilm    4.29001996  3.26246686  5.31757307 0.0000000
3:PW+AEBiofilm-7:1%TB+AEbiofilm    3.99695324  2.96940013  5.02450634 0.0000000
5:PW+AEBiofilm-7:1%TB+AEbiofilm    2.46766282  1.44010971  3.49521592 0.0000004
7:PW+AEBiofilm-7:1%TB+AEbiofilm    1.07433077  0.04677767  2.10188388 0.0349376
3:MQ+AEbiofilm-1:MQ+AEbiofilm     -1.11001989 -2.13757300 -0.08246679 0.0264194
5:MQ+AEbiofilm-1:MQ+AEbiofilm     -2.47777390 -3.50532700 -1.45022079 0.0000004
7:MQ+AEbiofilm-1:MQ+AEbiofilm     -3.20412780 -4.23168090 -2.17657470 0.0000000
1:PW+AEBiofilm-1:MQ+AEbiofilm     -0.80174183 -1.82929493  0.22581127 0.2352787
3:PW+AEBiofilm-1:MQ+AEbiofilm     -1.09480855 -2.12236166 -0.06725545 0.0297786
5:PW+AEBiofilm-1:MQ+AEbiofilm     -2.62409897 -3.65165208 -1.59654587 0.0000001
7:PW+AEBiofilm-1:MQ+AEbiofilm     -4.01743102 -5.04498412 -2.98987792 0.0000000
5:MQ+AEbiofilm-3:MQ+AEbiofilm     -1.36775401 -2.39530711 -0.34020090 0.0031814
7:MQ+AEbiofilm-3:MQ+AEbiofilm     -2.09410791 -3.12166101 -1.06655480 0.0000076
1:PW+AEBiofilm-3:MQ+AEbiofilm      0.30827806 -0.71927504  1.33583117 0.9927584
3:PW+AEBiofilm-3:MQ+AEbiofilm      0.01521134 -1.01234177  1.04276444 1.0000000
5:PW+AEBiofilm-3:MQ+AEbiofilm     -1.51407908 -2.54163219 -0.48652598 0.0009231
7:PW+AEBiofilm-3:MQ+AEbiofilm     -2.90741113 -3.93496423 -1.87985802 0.0000000
7:MQ+AEbiofilm-5:MQ+AEbiofilm     -0.72635390 -1.75390700  0.30119920 0.3586125
1:PW+AEBiofilm-5:MQ+AEbiofilm      1.67603207  0.64847897  2.70358517 0.0002348
3:PW+AEBiofilm-5:MQ+AEbiofilm      1.38296534  0.35541224  2.41051845 0.0027988
5:PW+AEBiofilm-5:MQ+AEbiofilm     -0.14632508 -1.17387818  0.88122803 0.9999930
7:PW+AEBiofilm-5:MQ+AEbiofilm     -1.53965712 -2.56721022 -0.51210402 0.0007432
1:PW+AEBiofilm-7:MQ+AEbiofilm      2.40238597  1.37483287  3.42993907 0.0000007
3:PW+AEBiofilm-7:MQ+AEbiofilm      2.10931925  1.08176614  3.13687235 0.0000067
5:PW+AEBiofilm-7:MQ+AEbiofilm      0.58002883 -0.44752428  1.60758193 0.6677092
7:PW+AEBiofilm-7:MQ+AEbiofilm     -0.81330322 -1.84085632  0.21424988 0.2194307
3:PW+AEBiofilm-1:PW+AEBiofilm     -0.29306673 -1.32061983  0.73448638 0.9952000
5:PW+AEBiofilm-1:PW+AEBiofilm     -1.82235715 -2.84991025 -0.79480404 0.0000692
7:PW+AEBiofilm-1:PW+AEBiofilm     -3.21568919 -4.24324229 -2.18813609 0.0000000
5:PW+AEBiofilm-3:PW+AEBiofilm     -1.52929042 -2.55684352 -0.50173732 0.0008115
7:PW+AEBiofilm-3:PW+AEBiofilm     -2.92262246 -3.95017557 -1.89506936 0.0000000
7:PW+AEBiofilm-5:PW+AEBiofilm     -1.39333205 -2.42088515 -0.36577894 0.0025645</code></pre>
</div>
</div>
<p>Summary of results</p>
<p>Day 1 &gt; Day 3 &gt; Day 5 &gt; Day 7 (all p &lt;0.005) in other words, Bd significantly reduced each day</p>
<p>MQ+AEbiofilm &gt; PW+AEBiofilm &gt; 1%TB+AEbiofilm (TB plus biofilm has most Bd inhibition power, followed by pond water, then by milliQ with the least inhibition power)</p>
<p>lets try Bd ~ day*TB*PW</p>
<p>This is nearly identical, same AIC, I think needlessly complex</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="co"># # build model</span></span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a><span class="co"># mod2 &lt;- aov(log_adh ~ day*TB*PW,</span></span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a><span class="co">#   data = ae_noday0)</span></span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a><span class="co"># # diagnostic plot</span></span>
<span id="cb77-6"><a href="#cb77-6" aria-hidden="true" tabindex="-1"></a><span class="co"># par(mfrow = c(2,2))</span></span>
<span id="cb77-7"><a href="#cb77-7" aria-hidden="true" tabindex="-1"></a><span class="co"># plot(mod2) # kinda not homoskedastic</span></span>
<span id="cb77-8"><a href="#cb77-8" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb77-9"><a href="#cb77-9" aria-hidden="true" tabindex="-1"></a><span class="co"># # look at results</span></span>
<span id="cb77-10"><a href="#cb77-10" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(mod2)</span></span>
<span id="cb77-11"><a href="#cb77-11" aria-hidden="true" tabindex="-1"></a><span class="co"># anova(mod2) # all significant and interaction sig</span></span>
<span id="cb77-12"><a href="#cb77-12" aria-hidden="true" tabindex="-1"></a><span class="co"># AIC(mod2) # 37.78083 same exact aic</span></span>
<span id="cb77-13"><a href="#cb77-13" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb77-14"><a href="#cb77-14" aria-hidden="true" tabindex="-1"></a><span class="co"># TukeyHSD(mod2) # all days sig diff from each other, all media sig diff from each other, second order is a bit messy</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="b-monolayer-biofilm-on-bd-growth" class="level1">
<h1>4b Monolayer biofilm on Bd growth:</h1>
<p>It looks like solid lines are with microbes and dashed lines are without microbes</p>
<section id="renweis-figure-2" class="level3">
<h3 class="anchored" data-anchor-id="renweis-figure-2">Renwei’s figure</h3>
<p><img src="data/4b_monolayer.jpg" class="img-fluid" style="width:4in"></p>
</section>
<section id="ggplot-version-replicating-renweis-ml" class="level3">
<h3 class="anchored" data-anchor-id="ggplot-version-replicating-renweis-ml">ggplot version: replicating Renwei’s ML</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>monolayer_summary <span class="ot">&lt;-</span> monolayer <span class="sc">%&gt;%</span> </span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(day, sample_ID) <span class="sc">%&gt;%</span> </span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">reframe</span>(<span class="at">mean =</span> <span class="fu">mean</span>(adh_plus_sup), <span class="co"># calculate the mean</span></span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">n =</span> <span class="fu">length</span>(adh_plus_sup), <span class="co"># count the number of observations</span></span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">df =</span> n <span class="sc">-</span> <span class="dv">1</span>, <span class="co"># calculate the degrees of freedom</span></span>
<span id="cb78-6"><a href="#cb78-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">sd =</span> <span class="fu">sd</span>(adh_plus_sup), <span class="co"># calculate the standard deviation</span></span>
<span id="cb78-7"><a href="#cb78-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">se =</span> sd<span class="sc">/</span><span class="fu">sqrt</span>(n), <span class="co"># calculate the standard error</span></span>
<span id="cb78-8"><a href="#cb78-8" aria-hidden="true" tabindex="-1"></a>          ) <span class="sc">%&gt;%</span> </span>
<span id="cb78-9"><a href="#cb78-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">microbes =</span> <span class="fu">case_when</span>(</span>
<span id="cb78-10"><a href="#cb78-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_detect</span>(sample_ID, <span class="st">"</span><span class="sc">\\</span><span class="st">+microbes"</span>) <span class="sc">~</span> <span class="st">"y"</span>,<span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"n"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb78-11"><a href="#cb78-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add column for TB or no</span></span>
<span id="cb78-12"><a href="#cb78-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">TB =</span> <span class="fu">case_when</span>(<span class="fu">str_detect</span>(sample_ID, <span class="st">"TB"</span>) <span class="sc">~</span> <span class="st">"y"</span>, <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"n"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb78-13"><a href="#cb78-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add column for PW or no</span></span>
<span id="cb78-14"><a href="#cb78-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">PW =</span> <span class="fu">case_when</span>(<span class="fu">str_detect</span>(sample_ID, <span class="st">"PW"</span>) <span class="sc">~</span> <span class="st">"y"</span>, <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"n"</span>)) </span>
<span id="cb78-15"><a href="#cb78-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-16"><a href="#cb78-16" aria-hidden="true" tabindex="-1"></a>monolayer_summary <span class="sc">%&gt;%</span> </span>
<span id="cb78-17"><a href="#cb78-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># reorder to match Renwei's plot</span></span>
<span id="cb78-18"><a href="#cb78-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sample_ID =</span> <span class="fu">factor</span>(sample_ID, </span>
<span id="cb78-19"><a href="#cb78-19" aria-hidden="true" tabindex="-1"></a>                            <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"TB+PW+microbes"</span>,<span class="st">"PW+microbes"</span>,</span>
<span id="cb78-20"><a href="#cb78-20" aria-hidden="true" tabindex="-1"></a>                                        <span class="st">"TB+PW-microbes"</span>, <span class="st">"PW-microbes"</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb78-21"><a href="#cb78-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> day, </span>
<span id="cb78-22"><a href="#cb78-22" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> mean, </span>
<span id="cb78-23"><a href="#cb78-23" aria-hidden="true" tabindex="-1"></a>           <span class="at">color =</span> sample_ID)) <span class="sc">+</span></span>
<span id="cb78-24"><a href="#cb78-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb78-25"><a href="#cb78-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> mean <span class="sc">-</span> se, <span class="co"># plot the standard error</span></span>
<span id="cb78-26"><a href="#cb78-26" aria-hidden="true" tabindex="-1"></a>                    <span class="at">ymax =</span> mean <span class="sc">+</span> se),</span>
<span id="cb78-27"><a href="#cb78-27" aria-hidden="true" tabindex="-1"></a>                <span class="at">width =</span> <span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb78-28"><a href="#cb78-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">linetype =</span> microbes)) <span class="sc">+</span> </span>
<span id="cb78-29"><a href="#cb78-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="fl">1e4</span>, <span class="fl">1e8</span>), </span>
<span id="cb78-30"><a href="#cb78-30" aria-hidden="true" tabindex="-1"></a>                <span class="at">breaks =</span> <span class="fu">c</span>(<span class="fl">1e4</span>, <span class="fl">1e5</span>, <span class="fl">1e6</span>, <span class="fl">1e7</span>, <span class="fl">1e8</span>)) <span class="sc">+</span></span>
<span id="cb78-31"><a href="#cb78-31" aria-hidden="true" tabindex="-1"></a>  <span class="co"># vibes</span></span>
<span id="cb78-32"><a href="#cb78-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Day"</span>,</span>
<span id="cb78-33"><a href="#cb78-33" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Bd Quantity per sample (ZE/well)"</span>,</span>
<span id="cb78-34"><a href="#cb78-34" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Monolayer"</span>,</span>
<span id="cb78-35"><a href="#cb78-35" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">"supernatant plus adherent visualized here"</span>) <span class="sc">+</span></span>
<span id="cb78-36"><a href="#cb78-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"TB+PW+microbes"</span> <span class="ot">=</span> <span class="st">"palegreen4"</span>, </span>
<span id="cb78-37"><a href="#cb78-37" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"PW+microbes"</span> <span class="ot">=</span> <span class="st">"magenta"</span>, </span>
<span id="cb78-38"><a href="#cb78-38" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"TB+PW-microbes"</span> <span class="ot">=</span> <span class="st">"chocolate4"</span>, </span>
<span id="cb78-39"><a href="#cb78-39" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"PW-microbes"</span> <span class="ot">=</span> <span class="st">"purple"</span>)) <span class="sc">+</span> <span class="co"># Assign specific colors to match RC's plot</span></span>
<span id="cb78-40"><a href="#cb78-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_linetype_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"n"</span> <span class="ot">=</span> <span class="st">"dashed"</span>, </span>
<span id="cb78-41"><a href="#cb78-41" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">"y"</span> <span class="ot">=</span> <span class="st">"solid"</span>)) <span class="sc">+</span></span>
<span id="cb78-42"><a href="#cb78-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb78-43"><a href="#cb78-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb78-44"><a href="#cb78-44" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.major.x =</span> <span class="fu">element_blank</span>(), <span class="co"># Remove major vertical grid lines</span></span>
<span id="cb78-45"><a href="#cb78-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor.x =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span> <span class="co"># Remove minor vertical grid lines</span></span>
<span id="cb78-46"><a href="#cb78-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">7</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="NCOS-biofilm_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="caitlins-version-ml" class="level2">
<h2 class="anchored" data-anchor-id="caitlins-version-ml">Caitlin’s version ML</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>monolayer_summary <span class="ot">&lt;-</span> monolayer <span class="sc">%&gt;%</span> </span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(day, sample_ID) <span class="sc">%&gt;%</span> </span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">reframe</span>(<span class="at">mean =</span> <span class="fu">mean</span>(adh_plus_sup), <span class="co"># calculate the mean</span></span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">n =</span> <span class="fu">length</span>(adh_plus_sup), <span class="co"># count the number of observations</span></span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">df =</span> n <span class="sc">-</span> <span class="dv">1</span>, <span class="co"># calculate the degrees of freedom</span></span>
<span id="cb79-6"><a href="#cb79-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">sd =</span> <span class="fu">sd</span>(adh_plus_sup), <span class="co"># calculate the standard deviation</span></span>
<span id="cb79-7"><a href="#cb79-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">se =</span> sd<span class="sc">/</span><span class="fu">sqrt</span>(n), <span class="co"># calculate the standard error</span></span>
<span id="cb79-8"><a href="#cb79-8" aria-hidden="true" tabindex="-1"></a>          ) <span class="sc">%&gt;%</span> </span>
<span id="cb79-9"><a href="#cb79-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">microbes =</span> <span class="fu">case_when</span>(</span>
<span id="cb79-10"><a href="#cb79-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_detect</span>(sample_ID, <span class="st">"</span><span class="sc">\\</span><span class="st">+microbes"</span>) <span class="sc">~</span> <span class="st">"y"</span>,<span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"n"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb79-11"><a href="#cb79-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add column for TB or no</span></span>
<span id="cb79-12"><a href="#cb79-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">TB =</span> <span class="fu">case_when</span>(<span class="fu">str_detect</span>(sample_ID, <span class="st">"TB"</span>) <span class="sc">~</span> <span class="st">"y"</span>, <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"n"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb79-13"><a href="#cb79-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add column for PW or no</span></span>
<span id="cb79-14"><a href="#cb79-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">PW =</span> <span class="fu">case_when</span>(<span class="fu">str_detect</span>(sample_ID, <span class="st">"PW"</span>) <span class="sc">~</span> <span class="st">"y"</span>, <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"n"</span>)) </span>
<span id="cb79-15"><a href="#cb79-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-16"><a href="#cb79-16" aria-hidden="true" tabindex="-1"></a>monolayer_summary <span class="sc">%&gt;%</span> </span>
<span id="cb79-17"><a href="#cb79-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># reorder to match Renwei's plot</span></span>
<span id="cb79-18"><a href="#cb79-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sample_ID =</span> <span class="fu">factor</span>(sample_ID, </span>
<span id="cb79-19"><a href="#cb79-19" aria-hidden="true" tabindex="-1"></a>                            <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"TB+PW+microbes"</span>,<span class="st">"PW+microbes"</span>,</span>
<span id="cb79-20"><a href="#cb79-20" aria-hidden="true" tabindex="-1"></a>                                        <span class="st">"TB+PW-microbes"</span>, <span class="st">"PW-microbes"</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb79-21"><a href="#cb79-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> day, </span>
<span id="cb79-22"><a href="#cb79-22" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> mean, </span>
<span id="cb79-23"><a href="#cb79-23" aria-hidden="true" tabindex="-1"></a>           <span class="at">color =</span> sample_ID)) <span class="sc">+</span></span>
<span id="cb79-24"><a href="#cb79-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb79-25"><a href="#cb79-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> mean <span class="sc">-</span> se, <span class="co"># plot the standard error</span></span>
<span id="cb79-26"><a href="#cb79-26" aria-hidden="true" tabindex="-1"></a>                    <span class="at">ymax =</span> mean <span class="sc">+</span> se),</span>
<span id="cb79-27"><a href="#cb79-27" aria-hidden="true" tabindex="-1"></a>                <span class="at">width =</span> <span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb79-28"><a href="#cb79-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">linetype =</span> microbes)) <span class="sc">+</span> </span>
<span id="cb79-29"><a href="#cb79-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="fl">1e4</span>, <span class="fl">1e8</span>), </span>
<span id="cb79-30"><a href="#cb79-30" aria-hidden="true" tabindex="-1"></a>                <span class="at">breaks =</span> <span class="fu">c</span>(<span class="fl">1e4</span>, <span class="fl">1e5</span>, <span class="fl">1e6</span>, <span class="fl">1e7</span>, <span class="fl">1e8</span>)) <span class="sc">+</span></span>
<span id="cb79-31"><a href="#cb79-31" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb79-32"><a href="#cb79-32" aria-hidden="true" tabindex="-1"></a>  <span class="co"># vibes</span></span>
<span id="cb79-33"><a href="#cb79-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Day"</span>,</span>
<span id="cb79-34"><a href="#cb79-34" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Bd in mono-Bd biofilm (ZE/well)"</span>,</span>
<span id="cb79-35"><a href="#cb79-35" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">"Medium"</span>,       <span class="co"># Title for color legend</span></span>
<span id="cb79-36"><a href="#cb79-36" aria-hidden="true" tabindex="-1"></a>       <span class="at">linetype =</span> <span class="st">"Microbes Present"</span>) <span class="sc">+</span></span>
<span id="cb79-37"><a href="#cb79-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"TB+PW+microbes"</span> <span class="ot">=</span> <span class="st">"#4477AA"</span>, </span>
<span id="cb79-38"><a href="#cb79-38" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"PW+microbes"</span> <span class="ot">=</span> <span class="st">"#EE6677"</span>, </span>
<span id="cb79-39"><a href="#cb79-39" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"TB+PW-microbes"</span> <span class="ot">=</span> <span class="st">"#66CCEE"</span>, </span>
<span id="cb79-40"><a href="#cb79-40" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"PW-microbes"</span> <span class="ot">=</span> <span class="st">"#AA3377"</span>), </span>
<span id="cb79-41"><a href="#cb79-41" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb79-42"><a href="#cb79-42" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"TB+PW+microbes"</span> <span class="ot">=</span> <span class="st">"TB + PW + MO"</span>,</span>
<span id="cb79-43"><a href="#cb79-43" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"PW+microbes"</span> <span class="ot">=</span> <span class="st">"PW + MO"</span>,</span>
<span id="cb79-44"><a href="#cb79-44" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"TB+PW-microbes"</span> <span class="ot">=</span> <span class="st">"TB + PW - MO"</span>,</span>
<span id="cb79-45"><a href="#cb79-45" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"PW-microbes"</span> <span class="ot">=</span> <span class="st">"PW - MO"</span>)) <span class="sc">+</span> <span class="co"># Custom labels</span></span>
<span id="cb79-46"><a href="#cb79-46" aria-hidden="true" tabindex="-1"></a> <span class="fu">myCustomTheme</span>()<span class="sc">+</span></span>
<span id="cb79-47"><a href="#cb79-47" aria-hidden="true" tabindex="-1"></a> <span class="fu">scale_linetype_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"n"</span> <span class="ot">=</span> <span class="st">"dashed"</span>, </span>
<span id="cb79-48"><a href="#cb79-48" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">"y"</span> <span class="ot">=</span> <span class="st">"solid"</span>),</span>
<span id="cb79-49"><a href="#cb79-49" aria-hidden="true" tabindex="-1"></a>                        <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"n"</span> <span class="ot">=</span> <span class="st">"N"</span>, <span class="st">"y"</span> <span class="ot">=</span> <span class="st">"Y"</span>)) <span class="sc">+</span>  <span class="co"># Change labels to uppercase N and Y</span></span>
<span id="cb79-50"><a href="#cb79-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">7</span>),</span>
<span id="cb79-51"><a href="#cb79-51" aria-hidden="true" tabindex="-1"></a>                   <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Initial</span><span class="sc">\n</span><span class="st">Bd"</span>, <span class="st">"1"</span>, <span class="st">"3"</span>, <span class="st">"5"</span>, <span class="st">"7"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="NCOS-biofilm_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="b-eda-2" class="level1">
<h1>4b EDA</h1>
<section id="visualize-y-var-bd-load-2" class="level3">
<h3 class="anchored" data-anchor-id="visualize-y-var-bd-load-2">visualize y var: bd load</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="co"># untransformed</span></span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>ml_noday0 <span class="ot">&lt;-</span> monolayer <span class="sc">%&gt;%</span> </span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(day <span class="sc">!=</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">log_adh_plus_sup =</span> <span class="fu">log</span>(adh_plus_sup)) <span class="co"># note: no zeroes so not log + 1</span></span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggqqplot</span>(ml_noday0, <span class="st">"adh_plus_sup"</span>, <span class="at">title =</span> <span class="st">"untransformed"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="NCOS-biofilm_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(ml_noday0<span class="sc">$</span>adh_plus_sup) <span class="co"># nope</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  ml_noday0$adh_plus_sup
W = 0.70581, p-value = 1.684e-08</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(ml_noday0<span class="sc">$</span>adh_plus_sup) <span class="co"># note</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="NCOS-biofilm_files/figure-html/unnamed-chunk-21-2.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="co"># transformed</span></span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggqqplot</span>(ml_noday0, <span class="st">"log_adh_plus_sup"</span>, <span class="at">title =</span> <span class="st">"log transformed"</span>) <span class="co"># gorgeous</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="NCOS-biofilm_files/figure-html/unnamed-chunk-21-3.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(ml_noday0<span class="sc">$</span>log_adh_plus_sup) <span class="co"># better</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="NCOS-biofilm_files/figure-html/unnamed-chunk-21-4.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(ml_noday0<span class="sc">$</span>log_adh_plus_sup) <span class="co"># p-value = 0.01321 not quite normal</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  ml_noday0$log_adh_plus_sup
W = 0.93767, p-value = 0.01321</code></pre>
</div>
</div>
</section>
<section id="b-stats-2" class="level2">
<h2 class="anchored" data-anchor-id="b-stats-2">4b Stats</h2>
<p>y var: amount of Bd</p>
<p>x vars: day, treatment, microbes y/n, pw y/n, tb y/n</p>
<p>Best model: Bd ~ day*microbes*TB</p>
<p>Question: Does the amount of Bd in the sample differ across the treatments of presence of microbes, TB, and day?</p>
<p>Model: 3-way ANOVA</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="co"># quick check: we want day as a FACTOR</span></span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a>ml_noday0 <span class="ot">&lt;-</span> ml_noday0 <span class="sc">%&gt;%</span> </span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">day =</span> <span class="fu">as.factor</span>(day))</span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(ml_noday0<span class="sc">$</span>day)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> Factor w/ 4 levels "1","3","5","7": 1 2 3 4 1 2 3 4 1 2 ...</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set PW-microbes as reference (no milliQ here)</span></span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>ml_noday0<span class="sc">$</span>sample_ID <span class="ot">&lt;-</span> <span class="fu">factor</span>(ml_noday0<span class="sc">$</span>sample_ID)</span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a>ml_noday0<span class="sc">$</span>sample_ID <span class="ot">&lt;-</span> <span class="fu">relevel</span>(ml_noday0<span class="sc">$</span>sample_ID, <span class="at">ref =</span> <span class="st">"PW-microbes"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="null-2" class="level2">
<h2 class="anchored" data-anchor-id="null-2">null</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a>null <span class="ot">&lt;-</span> <span class="fu">lm</span>(log_adh_plus_sup <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> ml_noday0)</span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a><span class="fu">AIC</span>(null) <span class="co">#205.8778</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 205.8778</code></pre>
</div>
</div>
</section>
<section id="best-model-bd-daymicrobestb-1" class="level2">
<h2 class="anchored" data-anchor-id="best-model-bd-daymicrobestb-1">Best model: Bd ~ day*microbes*TB</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="co"># build model</span></span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a>mod3 <span class="ot">&lt;-</span> <span class="fu">aov</span>(log_adh_plus_sup <span class="sc">~</span> day<span class="sc">*</span>microbes<span class="sc">*</span>TB,</span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> ml_noday0)</span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-5"><a href="#cb93-5" aria-hidden="true" tabindex="-1"></a><span class="co"># diagnostic plot</span></span>
<span id="cb93-6"><a href="#cb93-6" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb93-7"><a href="#cb93-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mod3) <span class="co"># not bad</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="NCOS-biofilm_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="co"># look at results</span></span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                Df Sum Sq Mean Sq F value   Pr(&gt;F)    
day              3  87.73   29.24  51.956 2.12e-12 ***
microbes         1  45.11   45.11  80.150 3.16e-10 ***
TB               1   0.14    0.14   0.244 0.624668    
day:microbes     3  14.09    4.70   8.343 0.000306 ***
day:TB           3   0.43    0.14   0.258 0.855388    
microbes:TB      1  21.95   21.95  38.994 5.36e-07 ***
day:microbes:TB  3   1.03    0.34   0.612 0.612365    
Residuals       32  18.01    0.56                     
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod3) <span class="co"># day, microbes, tb are all significant, interactions: day:TB, day:microbes, day:microbes:TB, NOT microbes:TB </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Response: log_adh_plus_sup
                Df Sum Sq Mean Sq F value    Pr(&gt;F)    
day              3 87.734  29.245 51.9556 2.125e-12 ***
microbes         1 45.114  45.114 80.1497 3.159e-10 ***
TB               1  0.137   0.137  0.2441 0.6246676    
day:microbes     3 14.088   4.696  8.3430 0.0003062 ***
day:TB           3  0.435   0.145  0.2575 0.8553879    
microbes:TB      1 21.949  21.949 38.9944 5.357e-07 ***
day:microbes:TB  3  1.033   0.344  0.6117 0.6123649    
Residuals       32 18.012   0.563                      
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="fu">AIC</span>(mod3) <span class="co"># 123.1704 better than null</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 123.1704</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="fu">TukeyHSD</span>(mod3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  Tukey multiple comparisons of means
    95% family-wise confidence level

Fit: aov(formula = log_adh_plus_sup ~ day * microbes * TB, data = ml_noday0)

$day
          diff       lwr        upr     p adj
3-1 -1.1794120 -2.009259 -0.3495653 0.0028472
5-1 -2.7740393 -3.603886 -1.9441926 0.0000000
7-1 -3.4578367 -4.287683 -2.6279900 0.0000000
5-3 -1.5946273 -2.424474 -0.7647806 0.0000621
7-3 -2.2784247 -3.108271 -1.4485780 0.0000001
7-5 -0.6837974 -1.513644  0.1460493 0.1361563

$microbes
         diff       lwr       upr p adj
y-n -1.938951 -2.380108 -1.497795     0

$TB
          diff        lwr       upr     p adj
y-n -0.1069938 -0.5481504 0.3341627 0.6246676

$`day:microbes`
                diff        lwr         upr     p adj
3:n-1:n -0.009980032 -1.4131066  1.39314653 1.0000000
5:n-1:n -1.434808205 -2.8379348 -0.03168164 0.0421262
7:n-1:n -3.005806163 -4.4089327 -1.60267960 0.0000019
1:y-1:n -0.458604465 -1.8617310  0.94452210 0.9607786
3:y-1:n -2.807448522 -4.2105751 -1.40432196 0.0000070
5:y-1:n -4.571874907 -5.9750015 -3.16874835 0.0000000
7:y-1:n -4.368471773 -5.7715983 -2.96534521 0.0000000
5:n-3:n -1.424828172 -2.8279547 -0.02170161 0.0444766
7:n-3:n -2.995826131 -4.3989527 -1.59269957 0.0000021
1:y-3:n -0.448624433 -1.8517510  0.95450213 0.9650948
3:y-3:n -2.797468489 -4.2005951 -1.39434193 0.0000075
5:y-3:n -4.561894875 -5.9650214 -3.15876831 0.0000000
7:y-3:n -4.358491741 -5.7616183 -2.95536518 0.0000000
7:n-5:n -1.570997958 -2.9741245 -0.16787140 0.0195621
1:y-5:n  0.976203739 -0.4269228  2.37933030 0.3488075
3:y-5:n -1.372640317 -2.7757669  0.03048624 0.0587961
5:y-5:n -3.137066703 -4.5401933 -1.73394014 0.0000008
7:y-5:n -2.933663568 -4.3367901 -1.53053701 0.0000031
1:y-7:n  2.547201698  1.1440751  3.95032826 0.0000387
3:y-7:n  0.198357641 -1.2047689  1.60148420 0.9997660
5:y-7:n -1.566068744 -2.9691953 -0.16294218 0.0201286
7:y-7:n -1.362665610 -2.7657922  0.04046095 0.0619588
3:y-1:y -2.348844056 -3.7519706 -0.94571749 0.0001432
5:y-1:y -4.113270442 -5.5163970 -2.71014388 0.0000000
7:y-1:y -3.909867307 -5.3129939 -2.50674075 0.0000000
5:y-3:y -1.764426386 -3.1675529 -0.36129982 0.0061460
7:y-3:y -1.561023251 -2.9641498 -0.15789669 0.0207242
7:y-5:y  0.203403134 -1.1997234  1.60652970 0.9997236

$`day:TB`
                diff         lwr         upr     p adj
3:n-1:n -1.164819894 -2.56794646  0.23830667 0.1628028
5:n-1:n -2.917254332 -4.32038089 -1.51412777 0.0000034
7:n-1:n -3.668172706 -5.07129927 -2.26504614 0.0000000
1:y-1:n -0.276473262 -1.67959982  1.12665330 0.9979801
3:y-1:n -1.470477455 -2.87360402 -0.06735089 0.0346174
5:y-1:n -2.907297576 -4.31042414 -1.50417101 0.0000036
7:y-1:n -3.523974026 -4.92710059 -2.12084746 0.0000001
5:n-3:n -1.752434437 -3.15556100 -0.34930788 0.0066158
7:n-3:n -2.503352812 -3.90647937 -1.10022625 0.0000517
1:y-3:n  0.888346633 -0.51477993  2.29147319 0.4659960
3:y-3:n -0.305657561 -1.70878412  1.09746900 0.9962207
5:y-3:n -1.742477682 -3.14560424 -0.33935112 0.0070319
7:y-3:n -2.359154131 -3.76228069 -0.95602757 0.0001338
7:n-5:n -0.750918374 -2.15404494  0.65220819 0.6663829
1:y-5:n  2.640781070  1.23765451  4.04390763 0.0000209
3:y-5:n  1.446776876  0.04365031  2.84990344 0.0394561
5:y-5:n  0.009956756 -1.39316981  1.41308332 1.0000000
7:y-5:n -0.606719694 -2.00984626  0.79640687 0.8502642
1:y-7:n  3.391699445  1.98857288  4.79482601 0.0000002
3:y-7:n  2.197695251  0.79456869  3.60082181 0.0003863
5:y-7:n  0.760875130 -0.64225143  2.16400169 0.6519995
7:y-7:n  0.144198680 -1.25892788  1.54732524 0.9999726
3:y-1:y -1.194004194 -2.59713076  0.20912237 0.1425437
5:y-1:y -2.630824314 -4.03395088 -1.22769775 0.0000223
7:y-1:y -3.247500764 -4.65062733 -1.84437420 0.0000004
5:y-3:y -1.436820121 -2.83994668 -0.03369356 0.0416663
7:y-3:y -2.053496570 -3.45662313 -0.65037001 0.0009873
7:y-5:y -0.616676450 -2.01980301  0.78645011 0.8396394

$`microbes:TB`
              diff        lwr        upr     p adj
y:n-n:n -0.5865137 -1.4163604  0.2433330 0.2421005
n:y-n:n  1.2454438  0.4155971  2.0752905 0.0015788
y:y-n:n -2.0459452 -2.8757919 -1.2160985 0.0000009
n:y-y:n  1.8319575  1.0021108  2.6618042 0.0000066
y:y-y:n -1.4594315 -2.2892782 -0.6295848 0.0002207
y:y-n:y -3.2913889 -4.1212356 -2.4615422 0.0000000

$`day:microbes:TB`
                   diff         lwr         upr     p adj
3:n:n-1:n:n -0.40497983 -2.67646851  1.86650884 0.9999976
5:n:n-1:n:n -1.81006602 -4.08155469  0.46142266 0.2435488
7:n:n-1:n:n -3.47764654 -5.74913521 -1.20615786 0.0002644
1:y:n-1:n:n  0.44226358 -1.82922509  2.71375225 0.9999923
3:y:n-1:n:n -1.48239638 -3.75388505  0.78909230 0.5473382
5:y:n-1:n:n -3.58217907 -5.85366774 -1.31069039 0.0001636
7:y:n-1:n:n -3.41643530 -5.68792397 -1.14494662 0.0003501
1:n:y-1:n:n  0.62439478 -1.64709389  2.89588346 0.9994665
3:n:y-1:n:n  1.00941455 -1.26207412  3.28090323 0.9458515
5:n:y-1:n:n -0.43515561 -2.70664428  1.83633306 0.9999938
7:n:y-1:n:n -1.90957101 -4.18105968  0.36191767 0.1796386
1:y:y-1:n:n -0.73507773 -3.00656640  1.53641095 0.9968576
3:y:y-1:n:n -3.50810588 -5.77959456 -1.23661721 0.0002299
5:y:y-1:n:n -4.93717596 -7.20866464 -2.66568729 0.0000004
7:y:y-1:n:n -4.69611347 -6.96760214 -2.42462479 0.0000010
5:n:n-3:n:n -1.40508618 -3.67657486  0.86640249 0.6304295
7:n:n-3:n:n -3.07266670 -5.34415538 -0.80117803 0.0016723
1:y:n-3:n:n  0.84724341 -1.42424526  3.11873209 0.9874697
3:y:n-3:n:n -1.07741654 -3.34890522  1.19407213 0.9134438
5:y:n-3:n:n -3.17719924 -5.44868791 -0.90571056 0.0010427
7:y:n-3:n:n -3.01145546 -5.28294414 -0.73996679 0.0022011
1:n:y-3:n:n  1.02937462 -1.24211406  3.30086329 0.9373783
3:n:y-3:n:n  1.41439438 -0.85709429  3.68588306 0.6204680
5:n:y-3:n:n -0.03017578 -2.30166445  2.24131290 1.0000000
7:n:y-3:n:n -1.50459117 -3.77607985  0.76689750 0.5236064
1:y:y-3:n:n -0.33009789 -2.60158657  1.94139078 0.9999999
3:y:y-3:n:n -3.10312605 -5.37461472 -0.83163738 0.0014578
5:y:y-3:n:n -4.53219613 -6.80368480 -2.26070746 0.0000022
7:y:y-3:n:n -4.29113363 -6.56262231 -2.01964496 0.0000064
7:n:n-5:n:n -1.66758052 -3.93906919  0.60390815 0.3601767
1:y:n-5:n:n  2.25232960 -0.01915908  4.52381827 0.0538031
3:y:n-5:n:n  0.32766964 -1.94381904  2.59915831 0.9999999
5:y:n-5:n:n -1.77211305 -4.04360173  0.49937562 0.2717594
7:y:n-5:n:n -1.60636928 -3.87785796  0.66511939 0.4185706
1:n:y-5:n:n  2.43446080  0.16297212  4.70594947 0.0262719
3:n:y-5:n:n  2.81948057  0.54799189  5.09096924 0.0051530
5:n:y-5:n:n  1.37491041 -0.89657827  3.64639908 0.6624604
7:n:y-5:n:n -0.09950499 -2.37099367  2.17198368 1.0000000
1:y:y-5:n:n  1.07498829 -1.19650039  3.34647696 0.9147761
3:y:y-5:n:n -1.69803987 -3.96952854  0.57344881 0.3328500
5:y:y-5:n:n -3.12710995 -5.39859862 -0.85562127 0.0013082
7:y:y-5:n:n -2.88604745 -5.15753612 -0.61455878 0.0038451
1:y:n-7:n:n  3.91991012  1.64842144  6.19139879 0.0000347
3:y:n-7:n:n  1.99525016 -0.27623852  4.26673883 0.1357359
5:y:n-7:n:n -0.10453253 -2.37602121  2.16695614 1.0000000
7:y:n-7:n:n  0.06121124 -2.21027744  2.33269991 1.0000000
1:n:y-7:n:n  4.10204132  1.83055264  6.37352999 0.0000151
3:n:y-7:n:n  4.48706109  2.21557241  6.75854976 0.0000026
5:n:y-7:n:n  3.04249093  0.77100225  5.31397960 0.0019152
7:n:y-7:n:n  1.56807553 -0.70341315  3.83956420 0.4571371
1:y:y-7:n:n  2.74256881  0.47108013  5.01405748 0.0072027
3:y:y-7:n:n -0.03045935 -2.30194802  2.24102933 1.0000000
5:y:y-7:n:n -1.45952943 -3.73101810  0.81195925 0.5719209
7:y:y-7:n:n -1.21846693 -3.48995560  1.05302174 0.8139107
3:y:n-1:y:n -1.92465996 -4.19614863  0.34682872 0.1711876
5:y:n-1:y:n -4.02444265 -6.29593132 -1.75295397 0.0000215
7:y:n-1:y:n -3.85869888 -6.13018755 -1.58721020 0.0000459
1:n:y-1:y:n  0.18213120 -2.08935747  2.45361988 1.0000000
3:n:y-1:y:n  0.56715097 -1.70433770  2.83863965 0.9998264
5:n:y-1:y:n -0.87741919 -3.14890786  1.39406948 0.9828302
7:n:y-1:y:n -2.35183459 -4.62332326 -0.08034591 0.0365623
1:y:y-1:y:n -1.17734131 -3.44882998  1.09414737 0.8472747
3:y:y-1:y:n -3.95036946 -6.22185814 -1.67888079 0.0000302
5:y:y-1:y:n -5.37943954 -7.65092822 -3.10795087 0.0000001
7:y:y-1:y:n -5.13837705 -7.40986572 -2.86688837 0.0000002
5:y:n-3:y:n -2.09978269 -4.37127137  0.17170598 0.0944936
7:y:n-3:y:n -1.93403892 -4.20552759  0.33744975 0.1660935
1:n:y-3:y:n  2.10679116 -0.16469751  4.37827983 0.0921590
3:n:y-3:y:n  2.49181093  0.22032225  4.76329960 0.0207899
5:n:y-3:y:n  1.04724077 -1.22424791  3.31872944 0.9290698
7:n:y-3:y:n -0.42717463 -2.69866330  1.84431404 0.9999951
1:y:y-3:y:n  0.74731865 -1.52417002  3.01880732 0.9962789
3:y:y-3:y:n -2.02570951 -4.29719818  0.24577917 0.1224092
5:y:y-3:y:n -3.45477959 -5.72626826 -1.18329091 0.0002937
7:y:y-3:y:n -3.21371709 -5.48520576 -0.94222841 0.0008835
7:y:n-5:y:n  0.16574377 -2.10574490  2.43723245 1.0000000
1:n:y-5:y:n  4.20657385  1.93508518  6.47806253 0.0000094
3:n:y-5:y:n  4.59159362  2.32010495  6.86308229 0.0000017
5:n:y-5:y:n  3.14702346  0.87553478  5.41851213 0.0011955
7:n:y-5:y:n  1.67260806 -0.59888061  3.94409674 0.3555823
1:y:y-5:y:n  2.84710134  0.57561267  5.11859002 0.0045649
3:y:y-5:y:n  0.07407319 -2.19741549  2.34556186 1.0000000
5:y:y-5:y:n -1.35499689 -3.62648557  0.91649178 0.6832914
7:y:y-5:y:n -1.11393440 -3.38542307  1.15755428 0.8918163
1:n:y-7:y:n  4.04083008  1.76934141  6.31231875 0.0000199
3:n:y-7:y:n  4.42584985  2.15436117  6.69733852 0.0000035
5:n:y-7:y:n  2.98127969  0.70979101  5.25276836 0.0025190
7:n:y-7:y:n  1.50686429 -0.76462438  3.77835296 0.5211863
1:y:y-7:y:n  2.68135757  0.40986890  4.95284624 0.0093750
3:y:y-7:y:n -0.09167059 -2.36315926  2.17981809 1.0000000
5:y:y-7:y:n -1.52074067 -3.79222934  0.75074801 0.5064654
7:y:y-7:y:n -1.27967817 -3.55116684  0.99181051 0.7585760
3:n:y-1:n:y  0.38501977 -1.88646891  2.65650844 0.9999988
5:n:y-1:n:y -1.05955039 -3.33103907  1.21193828 0.9229392
7:n:y-1:n:y -2.53396579 -4.80545446 -0.26247712 0.0174656
1:y:y-1:n:y -1.35947251 -3.63096119  0.91201616 0.6786354
3:y:y-1:n:y -4.13250067 -6.40398934 -1.86101199 0.0000131
5:y:y-1:n:y -5.56157075 -7.83305942 -3.29008207 0.0000000
7:y:y-1:n:y -5.32050825 -7.59199692 -3.04901957 0.0000001
5:n:y-3:n:y -1.44457016 -3.71605884  0.82691851 0.5880307
7:n:y-3:n:y -2.91898556 -5.19047423 -0.64749688 0.0033235
1:y:y-3:n:y -1.74449228 -4.01598095  0.52699640 0.2936207
3:y:y-3:n:y -4.51752043 -6.78900911 -2.24603176 0.0000023
5:y:y-3:n:y -5.94659051 -8.21807919 -3.67510184 0.0000000
7:y:y-3:n:y -5.70552802 -7.97701669 -3.43403934 0.0000000
7:n:y-5:n:y -1.47441540 -3.74590407  0.79707328 0.5559074
1:y:y-5:n:y -0.29992212 -2.57141079  1.97156656 1.0000000
3:y:y-5:n:y -3.07295027 -5.34443895 -0.80146160 0.0016701
5:y:y-5:n:y -4.50202035 -6.77350903 -2.23053168 0.0000025
7:y:y-5:n:y -4.26095786 -6.53244653 -1.98946918 0.0000073
1:y:y-7:n:y  1.17449328 -1.09699539  3.44598195 0.8494597
3:y:y-7:n:y -1.59853488 -3.87002355  0.67295380 0.4263460
5:y:y-7:n:y -3.02760496 -5.29909363 -0.75611628 0.0020475
7:y:y-7:n:y -2.78654246 -5.05803113 -0.51505378 0.0059504
3:y:y-1:y:y -2.77302816 -5.04451683 -0.50153948 0.0063110
5:y:y-1:y:y -4.20209823 -6.47358691 -1.93060956 0.0000096
7:y:y-1:y:y -3.96103574 -6.23252441 -1.68954706 0.0000287
5:y:y-3:y:y -1.42907008 -3.70055875  0.84241859 0.6047120
7:y:y-3:y:y -1.18800758 -3.45949626  1.08348109 0.8389439
7:y:y-5:y:y  0.24106250 -2.03042618  2.51255117 1.0000000</code></pre>
</div>
</div>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>