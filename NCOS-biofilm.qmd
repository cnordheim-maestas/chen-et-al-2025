---
title: "NCOS biofilm"
author: "Caitlin Nordheim-Maestas"
format:
  html:
    toc: true
    code-fold: true
    toc-location: left
---

# Goal: Re-create Renwei's visualizations in R and run stats across treatments and time

See Renwei's excel version here: <https://drive.google.com/file/d/1Dy_jAW0lTQZohf7V-l5VxQ_LrNLP9Aai/view?usp=sharing>

```{r}
#| warning: false

## read in and clean data
library(tidyverse) # for cleaning and viewing data
library(here) # for importing data
library(ggpubr)
library(rstatix)
library(ggplot2)
library(car)
library(multcomp)
library(nlme)

fig_2b <- read.csv(here("data", "final_NCOS_2024_reformatted_for_R.xlsx - Fig2B.csv"))
fig_3b <- read.csv(here("data", "final_NCOS_2024_reformatted_for_R.xlsx - Fig3B.csv"))
fig_4b <- read.csv(here("data", "final_NCOS_2024_reformatted_for_R.xlsx - Fig4B.csv"))
```

# Data reformatting and cleaning

```{r}
fig2b_summary <- fig_2b %>% 
  group_by(day, sample_ID) %>% 
  reframe(mean = mean(adh_plus_sup), # calculate the mean
            n = length(adh_plus_sup), # count the number of observations
            df = n - 1, # calculate the degrees of freedom
            sd = sd(adh_plus_sup), # calculate the standard deviation
            se = sd/sqrt(n), # calculate the standard error
          )
```

# Fig 2b

I am not sure what the experimental set up is, but here is a re-creation of Renwei's excel figure!

Renwei's figure:

![](data/fig_2b_Renweiexcelversion.jpg){fig-align="left" width="4in"}

ggplot version:

```{r}
fig2b_summary %>% 
  ggplot(aes(x = day, 
           y = mean, 
           color = sample_ID)) +
  geom_point(size = 2) +
  geom_line() + 
  geom_errorbar(aes(ymin = mean - se, # plot the standard error
                    ymax = mean + se),
                width = 0.1) +
  scale_y_log10() +
  # vibes
  labs(x = "Day",
       y = "Bd Quantity per sample (ZE/well)") +
  theme_minimal() +
  theme(
    panel.grid.major.x = element_blank(), # Remove major vertical grid lines
    panel.grid.minor.x = element_blank()) + # Remove minor vertical grid lines +
  scale_x_continuous(breaks = c(0, 1, 3, 5, 7))
```
