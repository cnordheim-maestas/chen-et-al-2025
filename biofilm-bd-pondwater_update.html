<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Caitlin Nordheim-Maestas">

<title>Biofilm Bd Update</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="biofilm-bd-pondwater_update_files/libs/clipboard/clipboard.min.js"></script>
<script src="biofilm-bd-pondwater_update_files/libs/quarto-html/quarto.js"></script>
<script src="biofilm-bd-pondwater_update_files/libs/quarto-html/popper.min.js"></script>
<script src="biofilm-bd-pondwater_update_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="biofilm-bd-pondwater_update_files/libs/quarto-html/anchor.min.js"></script>
<link href="biofilm-bd-pondwater_update_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="biofilm-bd-pondwater_update_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="biofilm-bd-pondwater_update_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="biofilm-bd-pondwater_update_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="biofilm-bd-pondwater_update_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article toc-left">
<div id="quarto-sidebar-toc-left" class="sidebar toc-left">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#part-i-effect-of-aquatic-environmental-microbes-on-bd-growth---15-sites" id="toc-part-i-effect-of-aquatic-environmental-microbes-on-bd-growth---15-sites" class="nav-link active" data-scroll-target="#part-i-effect-of-aquatic-environmental-microbes-on-bd-growth---15-sites">Part I: Effect of aquatic environmental microbes on Bd growth - 15 sites</a>
  <ul class="collapse">
  <li><a href="#pi-about-the-data" id="toc-pi-about-the-data" class="nav-link" data-scroll-target="#pi-about-the-data">PI About the data</a></li>
  <li><a href="#pi-data-wrangling" id="toc-pi-data-wrangling" class="nav-link" data-scroll-target="#pi-data-wrangling">PI Data Wrangling</a></li>
  <li><a href="#pi-data-visualization" id="toc-pi-data-visualization" class="nav-link" data-scroll-target="#pi-data-visualization">PI Data visualization</a>
  <ul class="collapse">
  <li><a href="#renwei-barplot-remake" id="toc-renwei-barplot-remake" class="nav-link" data-scroll-target="#renwei-barplot-remake">Renwei barplot remake</a></li>
  </ul></li>
  <li><a href="#boxplot" id="toc-boxplot" class="nav-link" data-scroll-target="#boxplot">Boxplot</a></li>
  <li><a href="#pi-stats-and-assumption-testing" id="toc-pi-stats-and-assumption-testing" class="nav-link" data-scroll-target="#pi-stats-and-assumption-testing">PI Stats and assumption testing</a>
  <ul class="collapse">
  <li><a href="#test-paired-t-test-on-the-difference-in-all-of-the-bd-from-day-1-to-day-7-between-the-two-filters" id="toc-test-paired-t-test-on-the-difference-in-all-of-the-bd-from-day-1-to-day-7-between-the-two-filters" class="nav-link" data-scroll-target="#test-paired-t-test-on-the-difference-in-all-of-the-bd-from-day-1-to-day-7-between-the-two-filters">Test: Paired t-test on the difference in all of the Bd from day 1 to day 7 between the two filters</a></li>
  <li><a href="#stats-results" id="toc-stats-results" class="nav-link" data-scroll-target="#stats-results">Stats results:</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#part-ii-effect-of-the-aquatic-environmental-biofilm-on-bd-growth---9-sites" id="toc-part-ii-effect-of-the-aquatic-environmental-biofilm-on-bd-growth---9-sites" class="nav-link" data-scroll-target="#part-ii-effect-of-the-aquatic-environmental-biofilm-on-bd-growth---9-sites">Part II: Effect of the aquatic environmental biofilm on Bd growth - “9 sites”</a>
  <ul class="collapse">
  <li><a href="#pii-about-the-data" id="toc-pii-about-the-data" class="nav-link" data-scroll-target="#pii-about-the-data">PII About the Data</a></li>
  <li><a href="#pii-data-wrangling" id="toc-pii-data-wrangling" class="nav-link" data-scroll-target="#pii-data-wrangling">PII Data Wrangling</a></li>
  <li><a href="#pii-data-visualization" id="toc-pii-data-visualization" class="nav-link" data-scroll-target="#pii-data-visualization">PII Data Visualization</a>
  <ul class="collapse">
  <li><a href="#renwei-barplot" id="toc-renwei-barplot" class="nav-link" data-scroll-target="#renwei-barplot">Renwei barplot</a></li>
  <li><a href="#boxplot-1" id="toc-boxplot-1" class="nav-link" data-scroll-target="#boxplot-1">Boxplot</a></li>
  </ul></li>
  <li><a href="#pii-assumptions-testing-and-stats" id="toc-pii-assumptions-testing-and-stats" class="nav-link" data-scroll-target="#pii-assumptions-testing-and-stats">PII Assumptions testing and Stats</a></li>
  </ul></li>
  <li><a href="#part-iii-effect-of-microbes-in-pond-water-on-the-bd-release-from-mono-strain-bd-biofilm---9-sites-and-included-biofilm" id="toc-part-iii-effect-of-microbes-in-pond-water-on-the-bd-release-from-mono-strain-bd-biofilm---9-sites-and-included-biofilm" class="nav-link" data-scroll-target="#part-iii-effect-of-microbes-in-pond-water-on-the-bd-release-from-mono-strain-bd-biofilm---9-sites-and-included-biofilm">Part III: Effect of microbes in pond water on the Bd-release from mono-strain Bd biofilm - “9 sites” and included biofilm</a>
  <ul class="collapse">
  <li><a href="#piii-about-the-data" id="toc-piii-about-the-data" class="nav-link" data-scroll-target="#piii-about-the-data">PIII About the data</a></li>
  <li><a href="#piii-data-wrangling" id="toc-piii-data-wrangling" class="nav-link" data-scroll-target="#piii-data-wrangling">PIII Data Wrangling</a></li>
  <li><a href="#piii-data-visualization" id="toc-piii-data-visualization" class="nav-link" data-scroll-target="#piii-data-visualization">PIII Data visualization</a>
  <ul class="collapse">
  <li><a href="#renwei-barplot-1" id="toc-renwei-barplot-1" class="nav-link" data-scroll-target="#renwei-barplot-1">Renwei barplot</a></li>
  <li><a href="#boxplot-2" id="toc-boxplot-2" class="nav-link" data-scroll-target="#boxplot-2">Boxplot</a></li>
  </ul></li>
  <li><a href="#piii-stats-and-assumption-testing" id="toc-piii-stats-and-assumption-testing" class="nav-link" data-scroll-target="#piii-stats-and-assumption-testing">PIII Stats and assumption testing</a>
  <ul class="collapse">
  <li><a href="#test-paired-t-test-on-the-difference-in-total-bd-between-day-1-and-7" id="toc-test-paired-t-test-on-the-difference-in-total-bd-between-day-1-and-7" class="nav-link" data-scroll-target="#test-paired-t-test-on-the-difference-in-total-bd-between-day-1-and-7">Test: Paired t-test on the difference in total Bd between day 1 and 7</a></li>
  <li><a href="#stats-results-1" id="toc-stats-results-1" class="nav-link" data-scroll-target="#stats-results-1">Stats results:</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#part-iv-comparing-across-all-treatments" id="toc-part-iv-comparing-across-all-treatments" class="nav-link" data-scroll-target="#part-iv-comparing-across-all-treatments">Part IV Comparing across all treatments</a>
  <ul class="collapse">
  <li><a href="#piv-data-wrangling" id="toc-piv-data-wrangling" class="nav-link" data-scroll-target="#piv-data-wrangling">PIV Data wrangling</a></li>
  <li><a href="#piv-stats-and-assumption-testing" id="toc-piv-stats-and-assumption-testing" class="nav-link" data-scroll-target="#piv-stats-and-assumption-testing">PIV Stats and assumption testing</a>
  <ul class="collapse">
  <li><a href="#test" id="toc-test" class="nav-link" data-scroll-target="#test">Test:</a></li>
  <li><a href="#stats-results-2" id="toc-stats-results-2" class="nav-link" data-scroll-target="#stats-results-2">Stats results:</a></li>
  </ul></li>
  <li><a href="#piv-data-visualization" id="toc-piv-data-visualization" class="nav-link" data-scroll-target="#piv-data-visualization">PIV Data visualization</a>
  <ul class="collapse">
  <li><a href="#takeaways" id="toc-takeaways" class="nav-link" data-scroll-target="#takeaways">Takeaways</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#appendix" id="toc-appendix" class="nav-link" data-scroll-target="#appendix">Appendix</a>
  <ul class="collapse">
  <li><a href="#part-iv-alternate-routes" id="toc-part-iv-alternate-routes" class="nav-link" data-scroll-target="#part-iv-alternate-routes">Part IV alternate routes</a>
  <ul class="collapse">
  <li><a href="#percent-reduction" id="toc-percent-reduction" class="nav-link" data-scroll-target="#percent-reduction">Percent reduction?</a></li>
  <li><a href="#arcsin-square-root-percent-loss" id="toc-arcsin-square-root-percent-loss" class="nav-link" data-scroll-target="#arcsin-square-root-percent-loss">Arcsin square root percent loss</a></li>
  </ul></li>
  <li><a href="#part-1-alternate-route" id="toc-part-1-alternate-route" class="nav-link" data-scroll-target="#part-1-alternate-route">Part 1 alternate route</a>
  <ul class="collapse">
  <li><a href="#difference-another-way-to-measure-the-change-in-bd" id="toc-difference-another-way-to-measure-the-change-in-bd" class="nav-link" data-scroll-target="#difference-another-way-to-measure-the-change-in-bd">“Difference” Another way to measure the change in Bd</a></li>
  </ul></li>
  <li><a href="#part-2-alternate-route-use-day-017-and-lme" id="toc-part-2-alternate-route-use-day-017-and-lme" class="nav-link" data-scroll-target="#part-2-alternate-route-use-day-017-and-lme">Part 2 alternate route: use day 0,1,7 and lme</a>
  <ul class="collapse">
  <li><a href="#lme" id="toc-lme" class="nav-link" data-scroll-target="#lme">LME</a></li>
  </ul></li>
  <li><a href="#part-3-alternate-method-diff" id="toc-part-3-alternate-method-diff" class="nav-link" data-scroll-target="#part-3-alternate-method-diff">Part 3 alternate method: diff</a>
  <ul class="collapse">
  <li><a href="#diff-not-rate-loss-method-ignore-for-now" id="toc-diff-not-rate-loss-method-ignore-for-now" class="nav-link" data-scroll-target="#diff-not-rate-loss-method-ignore-for-now">diff not rate loss method, ignore for now</a></li>
  </ul></li>
  </ul></li>
  </ul>
</nav>
</div>
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Biofilm Bd Update</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Caitlin Nordheim-Maestas </p>
          </div>
  </div>
    
  
    
  </div>
  

</header>

<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="do">## read in and clean data</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse) <span class="co"># for cleaning and viewing data</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(here) <span class="co"># for importing data</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggpubr)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rstatix)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(multcomp)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(nlme)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>ns_biofilm_bd <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="fu">here</span>(<span class="st">"data"</span>, <span class="st">"nine-sites-biofilm-on-Bd - Sheet1.csv"</span>))</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>fs_pw_bd <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="fu">here</span>(<span class="st">"data"</span>, <span class="st">"fifteen-sites-PW-on-Bd - Sheet1.csv"</span>))</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>ns_ml_pw_bd <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="fu">here</span>(<span class="st">"data"</span>, <span class="st">"nine-sites-PW-on-MLBd - Sheet1.csv"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(site <span class="sc">!=</span> <span class="st">"NORTH"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="part-i-effect-of-aquatic-environmental-microbes-on-bd-growth---15-sites" class="level1">
<h1>Part I: Effect of aquatic environmental microbes on Bd growth - 15 sites</h1>
<section id="pi-about-the-data" class="level2">
<h2 class="anchored" data-anchor-id="pi-about-the-data">PI About the data</h2>
<p>Wrangled results file name: <a href="https://docs.google.com/spreadsheets/d/11pCxR2oeprag1EGEAtdYpSmjaPwXD9szq_029p4OB2Q/edit?usp=sharing">“fifteen-sites-PW-on-Bd.csv”</a></p>
<p>File source: “<a href="https://docs.google.com/spreadsheets/d/17QveSH4al14axf-cBsu4JEhgampQEU1E/edit?usp=sharing&amp;ouid=116930126837996341679&amp;rtpof=true&amp;sd=true">Biofilm PCR for R-studio</a>” first tab called 15 sites PW on Bd</p>
<p>Statistical question:</p>
<p>Is there a difference in the <strong>gain or loss of Bd over 7 days</strong> between the <strong>filter sizes</strong> looking at the <strong>TOTAL BD</strong></p>
</section>
<section id="pi-data-wrangling" class="level2">
<h2 class="anchored" data-anchor-id="pi-data-wrangling">PI Data Wrangling</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># remove controls</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>partI <span class="ot">&lt;-</span> fs_pw_bd <span class="sc">%&gt;%</span> <span class="fu">filter</span>(site <span class="sc">!=</span> <span class="st">"sterile MQ"</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co"># keep control for labeling plot</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>partI_controls <span class="ot">&lt;-</span> fs_pw_bd <span class="sc">%&gt;%</span> </span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(site <span class="sc">==</span><span class="st">"sterile MQ"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> bd_location, <span class="at">values_from =</span> bd_qty) <span class="sc">%&gt;%</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">combined_bd =</span> adherent <span class="sc">+</span> floating) <span class="sc">%&gt;%</span> </span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>   <span class="fu">mutate</span>(<span class="at">day =</span> <span class="fu">case_when</span>(</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>    day <span class="sc">==</span> <span class="dv">1</span> <span class="sc">~</span> <span class="st">"Day_1"</span>,</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>    day <span class="sc">==</span> <span class="dv">7</span> <span class="sc">~</span> <span class="st">"Day_7"</span>))</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a><span class="co"># data type cleaning</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>partI<span class="sc">$</span>bd_location <span class="ot">&lt;-</span> <span class="fu">factor</span>(partI<span class="sc">$</span>bd_location, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"floating"</span>, <span class="st">"adherent"</span>))</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>partI<span class="sc">$</span>filter <span class="ot">&lt;-</span> <span class="fu">factor</span>(partI<span class="sc">$</span>filter,</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>                          <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"40um_filter"</span>, <span class="st">"0.22um_filter"</span>))</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>partI<span class="sc">$</span>day <span class="ot">&lt;-</span> <span class="fu">factor</span>(partI<span class="sc">$</span>day, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"1"</span>, <span class="st">"7"</span>),</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>                            <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Day_1"</span>, <span class="st">"Day_7"</span>))</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>partI<span class="sc">$</span>site <span class="ot">&lt;-</span> <span class="fu">factor</span>(partI<span class="sc">$</span>site,</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>                          <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"BARN"</span>, <span class="st">"CABIN"</span>, <span class="st">"NORTH"</span>, <span class="st">"GRAMPS"</span>, <span class="st">"WEST"</span>, <span class="st">"GDPND004"</span>, <span class="st">"GDPND005"</span>, <span class="st">"GDPND006"</span>, <span class="st">"GDPND008"</span>, <span class="st">"GDPND009"</span>, <span class="st">"PRPND002"</span>, <span class="st">"PRPND003"</span>, <span class="st">"PRPND004"</span>, <span class="st">"PRPND009"</span>, <span class="st">"PRPND010"</span>, <span class="st">"sterile MQ"</span>))</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a><span class="co"># get the total difference across days by combining both locations of Bd then subtracting across days</span></span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>partI_total_diff <span class="ot">&lt;-</span> partI <span class="sc">%&gt;%</span></span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>  <span class="co"># combine floating and adherent for total_Bd</span></span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> bd_location, <span class="at">values_from =</span> bd_qty) <span class="sc">%&gt;%</span></span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">combined_bd =</span> adherent <span class="sc">+</span> floating) <span class="sc">%&gt;%</span> </span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">subset</span>(<span class="at">select =</span> <span class="sc">-</span><span class="fu">c</span>(adherent,floating)) <span class="sc">%&gt;%</span> </span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a><span class="co"># different metrics of difference in Bd</span></span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> day, <span class="at">values_from =</span> combined_bd) <span class="sc">%&gt;%</span></span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a>  <span class="co"># calculate the rate loss by taking the log of each before subtracting</span></span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">rate_loss =</span> <span class="fu">log</span>(Day_1) <span class="sc">-</span> <span class="fu">log</span>(Day_7))  <span class="sc">%&gt;%</span> </span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a>  <span class="co"># calculate the difference in raw amount of Bd</span></span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">diff =</span> Day_1 <span class="sc">-</span> Day_7)</span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-38"><a href="#cb2-38" aria-hidden="true" tabindex="-1"></a><span class="co"># Split into 2 data frames one for 40 and one for .22</span></span>
<span id="cb2-39"><a href="#cb2-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-40"><a href="#cb2-40" aria-hidden="true" tabindex="-1"></a>partI_total_diff_40um <span class="ot">&lt;-</span> partI_total_diff <span class="sc">%&gt;%</span> </span>
<span id="cb2-41"><a href="#cb2-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(filter <span class="sc">==</span><span class="st">"40um_filter"</span>)</span>
<span id="cb2-42"><a href="#cb2-42" aria-hidden="true" tabindex="-1"></a>partI_total_diff<span class="fl">.22</span>um <span class="ot">&lt;-</span> partI_total_diff<span class="sc">%&gt;%</span> </span>
<span id="cb2-43"><a href="#cb2-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(filter <span class="sc">==</span><span class="st">"0.22um_filter"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="pi-data-visualization" class="level2">
<h2 class="anchored" data-anchor-id="pi-data-visualization">PI Data visualization</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Colors: these are from Paul Tol's colorblind friendly palette</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>with_microbes_40_color <span class="ot">&lt;-</span> <span class="st">"#999933"</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>no_microbes_<span class="fl">.22</span>_color <span class="ot">&lt;-</span> <span class="st">"#88ccee"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="renwei-barplot-remake" class="level3">
<h3 class="anchored" data-anchor-id="renwei-barplot-remake">Renwei barplot remake</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>partI <span class="sc">%&gt;%</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># combine floating and adherent for total_Bd</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> bd_location, <span class="at">values_from =</span> bd_qty) <span class="sc">%&gt;%</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">combined_bd =</span> adherent <span class="sc">+</span> floating) <span class="sc">%&gt;%</span> </span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y=</span> combined_bd, <span class="at">x =</span> site, <span class="at">fill =</span> filter)) <span class="sc">+</span> </span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_col</span>(<span class="at">position =</span> <span class="fu">position_dodge</span>()) <span class="sc">+</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>() <span class="sc">+</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(<span class="sc">~</span>day, <span class="at">labeller =</span> <span class="fu">labeller</span>(<span class="at">day =</span> <span class="fu">c</span>(<span class="st">"Day_1"</span> <span class="ot">=</span> <span class="st">"Day 1"</span>,</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>                                                    <span class="st">"Day_7"</span> <span class="ot">=</span> <span class="st">"Day 7"</span>))) <span class="sc">+</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"40um_filter"</span> <span class="ot">=</span> with_microbes_40_color, </span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"0.22um_filter"</span> <span class="ot">=</span> no_microbes_<span class="fl">.22</span>_color)) <span class="sc">+</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>   <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>),</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>         <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">"bold"</span>),</span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>         <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>)) <span class="sc">+</span> </span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">xlab</span>(<span class="st">"Site"</span>) <span class="sc">+</span></span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylab</span>(<span class="st">"Bd Quantity </span><span class="sc">\n</span><span class="st"> (zoospore equivalents)"</span>) <span class="sc">+</span></span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill=</span><span class="fu">guide_legend</span>(<span class="at">title=</span><span class="st">""</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="biofilm-bd-pondwater_update_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="boxplot" class="level2">
<h2 class="anchored" data-anchor-id="boxplot">Boxplot</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>partI <span class="sc">%&gt;%</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># combine floating and adherent for total_Bd</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> bd_location, <span class="at">values_from =</span> bd_qty) <span class="sc">%&gt;%</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">combined_bd =</span> adherent <span class="sc">+</span> floating) <span class="sc">%&gt;%</span> </span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># create the plot</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y=</span> combined_bd, <span class="at">x =</span> filter, <span class="at">fill =</span> filter)) <span class="sc">+</span> </span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">width =</span> <span class="fl">0.2</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_log10</span>() <span class="sc">+</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(<span class="sc">~</span>day, <span class="at">labeller =</span> <span class="fu">labeller</span>(<span class="at">day =</span> <span class="fu">c</span>(<span class="st">"Day_1"</span> <span class="ot">=</span> <span class="st">"Day 1"</span>,</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>                                                    <span class="st">"Day_7"</span> <span class="ot">=</span> <span class="st">"Day 7"</span>)))<span class="sc">+</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"40um_filter"</span> <span class="ot">=</span> with_microbes_40_color, </span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"0.22um_filter"</span> <span class="ot">=</span> no_microbes_<span class="fl">.22</span>_color)) <span class="sc">+</span></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>   <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>,</span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>         <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">"bold"</span>),</span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>         <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>)) <span class="sc">+</span> </span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span> (<span class="at">labels=</span> <span class="fu">c</span>(<span class="st">"40um_filter"</span> <span class="ot">=</span> <span class="st">"With Microbes"</span>, <span class="st">"0.22um_filter"</span> <span class="ot">=</span> <span class="st">"No Microbes"</span>)) <span class="sc">+</span></span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">xlab</span>(<span class="st">"Presence of Microbes in Pond Water"</span>) <span class="sc">+</span></span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylab</span>(<span class="st">"Bd Quantity </span><span class="sc">\n</span><span class="st"> (zoospore equivalents)"</span>) <span class="sc">+</span></span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add controls ad x's</span></span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> partI_controls, <span class="fu">aes</span>(<span class="at">x =</span> filter, <span class="at">y =</span> combined_bd), <span class="at">shape =</span> <span class="dv">4</span>, <span class="at">size =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="biofilm-bd-pondwater_update_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="pi-stats-and-assumption-testing" class="level2">
<h2 class="anchored" data-anchor-id="pi-stats-and-assumption-testing">PI Stats and assumption testing</h2>
<p>Question:</p>
<p>Does the difference in Bd from day 1 to day 7 differ between the two filter types?</p>
<p>The samples are essentially paired by site, so a paired t-test is most appropriate</p>
<p><span class="math inline">\(H0:μ_{difference in Bd}=0\)</span></p>
<p>Assumptions:</p>
<p>Assumes that the observations from each group represent a random sample from the population. Assumes that the difference of the two observations follow a normal distribution.</p>
<section id="test-paired-t-test-on-the-difference-in-all-of-the-bd-from-day-1-to-day-7-between-the-two-filters" class="level3">
<h3 class="anchored" data-anchor-id="test-paired-t-test-on-the-difference-in-all-of-the-bd-from-day-1-to-day-7-between-the-two-filters">Test: Paired t-test on the difference in all of the Bd from day 1 to day 7 between the two filters</h3>
</section>
<section id="stats-results" class="level3">
<h3 class="anchored" data-anchor-id="stats-results">Stats results:</h3>
<p><strong>There is a significant difference in the change in the total quantity of Bd from Day 1 to Day 7 across the filter types (t = 4.7879, df = 14, p-value = 0.000289)</strong></p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># check normality of the differences across groups: it's normal untransformed in both!</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>partI_total_diff_40um <span class="sc">%&gt;%</span> </span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a> <span class="fu">ggqqplot</span>(<span class="st">"rate_loss"</span>, <span class="at">title =</span> <span class="st">"Untransformed Bd in both floating and floating rate_loss between day 1 and 7 qqPlot"</span>) <span class="co"># good enough</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="biofilm-bd-pondwater_update_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(partI_total_diff_40um<span class="sc">$</span>rate_loss) <span class="co"># normal, yay!</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  partI_total_diff_40um$rate_loss
W = 0.93591, p-value = 0.3337</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(partI_total_diff_40um<span class="sc">$</span>rate_loss) <span class="co"># good enough</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="biofilm-bd-pondwater_update_files/figure-html/unnamed-chunk-6-2.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>partI_total_diff<span class="fl">.22</span>um<span class="sc">%&gt;%</span> </span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a> <span class="fu">ggqqplot</span>(<span class="st">"rate_loss"</span>, <span class="at">title =</span> <span class="st">"Untransformed Bd in both floating and floating rate_loss between day 1 and 7 qqPlot"</span>) <span class="co"># gorgeous</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="biofilm-bd-pondwater_update_files/figure-html/unnamed-chunk-6-3.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(partI_total_diff<span class="fl">.22</span>um<span class="sc">$</span>rate_loss) <span class="co"># normal, yay!</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  partI_total_diff.22um$rate_loss
W = 0.96119, p-value = 0.7131</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(partI_total_diff<span class="fl">.22</span>um<span class="sc">$</span>rate_loss) <span class="co"># good enough</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="biofilm-bd-pondwater_update_files/figure-html/unnamed-chunk-6-4.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># visualize the comparison I am making</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>partI_total_diff <span class="sc">%&gt;%</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y=</span> rate_loss, <span class="at">x =</span> filter)) <span class="sc">+</span> </span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>() <span class="sc">+</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Visualizing comparison for paired t-test on the rate_loss"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="biofilm-bd-pondwater_update_files/figure-html/unnamed-chunk-6-5.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Pond water with microbes has a significantly greater loss of Bd between day 1 to day 7 than pond water without microbes (t = 4.8, df = 14, p = 0.000289). The t-value is positive, which shows that the first item entered (with microbes) has a larger loss of Bd than the second item entered (no microbes.) Df of 14 is expected, because it’s 15 sites.</p>
<p>Stats</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 3: run the paired t-test on the difference</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(partI_total_diff_40um<span class="sc">$</span>rate_loss, partI_total_diff<span class="fl">.22</span>um<span class="sc">$</span>rate_loss, <span class="at">paired =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Paired t-test

data:  partI_total_diff_40um$rate_loss and partI_total_diff.22um$rate_loss
t = 12.449, df = 14, p-value = 5.83e-09
alternative hypothesis: true mean difference is not equal to 0
95 percent confidence interval:
 3.159637 4.474996
sample estimates:
mean difference 
       3.817316 </code></pre>
</div>
</div>
</section>
</section>
</section>
<section id="part-ii-effect-of-the-aquatic-environmental-biofilm-on-bd-growth---9-sites" class="level1">
<h1>Part II: Effect of the aquatic environmental biofilm on Bd growth - “9 sites”</h1>
<section id="pii-about-the-data" class="level2">
<h2 class="anchored" data-anchor-id="pii-about-the-data">PII About the Data</h2>
<p>Wrangled results file name: <a href="https://docs.google.com/spreadsheets/d/1YCU_tCge48MhDw7cMfYAZYokpwAVHtkaY7rfrC5jUDg/edit#gid=0">“nine-sites-biofilm-on-Bd.csv”</a></p>
<p>File source: “<a href="https://docs.google.com/spreadsheets/d/17QveSH4al14axf-cBsu4JEhgampQEU1E/edit?usp=sharing&amp;ouid=116930126837996341679&amp;rtpof=true&amp;sd=true">Biofilm PCR for R-studio</a>” first tab called 9 sites Biofilm on Bd</p>
<p>Statistical question: Is there a difference in Bd quantity in the biofilm between day 1 &amp; 7?</p>
</section>
<section id="pii-data-wrangling" class="level2">
<h2 class="anchored" data-anchor-id="pii-data-wrangling">PII Data Wrangling</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>part_two <span class="ot">&lt;-</span> ns_biofilm_bd</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="co">#---- Part II</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="co"># set as factors with levels so they appear in order in plots later</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>part_two<span class="sc">$</span>site <span class="ot">&lt;-</span> <span class="fu">factor</span>(part_two<span class="sc">$</span>site,</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>                                <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"CABIN"</span>, <span class="st">"GRAMPS"</span>, <span class="st">"WEST"</span>, <span class="st">"GDPND005"</span>, <span class="st">"GDPND006"</span>, <span class="st">"GDPND009"</span>, <span class="st">"PRPND004"</span>, <span class="st">"PRPND009"</span>, <span class="st">"PRPND010"</span>))</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>part_two<span class="sc">$</span>bd_location <span class="ot">&lt;-</span> <span class="fu">factor</span>(part_two<span class="sc">$</span>bd_location, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"supernatant"</span>, <span class="st">"biofilm"</span>))</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>part_two<span class="sc">$</span>day <span class="ot">&lt;-</span> <span class="fu">factor</span>(part_two<span class="sc">$</span>day, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Day_0"</span>, <span class="st">"Day_1"</span>, <span class="st">"Day_7"</span>))</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Biofilm only, no supernatant, and days 1 and 7 only, no day 0</span></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>part_two_bf_only <span class="ot">&lt;-</span> part_two <span class="sc">%&gt;%</span> </span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(bd_location <span class="sc">==</span> <span class="st">"biofilm"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(day <span class="sc">!=</span> <span class="st">"Day_0"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>  <span class="co">#log bd qty</span></span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">log_qty =</span> <span class="fu">log</span>(bd_qty))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="pii-data-visualization" class="level2">
<h2 class="anchored" data-anchor-id="pii-data-visualization">PII Data Visualization</h2>
<section id="renwei-barplot" class="level3">
<h3 class="anchored" data-anchor-id="renwei-barplot">Renwei barplot</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>part_two <span class="sc">%&gt;%</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y=</span> bd_qty, <span class="at">x =</span> site, <span class="at">fill=</span>bd_location)) <span class="sc">+</span> </span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_col</span>() <span class="sc">+</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_grid</span>(.<span class="sc">~</span>day)<span class="sc">+</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()<span class="sc">+</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"lightgrey"</span>, <span class="st">"gray45"</span> )) <span class="sc">+</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>),</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>          <span class="at">legend.position =</span> <span class="st">"bottom"</span>) <span class="sc">+</span> </span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_log10</span>() <span class="sc">+</span></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">xlab</span>(<span class="st">"Site"</span>) <span class="sc">+</span></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>   <span class="fu">ylab</span>(<span class="st">"Total Bd Quantity Per Well </span><span class="sc">\n</span><span class="st"> (zoospore equivalents)"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="biofilm-bd-pondwater_update_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="boxplot-1" class="level3">
<h3 class="anchored" data-anchor-id="boxplot-1">Boxplot</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>part2 <span class="ot">&lt;-</span> part_two_bf_only <span class="sc">%&gt;%</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y=</span> bd_qty, <span class="at">x =</span> day)) <span class="sc">+</span> </span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_boxplot</span>(<span class="at">fill =</span> no_microbes_<span class="fl">.22</span>_color) <span class="sc">+</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>() <span class="sc">+</span></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>   <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>,</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">"bold"</span>),</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>)) <span class="sc">+</span> </span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">xlab</span>(<span class="st">"Time (days)"</span>) <span class="sc">+</span></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylab</span>(<span class="st">"Bd Quantity </span><span class="sc">\n</span><span class="st"> (zoospore equivalents)"</span>) <span class="sc">+</span></span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span> (<span class="at">labels=</span> <span class="fu">c</span>(<span class="st">"Day_1"</span> <span class="ot">=</span> <span class="st">"Day 1"</span>, <span class="st">"Day_7"</span> <span class="ot">=</span> <span class="st">"Day 7"</span>))</span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Let's add significance letters</span></span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>significance_data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a> <span class="at">day =</span> <span class="fu">factor</span>(<span class="fu">c</span>(<span class="st">"Day_1"</span>, <span class="st">"Day_7"</span>), <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Day_1"</span>, <span class="st">"Day_7"</span>)),</span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">y_position =</span> <span class="fu">c</span>(<span class="fl">1.6e+05</span>, <span class="fl">1.4e+04</span>),  <span class="co"># Adjust this depending on your plot's scale</span></span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">label =</span> <span class="fu">c</span>(<span class="st">"a"</span>, <span class="st">"b"</span>))</span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a>part2 <span class="sc">+</span> </span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_text</span>(<span class="at">data =</span> significance_data, <span class="fu">aes</span>(<span class="at">x =</span> day, <span class="at">y =</span> y_position, <span class="at">label =</span> label),</span>
<span id="cb19-22"><a href="#cb19-22" aria-hidden="true" tabindex="-1"></a>            <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.75</span>), <span class="at">vjust =</span> <span class="dv">0</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="biofilm-bd-pondwater_update_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="pii-assumptions-testing-and-stats" class="level2">
<h2 class="anchored" data-anchor-id="pii-assumptions-testing-and-stats">PII Assumptions testing and Stats</h2>
<p>Question:</p>
<p>Does the amount of Bd in the biofilm differ between day 1 and day 7?</p>
<p>The samples are essentially paired by site, so a paired t-test is most appropriate</p>
<p><span class="math inline">\(H0:μ_{difference in Bd}=0\)</span></p>
<p>Assumptions:</p>
<p>Assumes that the observations from each group represent a random sample from the population. Assumes that the difference of the two observations follow a normal distribution.</p>
<p>Check assumptions</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># check normality of the differences across groups let's try untransformed</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>part_two_bf_only <span class="sc">%&gt;%</span> </span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a> <span class="fu">ggqqplot</span>(<span class="st">"bd_qty"</span>, <span class="at">title =</span> <span class="st">"Untransformed Bd loads"</span>) <span class="sc">+</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>day) <span class="co"># gotta transform the data, day 1 is not normal</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="biofilm-bd-pondwater_update_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>part_two_bf_only <span class="sc">%&gt;%</span> </span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggqqplot</span>(<span class="st">"log_qty"</span>, <span class="at">title =</span> <span class="st">"Transformed Bd loads"</span>) <span class="sc">+</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>day) <span class="co"># not perfect but close, let's try shapiro tests</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="biofilm-bd-pondwater_update_files/figure-html/unnamed-chunk-11-2.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Shapiro tests</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>day_one <span class="ot">&lt;-</span> part_two_bf_only <span class="sc">%&gt;%</span> </span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(day <span class="sc">==</span> <span class="st">"Day_1"</span>) <span class="sc">%&gt;%</span> <span class="co"># filter to only include day 1</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(log_qty)</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(day_one) <span class="co"># p &gt;&gt; 0.05, it's normal!</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  day_one
W = 0.93796, p-value = 0.5606</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>day_seven <span class="ot">&lt;-</span> part_two_bf_only <span class="sc">%&gt;%</span> </span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(day <span class="sc">==</span> <span class="st">"Day_7"</span>) <span class="sc">%&gt;%</span> <span class="co"># filter to only include day 1</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(log_qty)</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(day_seven) <span class="co"># p &gt;&gt; 0.05, it's normal!</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  day_seven
W = 0.92235, p-value = 0.412</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Histograms for funsies</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>part_two_bf_only <span class="sc">%&gt;%</span> </span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> log_qty)) <span class="sc">+</span> <span class="co"># x-axis</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">4</span>) <span class="sc">+</span> <span class="co"># make a histogram</span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> day, <span class="co"># make multiple panels by day</span></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">scales =</span> <span class="st">"free"</span>) <span class="co"># let the axes vary between panels</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="biofilm-bd-pondwater_update_files/figure-html/unnamed-chunk-11-3.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Stats</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 3: run the paired t-test</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(day_one, day_seven, <span class="at">paired =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Paired t-test

data:  day_one and day_seven
t = 10.094, df = 8, p-value = 7.915e-06
alternative hypothesis: true mean difference is not equal to 0
95 percent confidence interval:
 3.233993 5.149159
sample estimates:
mean difference 
       4.191576 </code></pre>
</div>
</div>
<p><strong>There is significantly more Bd in the biofilm on Day 1 than on Day 7 (t = 10.094, df = 8, p-value &lt; 0.0001)</strong></p>
</section>
</section>
<section id="part-iii-effect-of-microbes-in-pond-water-on-the-bd-release-from-mono-strain-bd-biofilm---9-sites-and-included-biofilm" class="level1">
<h1>Part III: Effect of microbes in pond water on the Bd-release from mono-strain Bd biofilm - “9 sites” and included biofilm</h1>
<section id="piii-about-the-data" class="level2">
<h2 class="anchored" data-anchor-id="piii-about-the-data">PIII About the data</h2>
<p>Wrangled results file name: <a href="https://docs.google.com/spreadsheets/d/1I2Y4uf3rP3__Y2p3JLrsTD_9PBUNBYgjY7XG1uOidYA/edit?usp=sharing">“nine-sites-PW-on-MLBd.csv”</a></p>
<p>File source: “<a href="https://docs.google.com/spreadsheets/d/17QveSH4al14axf-cBsu4JEhgampQEU1E/edit?usp=sharing&amp;ouid=116930126837996341679&amp;rtpof=true&amp;sd=true">Biofilm PCR for R-studio</a>” tab called 9 sites PW on MLBd</p>
<p>Scientific Q: Is mono-strain Bd biofilm resistant to microbes in pond water</p>
<p>Statistical question:</p>
<p>Is there a difference in the <strong>gain or loss of Bd total over 7 days</strong> between the <strong>filter sizes</strong>?</p>
<p><strong>There is a significant difference in the change in the total quantity of Bd from Day 1 to Day 7 across the filter types (t = -6.45, df = 7, p-value = 0.0003)</strong></p>
</section>
<section id="piii-data-wrangling" class="level2">
<h2 class="anchored" data-anchor-id="piii-data-wrangling">PIII Data Wrangling</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>part_three <span class="ot">&lt;-</span> ns_ml_pw_bd <span class="sc">%&gt;%</span> </span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(filter <span class="sc">!=</span> <span class="st">"control"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(site <span class="sc">!=</span> <span class="st">"MQ"</span>)</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a><span class="co"># keep control for labeling plot</span></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>partIII_controls <span class="ot">&lt;-</span> ns_ml_pw_bd <span class="sc">%&gt;%</span> </span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(site <span class="sc">==</span><span class="st">"MQ"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> bd_location, <span class="at">values_from =</span> bd_qty) <span class="sc">%&gt;%</span></span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">combined_bd =</span> adherent <span class="sc">+</span> supernatant)</span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Data type cleaning</span></span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a>part_three<span class="sc">$</span>site <span class="ot">&lt;-</span> <span class="fu">factor</span>(part_three<span class="sc">$</span>site,</span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a>                                <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"CABIN"</span>, <span class="st">"GRAMPS"</span>, <span class="st">"WEST"</span>, <span class="st">"GDPND005"</span>, <span class="st">"GDPND006"</span>, <span class="st">"GDPND009"</span>, <span class="st">"PRPND004"</span>, <span class="st">"PRPND009"</span>, <span class="st">"PRPND010"</span>))</span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a>part_three<span class="sc">$</span>bd_location <span class="ot">&lt;-</span> <span class="fu">factor</span>(part_three<span class="sc">$</span>bd_location, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"supernatant"</span>, <span class="st">"adherent"</span>))</span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a>part_three<span class="sc">$</span>day <span class="ot">&lt;-</span> <span class="fu">factor</span>(part_three<span class="sc">$</span>day, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Day_1"</span>, <span class="st">"Day_7"</span>)) </span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a><span class="co"># get the total difference across days by combining both locations of Bd then subtracting across days</span></span>
<span id="cb29-18"><a href="#cb29-18" aria-hidden="true" tabindex="-1"></a>part_three_total_diff <span class="ot">&lt;-</span> part_three <span class="sc">%&gt;%</span></span>
<span id="cb29-19"><a href="#cb29-19" aria-hidden="true" tabindex="-1"></a>  <span class="co"># combine supernatant and adherent for total_Bd</span></span>
<span id="cb29-20"><a href="#cb29-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> bd_location, <span class="at">values_from =</span> bd_qty) <span class="sc">%&gt;%</span></span>
<span id="cb29-21"><a href="#cb29-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">combined_bd =</span> adherent <span class="sc">+</span> supernatant) <span class="sc">%&gt;%</span> </span>
<span id="cb29-22"><a href="#cb29-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">subset</span>(<span class="at">select =</span> <span class="sc">-</span><span class="fu">c</span>(adherent,supernatant)) <span class="sc">%&gt;%</span> </span>
<span id="cb29-23"><a href="#cb29-23" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb29-24"><a href="#cb29-24" aria-hidden="true" tabindex="-1"></a><span class="co"># different metrics of difference in Bd</span></span>
<span id="cb29-25"><a href="#cb29-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> day, <span class="at">values_from =</span> combined_bd) <span class="sc">%&gt;%</span></span>
<span id="cb29-26"><a href="#cb29-26" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb29-27"><a href="#cb29-27" aria-hidden="true" tabindex="-1"></a>  <span class="co"># calculate the difference in raw amount of Bd</span></span>
<span id="cb29-28"><a href="#cb29-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">diff =</span> Day_1 <span class="sc">-</span> Day_7) <span class="sc">%&gt;%</span> </span>
<span id="cb29-29"><a href="#cb29-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-30"><a href="#cb29-30" aria-hidden="true" tabindex="-1"></a>  <span class="co"># calculate the rate loss by taking the log of each before subtracting</span></span>
<span id="cb29-31"><a href="#cb29-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">rate_loss =</span> <span class="fu">log</span>(Day_1) <span class="sc">-</span> <span class="fu">log</span>(Day_7))</span>
<span id="cb29-32"><a href="#cb29-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-33"><a href="#cb29-33" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2: create subsets for each treatment</span></span>
<span id="cb29-34"><a href="#cb29-34" aria-hidden="true" tabindex="-1"></a>part_three_total_diff_40um <span class="ot">&lt;-</span> part_three_total_diff <span class="sc">%&gt;%</span> </span>
<span id="cb29-35"><a href="#cb29-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(filter <span class="sc">==</span><span class="st">"40um_filter"</span>)</span>
<span id="cb29-36"><a href="#cb29-36" aria-hidden="true" tabindex="-1"></a>part_three_total_diff<span class="fl">.22</span>um <span class="ot">&lt;-</span> part_three_total_diff <span class="sc">%&gt;%</span> </span>
<span id="cb29-37"><a href="#cb29-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(filter <span class="sc">==</span><span class="st">"0.22um_filter"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="piii-data-visualization" class="level2">
<h2 class="anchored" data-anchor-id="piii-data-visualization">PIII Data visualization</h2>
<section id="renwei-barplot-1" class="level3">
<h3 class="anchored" data-anchor-id="renwei-barplot-1">Renwei barplot</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>part_three <span class="sc">%&gt;%</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># combine floating and adherent for total_Bd</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> bd_location, <span class="at">values_from =</span> bd_qty) <span class="sc">%&gt;%</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">combined_bd =</span> adherent <span class="sc">+</span> supernatant) <span class="sc">%&gt;%</span> </span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y=</span> combined_bd, <span class="at">x =</span> site, <span class="at">fill =</span> filter)) <span class="sc">+</span> </span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_col</span>(<span class="at">position =</span> <span class="fu">position_dodge</span>()) <span class="sc">+</span></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>() <span class="sc">+</span></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(<span class="sc">~</span>day)<span class="sc">+</span></span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"40um_filter"</span> <span class="ot">=</span> with_microbes_40_color, </span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"0.22um_filter"</span> <span class="ot">=</span> no_microbes_<span class="fl">.22</span>_color)) <span class="sc">+</span></span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a>   <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>),</span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a>         <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">"bold"</span>),</span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a>         <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>)) <span class="sc">+</span> </span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">xlab</span>(<span class="st">"Site"</span>) <span class="sc">+</span></span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylab</span>(<span class="st">"Bd Quantity </span><span class="sc">\n</span><span class="st"> (zoospore equivalents)"</span>) <span class="sc">+</span></span>
<span id="cb30-18"><a href="#cb30-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill=</span><span class="fu">guide_legend</span>(<span class="at">title=</span><span class="st">""</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="biofilm-bd-pondwater_update_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="boxplot-2" class="level3">
<h3 class="anchored" data-anchor-id="boxplot-2">Boxplot</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>part_three <span class="sc">%&gt;%</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># combine floating and adherent for total_Bd</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> bd_location, <span class="at">values_from =</span> bd_qty) <span class="sc">%&gt;%</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a> <span class="fu">mutate</span>(<span class="at">combined_bd =</span> adherent <span class="sc">+</span> supernatant) <span class="sc">%&gt;%</span> </span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># plot it</span></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y=</span> combined_bd, <span class="at">x =</span> filter, <span class="at">fill =</span> filter)) <span class="sc">+</span> </span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">width =</span> <span class="fl">0.2</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_log10</span>() <span class="sc">+</span></span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(<span class="sc">~</span>day, <span class="at">labeller =</span> <span class="fu">labeller</span>(<span class="at">day =</span> <span class="fu">c</span>(<span class="st">"Day_1"</span> <span class="ot">=</span> <span class="st">"Day 1"</span>,</span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>                                                    <span class="st">"Day_7"</span> <span class="ot">=</span> <span class="st">"Day 7"</span>)))<span class="sc">+</span></span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"40um_filter"</span> <span class="ot">=</span> with_microbes_40_color, </span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"0.22um_filter"</span> <span class="ot">=</span> no_microbes_<span class="fl">.22</span>_color)) <span class="sc">+</span></span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a>   <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>,</span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a>         <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">"bold"</span>),</span>
<span id="cb31-18"><a href="#cb31-18" aria-hidden="true" tabindex="-1"></a>         <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>)) <span class="sc">+</span> </span>
<span id="cb31-19"><a href="#cb31-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span> (<span class="at">labels=</span> <span class="fu">c</span>(<span class="st">"40um_filter"</span> <span class="ot">=</span> <span class="st">"With Microbes"</span>, <span class="st">"0.22um_filter"</span> <span class="ot">=</span> <span class="st">"No Microbes"</span>)) <span class="sc">+</span></span>
<span id="cb31-20"><a href="#cb31-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">xlab</span>(<span class="st">"Presence of Microbes in Pond Water Added to Monolayer Biofilm"</span>) <span class="sc">+</span></span>
<span id="cb31-21"><a href="#cb31-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylab</span>(<span class="st">"Bd Quantity </span><span class="sc">\n</span><span class="st"> (zoospore equivalents)"</span>) <span class="sc">+</span></span>
<span id="cb31-22"><a href="#cb31-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-23"><a href="#cb31-23" aria-hidden="true" tabindex="-1"></a> <span class="co"># add controls ad x's</span></span>
<span id="cb31-24"><a href="#cb31-24" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_point</span>(<span class="at">data =</span> partIII_controls, <span class="fu">aes</span>(<span class="at">x =</span> filter, <span class="at">y =</span> combined_bd), <span class="at">shape =</span> <span class="dv">4</span>, <span class="at">size =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="biofilm-bd-pondwater_update_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="piii-stats-and-assumption-testing" class="level2">
<h2 class="anchored" data-anchor-id="piii-stats-and-assumption-testing">PIII Stats and assumption testing</h2>
<p>Question:</p>
<p>Does the difference in Bd from day 1 to day 7 differ between the two filter types?</p>
<p>The samples are essentially paired by site, so a paired t-test is most appropriate</p>
<p><span class="math inline">\(H0:μ_{difference in Bd}=0\)</span></p>
<p>Assumptions:</p>
<p>Assumes that the observations from each group represent a random sample from the population. Assumes that the difference of the two observations follow a normal distribution.</p>
<section id="test-paired-t-test-on-the-difference-in-total-bd-between-day-1-and-7" class="level3">
<h3 class="anchored" data-anchor-id="test-paired-t-test-on-the-difference-in-total-bd-between-day-1-and-7">Test: Paired t-test on the difference in total Bd between day 1 and 7</h3>
</section>
<section id="stats-results-1" class="level3">
<h3 class="anchored" data-anchor-id="stats-results-1">Stats results:</h3>
<p><strong>When monolayer Bd biofilm is exposed to pond water without microbes has a significantly greater loss of Bd between day 1 to day 7 than pond water with microbes (t = -5.4, df = 8, p = 0.0006825). The t-value is negative, which shows that the first item entered (with microbes) has a smaller loss of Bd than the second item entered (no microbes).</strong></p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># check normality of the differences across groups: it's normal untransformed in both!</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>part_three_total_diff_40um <span class="sc">%&gt;%</span> </span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a> <span class="fu">ggqqplot</span>(<span class="st">"rate_loss"</span>, <span class="at">title =</span> <span class="st">"Untransformed 40um"</span>) <span class="co"># good enough</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="biofilm-bd-pondwater_update_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(partI_total_diff_40um<span class="sc">$</span>rate_loss) <span class="co"># normal, yay!</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  partI_total_diff_40um$rate_loss
W = 0.93591, p-value = 0.3337</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(partI_total_diff_40um<span class="sc">$</span>rate_loss) <span class="co"># good enough</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="biofilm-bd-pondwater_update_files/figure-html/unnamed-chunk-16-2.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>part_three_total_diff<span class="fl">.22</span>um<span class="sc">%&gt;%</span> </span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a> <span class="fu">ggqqplot</span>(<span class="st">"rate_loss"</span>, <span class="at">title =</span> <span class="st">"Untransformed 0.22um"</span>) <span class="co"># gorgeous</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="biofilm-bd-pondwater_update_files/figure-html/unnamed-chunk-16-3.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(partI_total_diff<span class="fl">.22</span>um<span class="sc">$</span>rate_loss) <span class="co"># normal, yay!</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  partI_total_diff.22um$rate_loss
W = 0.96119, p-value = 0.7131</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(partI_total_diff<span class="fl">.22</span>um<span class="sc">$</span>rate_loss) <span class="co"># good enough</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="biofilm-bd-pondwater_update_files/figure-html/unnamed-chunk-16-4.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># visualize the comparison I am making</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>part_three_total_diff <span class="sc">%&gt;%</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y=</span> rate_loss, <span class="at">x =</span> filter)) <span class="sc">+</span> </span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>() <span class="sc">+</span></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Visualizing comparison for paired t-test on the rate_loss"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="biofilm-bd-pondwater_update_files/figure-html/unnamed-chunk-16-5.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Stats:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 3: run the paired t-test on the difference</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(part_three_total_diff_40um<span class="sc">$</span>rate_loss, part_three_total_diff<span class="fl">.22</span>um<span class="sc">$</span>rate_loss, <span class="at">paired =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Paired t-test

data:  part_three_total_diff_40um$rate_loss and part_three_total_diff.22um$rate_loss
t = -5.3541, df = 8, p-value = 0.0006825
alternative hypothesis: true mean difference is not equal to 0
95 percent confidence interval:
 -2.1870603 -0.8702665
sample estimates:
mean difference 
      -1.528663 </code></pre>
</div>
</div>
<p>When monolayer Bd biofilm is exposed to pond water without microbes has a significantly greater loss of Bd between day 1 to day 7 than pond water with microbes (t = -5.4, df = 8, p = 0.0006825). The t-value is negative, which shows that the first item entered (with microbes) has a smaller loss of Bd than the second item entered (no microbes).</p>
</section>
</section>
</section>
<section id="part-iv-comparing-across-all-treatments" class="level1">
<h1>Part IV Comparing across all treatments</h1>
<ul>
<li>1: susbet out only nine sites</li>
<li>2: subset out by treatment</li>
<li>2: calculate the percent Bd lost from day 1 to day 7 per site AND the rate of loss</li>
<li>3: add column for treatment</li>
<li>4: transform as needed</li>
<li>5: ANOVA and Tukey</li>
</ul>
<section id="piv-data-wrangling" class="level2">
<h2 class="anchored" data-anchor-id="piv-data-wrangling">PIV Data wrangling</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># data wrangling for comparisons across experiments</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>pw_no_microbes <span class="ot">&lt;-</span> partI_total_diff <span class="sc">%&gt;%</span> </span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># remove "other" 6 sites, not the 9 sites we are using</span></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(site<span class="sc">!=</span><span class="st">"NORTH"</span> <span class="sc">&amp;</span> site<span class="sc">!=</span><span class="st">"BARN"</span> <span class="sc">&amp;</span> site<span class="sc">!=</span><span class="st">"PRPND002"</span>  <span class="sc">&amp;</span> site<span class="sc">!=</span><span class="st">"PRPND003"</span> <span class="sc">&amp;</span> site<span class="sc">!=</span><span class="st">"GDPND004"</span>  <span class="sc">&amp;</span> site<span class="sc">!=</span><span class="st">"GDPND008"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(filter <span class="sc">==</span> <span class="st">"0.22um_filter"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">treatment =</span> <span class="st">"PW 0.22um"</span>)</span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a>pw_WITH_microbes <span class="ot">&lt;-</span> partI_total_diff <span class="sc">%&gt;%</span></span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># remove "other" 6 sites, not the 9 sites we are using</span></span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(site<span class="sc">!=</span><span class="st">"NORTH"</span> <span class="sc">&amp;</span> site<span class="sc">!=</span><span class="st">"BARN"</span> <span class="sc">&amp;</span> site<span class="sc">!=</span><span class="st">"PRPND002"</span>  <span class="sc">&amp;</span> site<span class="sc">!=</span><span class="st">"PRPND003"</span> <span class="sc">&amp;</span> site<span class="sc">!=</span><span class="st">"GDPND004"</span>  <span class="sc">&amp;</span> site<span class="sc">!=</span><span class="st">"GDPND008"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb43-12"><a href="#cb43-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(filter <span class="sc">!=</span> <span class="st">"0.22um_filter"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb43-13"><a href="#cb43-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">treatment =</span> <span class="st">"PW 40um"</span>)</span>
<span id="cb43-14"><a href="#cb43-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-15"><a href="#cb43-15" aria-hidden="true" tabindex="-1"></a>fieldbf_no_microbes <span class="ot">&lt;-</span> part_two_bf_only <span class="sc">%&gt;%</span></span>
<span id="cb43-16"><a href="#cb43-16" aria-hidden="true" tabindex="-1"></a>   <span class="fu">subset</span>(<span class="at">select =</span> <span class="sc">-</span><span class="fu">c</span>(bd_location, log_qty)) <span class="sc">%&gt;%</span> </span>
<span id="cb43-17"><a href="#cb43-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(day <span class="sc">!=</span> <span class="st">"Day_0"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb43-18"><a href="#cb43-18" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate the difference in raw amount of Bd</span></span>
<span id="cb43-19"><a href="#cb43-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> day, <span class="at">values_from =</span> bd_qty) <span class="sc">%&gt;%</span></span>
<span id="cb43-20"><a href="#cb43-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">diff =</span> Day_1 <span class="sc">-</span> Day_7) <span class="sc">%&gt;%</span> </span>
<span id="cb43-21"><a href="#cb43-21" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate the rate loss by taking the log of each before subtracting</span></span>
<span id="cb43-22"><a href="#cb43-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">rate_loss =</span> <span class="fu">log</span>(Day_1) <span class="sc">-</span> <span class="fu">log</span>(Day_7)) <span class="sc">%&gt;%</span> </span>
<span id="cb43-23"><a href="#cb43-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">treatment =</span> <span class="st">"Field bf 0.22"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb43-24"><a href="#cb43-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">filter =</span> <span class="st">"0.22um_filter"</span>)</span>
<span id="cb43-25"><a href="#cb43-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-26"><a href="#cb43-26" aria-hidden="true" tabindex="-1"></a>monolayer_WITH_microbes <span class="ot">&lt;-</span> part_three_total_diff <span class="sc">%&gt;%</span> </span>
<span id="cb43-27"><a href="#cb43-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(filter <span class="sc">!=</span> <span class="st">"0.22um_filter"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb43-28"><a href="#cb43-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">treatment =</span> <span class="st">"Monolayer 40um"</span>)</span>
<span id="cb43-29"><a href="#cb43-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-30"><a href="#cb43-30" aria-hidden="true" tabindex="-1"></a>monolayer_NO_microbes <span class="ot">&lt;-</span> part_three_total_diff <span class="sc">%&gt;%</span> </span>
<span id="cb43-31"><a href="#cb43-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(filter <span class="sc">==</span> <span class="st">"0.22um_filter"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb43-32"><a href="#cb43-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">treatment =</span> <span class="st">"Monolayer 0.22um"</span>)</span>
<span id="cb43-33"><a href="#cb43-33" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb43-34"><a href="#cb43-34" aria-hidden="true" tabindex="-1"></a>all_parts<span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(pw_WITH_microbes, pw_no_microbes, fieldbf_no_microbes, monolayer_WITH_microbes, monolayer_NO_microbes) <span class="sc">%&gt;%</span> </span>
<span id="cb43-35"><a href="#cb43-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">percent_loss =</span> (diff<span class="sc">/</span>Day_1) <span class="sc">*</span> <span class="dv">100</span>) </span>
<span id="cb43-36"><a href="#cb43-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-37"><a href="#cb43-37" aria-hidden="true" tabindex="-1"></a><span class="co"># set PW 40 um as the intercept, comparing back to that one</span></span>
<span id="cb43-38"><a href="#cb43-38" aria-hidden="true" tabindex="-1"></a>all_parts<span class="sc">$</span>treatment <span class="ot">&lt;-</span> <span class="fu">factor</span>(all_parts<span class="sc">$</span>treatment,</span>
<span id="cb43-39"><a href="#cb43-39" aria-hidden="true" tabindex="-1"></a>                          <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"PW 40um"</span>, <span class="st">"PW 0.22um"</span>, <span class="st">"Field bf 0.22"</span>, <span class="st">"Monolayer 40um"</span>, <span class="st">"Monolayer 0.22um"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="piv-stats-and-assumption-testing" class="level2">
<h2 class="anchored" data-anchor-id="piv-stats-and-assumption-testing">PIV Stats and assumption testing</h2>
<p>Question:</p>
<p><span class="math inline">\(H0:\)</span></p>
<p>Assumptions:</p>
<section id="test" class="level3">
<h3 class="anchored" data-anchor-id="test">Test:</h3>
</section>
<section id="stats-results-2" class="level3">
<h3 class="anchored" data-anchor-id="stats-results-2">Stats results:</h3>
<p>Assumptions testing</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>mod3 <span class="ot">&lt;-</span> <span class="fu">aov</span>(rate_loss<span class="sc">~</span>treatment, <span class="at">data=</span>all_parts)</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mod3) <span class="co"># not terrible!</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="biofilm-bd-pondwater_update_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Stats</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Response: rate_loss
          Df Sum Sq Mean Sq F value    Pr(&gt;F)    
treatment  4 99.543 24.8857  33.728 2.513e-12 ***
Residuals 40 29.513  0.7378                      
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod3) <span class="co"># sig!</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>            Df Sum Sq Mean Sq F value   Pr(&gt;F)    
treatment    4  99.54  24.886   33.73 2.51e-12 ***
Residuals   40  29.51   0.738                     
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>post_hoc_rateloss <span class="ot">&lt;-</span> <span class="fu">glht</span>(mod3, <span class="co"># with your ANOVA model</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>                 <span class="at">linfct =</span> <span class="fu">mcp</span>(<span class="at">treatment =</span> <span class="st">"Tukey"</span>))</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(post_hoc_rateloss)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
     Simultaneous Tests for General Linear Hypotheses

Multiple Comparisons of Means: Tukey Contrasts


Fit: aov(formula = rate_loss ~ treatment, data = all_parts)

Linear Hypotheses:
                                       Estimate Std. Error t value Pr(&gt;|t|)    
PW 0.22um - PW 40um == 0                -3.4588     0.4049  -8.542  &lt; 1e-04 ***
Field bf 0.22 - PW 40um == 0             0.1795     0.4049   0.443 0.991693    
Monolayer 40um - PW 40um == 0           -2.9684     0.4049  -7.331  &lt; 1e-04 ***
Monolayer 0.22um - PW 40um == 0         -1.4397     0.4049  -3.556 0.008255 ** 
Field bf 0.22 - PW 0.22um == 0           3.6383     0.4049   8.985  &lt; 1e-04 ***
Monolayer 40um - PW 0.22um == 0          0.4904     0.4049   1.211 0.744966    
Monolayer 0.22um - PW 0.22um == 0        2.0191     0.4049   4.986 0.000131 ***
Monolayer 40um - Field bf 0.22 == 0     -3.1478     0.4049  -7.774  &lt; 1e-04 ***
Monolayer 0.22um - Field bf 0.22 == 0   -1.6192     0.4049  -3.999 0.002308 ** 
Monolayer 0.22um - Monolayer 40um == 0   1.5287     0.4049   3.775 0.004475 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
(Adjusted p values reported -- single-step method)</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cld</span>(post_hoc_rateloss) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>         PW 40um        PW 0.22um    Field bf 0.22   Monolayer 40um 
             "a"              "b"              "a"              "b" 
Monolayer 0.22um 
             "c" </code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co"># export cld results as a dataframe</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>cld_results_rateloss <span class="ot">&lt;-</span> <span class="fu">cld</span>(post_hoc_rateloss)</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>labels_rl <span class="ot">&lt;-</span> cld_results_rateloss<span class="sc">$</span>mcletters<span class="sc">$</span>Letters</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>treatments_rl <span class="ot">&lt;-</span> <span class="fu">names</span>(labels_rl)</span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>labels_rl <span class="ot">&lt;-</span> <span class="fu">as.character</span>(labels_rl)</span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a>sig_data_rl <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">treatment =</span> treatments_rl,</span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">y_position =</span> <span class="fu">c</span>(<span class="fl">6.5</span>,<span class="fl">1.5</span>,<span class="fl">6.5</span>,<span class="fl">2.5</span>,<span class="dv">4</span>),</span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">label =</span> labels_rl)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="piv-data-visualization" class="level2">
<h2 class="anchored" data-anchor-id="piv-data-visualization">PIV Data visualization</h2>
<p>Exploratory:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>exploratory_viz <span class="ot">&lt;-</span> all_parts <span class="sc">%&gt;%</span> </span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y=</span> rate_loss, <span class="at">x =</span> treatment, <span class="at">fill =</span> filter)) <span class="sc">+</span> </span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">width =</span> <span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>   <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">"bold"</span>),</span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>)) <span class="sc">+</span> </span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span> (<span class="at">labels=</span> <span class="fu">c</span>(<span class="st">"40um_filter"</span> <span class="ot">=</span> <span class="st">"With Microbes"</span>, <span class="st">"0.22um_filter"</span> <span class="ot">=</span> <span class="st">"No Microbes"</span>)) <span class="sc">+</span></span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">xlab</span>(<span class="st">"Treatment"</span>) <span class="sc">+</span></span>
<span id="cb54-11"><a href="#cb54-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylab</span>(<span class="st">"Rate of Loss of Bd over 7 Days"</span>) <span class="sc">+</span> </span>
<span id="cb54-12"><a href="#cb54-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Exploratory visualization, not final plot"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Final plot:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>ab <span class="ot">&lt;-</span> all_parts <span class="sc">%&gt;%</span> </span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">medium =</span> <span class="fu">case_when</span>(</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"PW"</span>, treatment) <span class="sc">~</span> <span class="st">"PW"</span>,</span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"Field bf"</span>, treatment) <span class="sc">~</span> <span class="st">"Field bf"</span>,</span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"Monolayer"</span>, treatment) <span class="sc">~</span> <span class="st">"Monolayer"</span></span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span> </span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a>   <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y=</span> rate_loss, <span class="at">x =</span> medium, <span class="at">fill =</span> filter)) <span class="sc">+</span> </span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb55-10"><a href="#cb55-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb55-11"><a href="#cb55-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>filter, <span class="at">scales =</span> <span class="st">"free_x"</span>, <span class="at">labeller =</span> <span class="fu">labeller</span>(<span class="at">filter =</span> <span class="fu">c</span>(<span class="st">"0.22um_filter"</span> <span class="ot">=</span> <span class="st">"No Microbes"</span>,</span>
<span id="cb55-12"><a href="#cb55-12" aria-hidden="true" tabindex="-1"></a>                                                    <span class="st">"40um_filter"</span> <span class="ot">=</span> <span class="st">"With Microbes"</span>))) <span class="sc">+</span></span>
<span id="cb55-13"><a href="#cb55-13" aria-hidden="true" tabindex="-1"></a>   <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"40um_filter"</span> <span class="ot">=</span> with_microbes_40_color, </span>
<span id="cb55-14"><a href="#cb55-14" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"0.22um_filter"</span> <span class="ot">=</span> no_microbes_<span class="fl">.22</span>_color)) <span class="sc">+</span></span>
<span id="cb55-15"><a href="#cb55-15" aria-hidden="true" tabindex="-1"></a>   <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>,</span>
<span id="cb55-16"><a href="#cb55-16" aria-hidden="true" tabindex="-1"></a>         <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">"bold"</span>),</span>
<span id="cb55-17"><a href="#cb55-17" aria-hidden="true" tabindex="-1"></a>         <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>)) <span class="sc">+</span></span>
<span id="cb55-18"><a href="#cb55-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">xlab</span>(<span class="st">"Medium"</span>) <span class="sc">+</span></span>
<span id="cb55-19"><a href="#cb55-19" aria-hidden="true" tabindex="-1"></a>      <span class="fu">ylab</span>(<span class="st">"Rate loss of Bd over 7 Days"</span>) <span class="sc">+</span> </span>
<span id="cb55-20"><a href="#cb55-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span> (<span class="at">labels=</span> <span class="fu">c</span>(<span class="st">"PW"</span> <span class="ot">=</span> <span class="st">"Pond Water"</span>, <span class="st">"Field bf"</span> <span class="ot">=</span> <span class="st">"Aquatic </span><span class="sc">\n</span><span class="st">Environmental Biofilm"</span>, <span class="st">"Monolayer"</span> <span class="ot">=</span> <span class="st">"Bd-Monolayer</span><span class="sc">\n</span><span class="st">Biofilm"</span>))</span>
<span id="cb55-21"><a href="#cb55-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-22"><a href="#cb55-22" aria-hidden="true" tabindex="-1"></a>sig_data_rl <span class="ot">&lt;-</span> sig_data_rl <span class="sc">%&gt;%</span> </span>
<span id="cb55-23"><a href="#cb55-23" aria-hidden="true" tabindex="-1"></a><span class="fu">mutate</span>(<span class="at">filter =</span> <span class="fu">case_when</span>(</span>
<span id="cb55-24"><a href="#cb55-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"40um"</span>, treatment) <span class="sc">~</span> <span class="st">"40um_filter"</span>,</span>
<span id="cb55-25"><a href="#cb55-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"0.22"</span>, treatment) <span class="sc">~</span> <span class="st">"0.22um_filter"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb55-26"><a href="#cb55-26" aria-hidden="true" tabindex="-1"></a><span class="fu">mutate</span>(<span class="at">medium =</span> <span class="fu">case_when</span>(</span>
<span id="cb55-27"><a href="#cb55-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"PW"</span>, treatment) <span class="sc">~</span> <span class="st">"PW"</span>,</span>
<span id="cb55-28"><a href="#cb55-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"Field bf"</span>, treatment) <span class="sc">~</span> <span class="st">"Field bf"</span>,</span>
<span id="cb55-29"><a href="#cb55-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"Monolayer"</span>, treatment) <span class="sc">~</span> <span class="st">"Monolayer"</span>))</span>
<span id="cb55-30"><a href="#cb55-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-31"><a href="#cb55-31" aria-hidden="true" tabindex="-1"></a>ab <span class="sc">+</span> <span class="fu">geom_text</span>(<span class="at">data =</span> sig_data_rl, <span class="fu">aes</span>(<span class="at">x =</span> medium, <span class="at">y =</span> y_position, <span class="at">label =</span> label, <span class="at">group =</span> filter), <span class="at">inherit.aes =</span> <span class="cn">FALSE</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="biofilm-bd-pondwater_update_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<section id="takeaways" class="level3">
<h3 class="anchored" data-anchor-id="takeaways">Takeaways</h3>
<p>Key comparison: PW 40 um vs Monolayer 40 um: “The addition of a monolayer Bd to pond water leads to a significantly slower death rate of Bd; in other works, the addition of a monolayer Bd to pondwater protects the Bd from microbes”!</p>
<p>Key comparison: Field bf vs pw 0.22: “A natural biofilm increases the Bd death rate compared to not having anything present, AND it increases the Bd death rate as much as the microbes in pond water!</p>
<p>Key comparison: Field bf vs monolayer 0.22: “A monolayer Bd in the absence of microbes has a lower Bd death rate than a field biofilm, in other words, a Bd monolayer is more protective than a natural biofilm!</p>
</section>
</section>
</section>
<section id="appendix" class="level1">
<h1>Appendix</h1>
<section id="part-iv-alternate-routes" class="level2">
<h2 class="anchored" data-anchor-id="part-iv-alternate-routes">Part IV alternate routes</h2>
<section id="percent-reduction" class="level3">
<h3 class="anchored" data-anchor-id="percent-reduction">Percent reduction?</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>plot <span class="ot">&lt;-</span> all_parts <span class="sc">%&gt;%</span> </span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y=</span> percent_loss, <span class="at">x =</span> treatment, <span class="at">fill =</span> filter)) <span class="sc">+</span> </span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">width =</span> <span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>   <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"40um_filter"</span> <span class="ot">=</span> with_microbes_40_color, </span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"0.22um_filter"</span> <span class="ot">=</span> no_microbes_<span class="fl">.22</span>_color)) <span class="sc">+</span></span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a>   <span class="fu">theme</span>(</span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">"bold"</span>),</span>
<span id="cb56-10"><a href="#cb56-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>)) <span class="sc">+</span> </span>
<span id="cb56-11"><a href="#cb56-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span> (<span class="at">labels=</span> <span class="fu">c</span>(<span class="st">"40um_filter"</span> <span class="ot">=</span> <span class="st">"With Microbes"</span>, <span class="st">"0.22um_filter"</span> <span class="ot">=</span> <span class="st">"No Microbes"</span>)) <span class="sc">+</span></span>
<span id="cb56-12"><a href="#cb56-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">xlab</span>(<span class="st">"Treatment"</span>) <span class="sc">+</span></span>
<span id="cb56-13"><a href="#cb56-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylab</span>(<span class="st">"Percent Reduction of Bd over 7 Days"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="arcsin-square-root-percent-loss" class="level3">
<h3 class="anchored" data-anchor-id="arcsin-square-root-percent-loss">Arcsin square root percent loss</h3>
<p>Assumptions testing and stats</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Is my raw data normal?</span></span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>mod <span class="ot">&lt;-</span> <span class="fu">aov</span>(percent_loss<span class="sc">~</span>treatment, <span class="at">data=</span>all_parts)</span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mod) <span class="co"># nope! gotta transform or try rate</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="biofilm-bd-pondwater_update_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>all_parts <span class="ot">&lt;-</span> all_parts <span class="sc">%&gt;%</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">prop_loss =</span> percent_loss<span class="sc">/</span><span class="dv">100</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">transformed_percent =</span> <span class="fu">asin</span>(<span class="fu">sqrt</span>(prop_loss)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: There was 1 warning in `mutate()`.
ℹ In argument: `transformed_percent = asin(sqrt(prop_loss))`.
Caused by warning in `sqrt()`:
! NaNs produced</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>mod2 <span class="ot">&lt;-</span> <span class="fu">aov</span>(transformed_percent<span class="sc">~</span>treatment, <span class="at">data=</span>all_parts)</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mod2) <span class="co"># better! </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="biofilm-bd-pondwater_update_files/figure-html/unnamed-chunk-24-2.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod2) <span class="co"># sig</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>            Df Sum Sq Mean Sq F value   Pr(&gt;F)    
treatment    4  3.375  0.8437   38.86 6.07e-13 ***
Residuals   38  0.825  0.0217                     
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
2 observations deleted due to missingness</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Response: transformed_percent
          Df Sum Sq Mean Sq F value    Pr(&gt;F)    
treatment  4 3.3748 0.84369  38.858 6.069e-13 ***
Residuals 38 0.8251 0.02171                      
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>post_hoc2 <span class="ot">&lt;-</span> <span class="fu">glht</span>(mod2, <span class="co"># with your ANOVA model</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>                 <span class="at">linfct =</span> <span class="fu">mcp</span>(<span class="at">treatment =</span> <span class="st">"Tukey"</span>))</span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(post_hoc2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
     Simultaneous Tests for General Linear Hypotheses

Multiple Comparisons of Means: Tukey Contrasts


Fit: aov(formula = transformed_percent ~ treatment, data = all_parts)

Linear Hypotheses:
                                        Estimate Std. Error t value Pr(&gt;|t|)
PW 0.22um - PW 40um == 0               -0.717782   0.071599 -10.025   &lt;0.001
Field bf 0.22 - PW 40um == 0            0.007168   0.069461   0.103   1.0000
Monolayer 40um - PW 40um == 0          -0.461422   0.071599  -6.445   &lt;0.001
Monolayer 0.22um - PW 40um == 0        -0.139828   0.069461  -2.013   0.2794
Field bf 0.22 - PW 0.22um == 0          0.724949   0.071599  10.125   &lt;0.001
Monolayer 40um - PW 0.22um == 0         0.256359   0.073675   3.480   0.0105
Monolayer 0.22um - PW 0.22um == 0       0.577954   0.071599   8.072   &lt;0.001
Monolayer 40um - Field bf 0.22 == 0    -0.468590   0.071599  -6.545   &lt;0.001
Monolayer 0.22um - Field bf 0.22 == 0  -0.146995   0.069461  -2.116   0.2342
Monolayer 0.22um - Monolayer 40um == 0  0.321595   0.071599   4.492   &lt;0.001
                                          
PW 0.22um - PW 40um == 0               ***
Field bf 0.22 - PW 40um == 0              
Monolayer 40um - PW 40um == 0          ***
Monolayer 0.22um - PW 40um == 0           
Field bf 0.22 - PW 0.22um == 0         ***
Monolayer 40um - PW 0.22um == 0        *  
Monolayer 0.22um - PW 0.22um == 0      ***
Monolayer 40um - Field bf 0.22 == 0    ***
Monolayer 0.22um - Field bf 0.22 == 0     
Monolayer 0.22um - Monolayer 40um == 0 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
(Adjusted p values reported -- single-step method)</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cld</span>(post_hoc2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>         PW 40um        PW 0.22um    Field bf 0.22   Monolayer 40um 
             "a"              "b"              "a"              "c" 
Monolayer 0.22um 
             "a" </code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="co"># export cld results as a dataframe</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>cld_results_acp <span class="ot">&lt;-</span> <span class="fu">cld</span>(post_hoc2)</span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>labels_acp <span class="ot">&lt;-</span> cld_results_acp<span class="sc">$</span>mcletters<span class="sc">$</span>Letters</span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>treatments_acp <span class="ot">&lt;-</span> <span class="fu">names</span>(labels_acp)</span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a>labels_acp <span class="ot">&lt;-</span> <span class="fu">as.character</span>(labels_acp)</span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a>significance_labels_acp <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb69-8"><a href="#cb69-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">treatment =</span> treatments_acp,</span>
<span id="cb69-9"><a href="#cb69-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">label =</span> labels_acp,</span>
<span id="cb69-10"><a href="#cb69-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>)</span>
<span id="cb69-11"><a href="#cb69-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-12"><a href="#cb69-12" aria-hidden="true" tabindex="-1"></a><span class="co"># ajust label position</span></span>
<span id="cb69-13"><a href="#cb69-13" aria-hidden="true" tabindex="-1"></a>highest_values <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(transformed_percent <span class="sc">~</span> treatment, <span class="at">data =</span> all_parts, max)</span>
<span id="cb69-14"><a href="#cb69-14" aria-hidden="true" tabindex="-1"></a>significance_labels_acp <span class="ot">&lt;-</span> <span class="fu">merge</span>(significance_labels_acp, highest_values, <span class="at">by =</span> <span class="st">"treatment"</span>)</span>
<span id="cb69-15"><a href="#cb69-15" aria-hidden="true" tabindex="-1"></a>significance_labels_acp<span class="sc">$</span>y_position <span class="ot">&lt;-</span> significance_labels_acp<span class="sc">$</span>transformed_percent <span class="sc">*</span> <span class="fl">1.05</span>  <span class="co"># 5% above the max value</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Plot arcsinsqrt transformed percent reduction</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>arcsine_withlabels <span class="ot">&lt;-</span> all_parts <span class="sc">%&gt;%</span> </span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y=</span> transformed_percent, <span class="at">x =</span> treatment, <span class="at">fill =</span> filter)) <span class="sc">+</span> </span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">width =</span> <span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text</span>(<span class="at">data =</span> significance_labels_acp, <span class="fu">aes</span>(<span class="at">x =</span> treatment, <span class="at">y =</span> y_position, <span class="at">label =</span> label),<span class="at">inherit.aes =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a>     <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"40um_filter"</span> <span class="ot">=</span> with_microbes_40_color, </span>
<span id="cb70-8"><a href="#cb70-8" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"0.22um_filter"</span> <span class="ot">=</span> no_microbes_<span class="fl">.22</span>_color)) <span class="sc">+</span></span>
<span id="cb70-9"><a href="#cb70-9" aria-hidden="true" tabindex="-1"></a>   <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>,</span>
<span id="cb70-10"><a href="#cb70-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">"bold"</span>),</span>
<span id="cb70-11"><a href="#cb70-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>)) <span class="sc">+</span></span>
<span id="cb70-12"><a href="#cb70-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">xlab</span>(<span class="st">"Treatment"</span>) <span class="sc">+</span></span>
<span id="cb70-13"><a href="#cb70-13" aria-hidden="true" tabindex="-1"></a>      <span class="fu">ylab</span>(<span class="st">"Percent Reduction of Bd over 7 Days</span><span class="sc">\n</span><span class="st">(arcsine squareroot transformed)"</span>)</span>
<span id="cb70-14"><a href="#cb70-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-15"><a href="#cb70-15" aria-hidden="true" tabindex="-1"></a>arcsine_withlabels</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 2 rows containing non-finite outside the scale range
(`stat_boxplot()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 2 rows containing missing values or values outside the scale range
(`geom_point()`).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="biofilm-bd-pondwater_update_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="part-1-alternate-route" class="level2">
<h2 class="anchored" data-anchor-id="part-1-alternate-route">Part 1 alternate route</h2>
<section id="difference-another-way-to-measure-the-change-in-bd" class="level3">
<h3 class="anchored" data-anchor-id="difference-another-way-to-measure-the-change-in-bd">“Difference” Another way to measure the change in Bd</h3>
<p>We decide not to use this, rate_loss makes the most sense</p>
<p>check the “diff” *diff = Day_1 - Day_7 then log the difference if needed</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="co"># check normality of the differences across groups: it's normal untransformed in both!</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>partI_total_diff_40um <span class="sc">%&gt;%</span> </span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a> <span class="fu">ggqqplot</span>(<span class="st">"diff"</span>, <span class="at">title =</span> <span class="st">"Untransformed Bd in both floating and floating diff between day 1 and 7 qqPlot"</span>) <span class="co"># good enough</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="biofilm-bd-pondwater_update_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(partI_total_diff_40um<span class="sc">$</span>diff) <span class="co"># normal, yay!</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  partI_total_diff_40um$diff
W = 0.9461, p-value = 0.4652</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(partI_total_diff_40um<span class="sc">$</span>diff) <span class="co"># good enough</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="biofilm-bd-pondwater_update_files/figure-html/unnamed-chunk-26-2.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>partI_total_diff<span class="fl">.22</span>um<span class="sc">%&gt;%</span> </span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a> <span class="fu">ggqqplot</span>(<span class="st">"diff"</span>, <span class="at">title =</span> <span class="st">"Untransformed Bd in both floating and floating diff between day 1 and 7 qqPlot"</span>) <span class="co"># gorgeous</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="biofilm-bd-pondwater_update_files/figure-html/unnamed-chunk-26-3.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(partI_total_diff<span class="fl">.22</span>um<span class="sc">$</span>diff) <span class="co"># normal, yay!</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  partI_total_diff.22um$diff
W = 0.96225, p-value = 0.7314</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(partI_total_diff<span class="fl">.22</span>um<span class="sc">$</span>diff) <span class="co"># good enough</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="biofilm-bd-pondwater_update_files/figure-html/unnamed-chunk-26-4.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="co"># visualize the comparison I am making</span></span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>partI_total_diff <span class="sc">%&gt;%</span></span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y=</span> diff, <span class="at">x =</span> filter)) <span class="sc">+</span> </span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb81-5"><a href="#cb81-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>() <span class="sc">+</span></span>
<span id="cb81-6"><a href="#cb81-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Visualizing comparison for paired t-test on the differences"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="biofilm-bd-pondwater_update_files/figure-html/unnamed-chunk-26-5.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Stats:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 3: run the paired t-test on the difference</span></span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(partI_total_diff_40um<span class="sc">$</span>diff, partI_total_diff<span class="fl">.22</span>um<span class="sc">$</span>diff, <span class="at">paired =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Paired t-test

data:  partI_total_diff_40um$diff and partI_total_diff.22um$diff
t = 4.7879, df = 14, p-value = 0.000289
alternative hypothesis: true mean difference is not equal to 0
95 percent confidence interval:
 30282.21 79427.13
sample estimates:
mean difference 
       54854.67 </code></pre>
</div>
</div>
</section>
</section>
<section id="part-2-alternate-route-use-day-017-and-lme" class="level2">
<h2 class="anchored" data-anchor-id="part-2-alternate-route-use-day-017-and-lme">Part 2 alternate route: use day 0,1,7 and lme</h2>
<p>Mixed-effects model</p>
<p>Outcome variable: amount of Bd Fixed effect: day Random effect: site</p>
<section id="lme" class="level3">
<h3 class="anchored" data-anchor-id="lme">LME</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="co"># wrangle</span></span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>part_two_bf_only  <span class="ot">&lt;-</span> part_two_bf_only  <span class="sc">%&gt;%</span> </span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">log_qty =</span> <span class="fu">log</span>(bd_qty))</span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a><span class="co"># visualize</span></span>
<span id="cb84-6"><a href="#cb84-6" aria-hidden="true" tabindex="-1"></a>psych<span class="sc">::</span><span class="fu">pairs.panels</span>(part_two_bf_only)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="biofilm-bd-pondwater_update_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>part_two_bf_only <span class="sc">%&gt;%</span></span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a> <span class="fu">ggqqplot</span>(<span class="st">"log_qty"</span>, <span class="at">title =</span> <span class="st">"log_qty"</span>) <span class="co"># good enough</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="biofilm-bd-pondwater_update_files/figure-html/unnamed-chunk-28-2.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a>  <span class="fu">shapiro.test</span>(part_two_bf_only<span class="sc">$</span>log_qty) <span class="co"># normal, yay!</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  part_two_bf_only$log_qty
W = 0.86146, p-value = 0.01291</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hist</span>(part_two_bf_only<span class="sc">$</span>log_qty) <span class="co"># good enough?</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="biofilm-bd-pondwater_update_files/figure-html/unnamed-chunk-28-3.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a>mod <span class="ot">&lt;-</span> <span class="fu">aov</span>(log_qty <span class="sc">~</span> day, <span class="at">data =</span> part_two_bf_only) <span class="co"># couldn't use "plot" on lme so this was next best thing?</span></span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mod) <span class="co"># good enough resids?</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="biofilm-bd-pondwater_update_files/figure-html/unnamed-chunk-28-4.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="biofilm-bd-pondwater_update_files/figure-html/unnamed-chunk-28-5.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="biofilm-bd-pondwater_update_files/figure-html/unnamed-chunk-28-6.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="biofilm-bd-pondwater_update_files/figure-html/unnamed-chunk-28-7.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Model for randomized block design</span></span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>lme_mod <span class="ot">&lt;-</span> <span class="fu">lme</span>(log_qty <span class="sc">~</span> <span class="fu">factor</span>(day), <span class="at">random =</span> <span class="sc">~</span><span class="dv">1</span><span class="sc">|</span><span class="fu">factor</span>(site),  <span class="at">data =</span> part_two_bf_only)</span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lme_mod) <span class="co"># summary of the output</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed-effects model fit by REML
  Data: part_two_bf_only 
       AIC      BIC    logLik
  52.06098 55.15134 -22.03049

Random effects:
 Formula: ~1 | factor(site)
         (Intercept)  Residual
StdDev: 3.530157e-05 0.8358055

Fixed effects:  log_qty ~ factor(day) 
                     Value Std.Error DF   t-value p-value
(Intercept)      10.917887 0.2786018  8  39.18814       0
factor(day)Day_7 -4.191576 0.3940025  8 -10.63845       0
 Correlation: 
                 (Intr)
factor(day)Day_7 -0.707

Standardized Within-Group Residuals:
        Min          Q1         Med          Q3         Max 
-1.97550471 -0.51675771 -0.01674773  0.54028581  1.64555760 

Number of Observations: 18
Number of Groups: 9 </code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(lme_mod) <span class="co"># suse anova table to determine if the fixed effect of day is significant</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>            numDF denDF   F-value p-value
(Intercept)     1     8 2005.4227  &lt;.0001
factor(day)     1     8  113.1766  &lt;.0001</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a>emmeans<span class="sc">::</span><span class="fu">emmeans</span>(lme_mod, pairwise <span class="sc">~</span> day) <span class="co"># pairwise comparisons</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$emmeans
 day   emmean    SE df lower.CL upper.CL
 Day_1  10.92 0.279  8    10.28    11.56
 Day_7   6.73 0.279  8     6.08     7.37

Degrees-of-freedom method: containment 
Confidence level used: 0.95 

$contrasts
 contrast      estimate    SE df t.ratio p.value
 Day_1 - Day_7     4.19 0.394  8  10.638  &lt;.0001

Degrees-of-freedom method: containment </code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a>emmeans<span class="sc">::</span><span class="fu">lsmeans</span>(lme_mod, pairwise<span class="sc">~</span>day, <span class="at">adjust=</span><span class="st">"tukey"</span>) <span class="co"># pairwise comparisons</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$lsmeans
 day   lsmean    SE df lower.CL upper.CL
 Day_1  10.92 0.279  8    10.28    11.56
 Day_7   6.73 0.279  8     6.08     7.37

Degrees-of-freedom method: containment 
Confidence level used: 0.95 

$contrasts
 contrast      estimate    SE df t.ratio p.value
 Day_1 - Day_7     4.19 0.394  8  10.638  &lt;.0001

Degrees-of-freedom method: containment </code></pre>
</div>
</div>
<p>There is an overall effect of Day on the amount of Bd detected in the field biofilm (p &gt; 0.001). Specifically, there was more Bd in the field biofilm on day 1 than day 0 (p &lt;.0001), but there was significantly less Bd in the biofilm on day 7 than on day 1 (p &lt;.0001), and there was no difference in the amount of the Bd on day 0 and day 7 (p=0.43). The test is a linear mixed effects model (the model is the log transformed Bd quantity ~ day, random = ~1|site) with a post hoc pairwise comparison using the emmeans package.</p>
</section>
</section>
<section id="part-3-alternate-method-diff" class="level2">
<h2 class="anchored" data-anchor-id="part-3-alternate-method-diff">Part 3 alternate method: diff</h2>
<section id="diff-not-rate-loss-method-ignore-for-now" class="level3">
<h3 class="anchored" data-anchor-id="diff-not-rate-loss-method-ignore-for-now">diff not rate loss method, ignore for now</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Assumptions testing</span></span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a><span class="co"># check normality of the differences across groups</span></span>
<span id="cb98-4"><a href="#cb98-4" aria-hidden="true" tabindex="-1"></a>part_three_total_diff_40um <span class="sc">%&gt;%</span> </span>
<span id="cb98-5"><a href="#cb98-5" aria-hidden="true" tabindex="-1"></a> <span class="fu">ggqqplot</span>(<span class="st">"diff"</span>, <span class="at">title =</span> <span class="st">"40 um"</span>) <span class="co"># not great</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="biofilm-bd-pondwater_update_files/figure-html/unnamed-chunk-29-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(part_three_total_diff_40um<span class="sc">$</span>diff) <span class="co"># NOT normal</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  part_three_total_diff_40um$diff
W = 0.73146, p-value = 0.003302</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(part_three_total_diff_40um<span class="sc">$</span>diff) <span class="co"># nope</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="biofilm-bd-pondwater_update_files/figure-html/unnamed-chunk-29-2.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="co"># we gotta transform, and note we have negative: west GAINED Bd</span></span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a>part_three_total_diff_40um <span class="ot">&lt;-</span> part_three_total_diff_40um <span class="sc">%&gt;%</span> </span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">log_diff =</span> <span class="fu">log</span>(diff)) <span class="co"># warning: NaN's produced</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: There was 1 warning in `mutate()`.
ℹ In argument: `log_diff = log(diff)`.
Caused by warning in `log()`:
! NaNs produced</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a>part_three_total_diff_40um <span class="sc">%&gt;%</span> </span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggqqplot</span>(<span class="st">"log_diff"</span>, <span class="at">title =</span> <span class="st">"40 um"</span>) <span class="co"># good enough</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 1 row containing non-finite outside the scale range
(`stat_qq()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 1 row containing non-finite outside the scale range (`stat_qq_line()`).
Removed 1 row containing non-finite outside the scale range (`stat_qq_line()`).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="biofilm-bd-pondwater_update_files/figure-html/unnamed-chunk-29-3.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(part_three_total_diff_40um<span class="sc">$</span>log_diff) <span class="co"># woohoo!!</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  part_three_total_diff_40um$log_diff
W = 0.87459, p-value = 0.167</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(part_three_total_diff_40um<span class="sc">$</span>log_diff) <span class="co"># sure</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="biofilm-bd-pondwater_update_files/figure-html/unnamed-chunk-29-4.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 0.22 micron</span></span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-3"><a href="#cb110-3" aria-hidden="true" tabindex="-1"></a><span class="co"># check normality of the differences across groups</span></span>
<span id="cb110-4"><a href="#cb110-4" aria-hidden="true" tabindex="-1"></a>part_three_total_diff<span class="fl">.22</span>um  <span class="sc">%&gt;%</span> </span>
<span id="cb110-5"><a href="#cb110-5" aria-hidden="true" tabindex="-1"></a> <span class="fu">ggqqplot</span>(<span class="st">"diff"</span>, <span class="at">title =</span> <span class="st">".22 um"</span>) <span class="co"># not great</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="biofilm-bd-pondwater_update_files/figure-html/unnamed-chunk-29-5.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(part_three_total_diff<span class="fl">.22</span>um <span class="sc">$</span>diff) <span class="co"># shapiro says its fine</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  part_three_total_diff.22um$diff
W = 0.93097, p-value = 0.4906</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(part_three_total_diff<span class="fl">.22</span>um <span class="sc">$</span>diff) <span class="co"># meh</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="biofilm-bd-pondwater_update_files/figure-html/unnamed-chunk-29-6.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="co"># we gotta transform, but we have negative: west GAINED Bd</span></span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a>part_three_total_diff<span class="fl">.22</span>um  <span class="ot">&lt;-</span> part_three_total_diff<span class="fl">.22</span>um <span class="sc">%&gt;%</span> </span>
<span id="cb114-3"><a href="#cb114-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">log_diff =</span> <span class="fu">log</span>(diff))</span>
<span id="cb114-4"><a href="#cb114-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-5"><a href="#cb114-5" aria-hidden="true" tabindex="-1"></a>part_three_total_diff<span class="fl">.22</span>um  <span class="sc">%&gt;%</span> </span>
<span id="cb114-6"><a href="#cb114-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggqqplot</span>(<span class="st">"log_diff"</span>, <span class="at">title =</span> <span class="st">".22 um"</span>) <span class="co"># better?</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="biofilm-bd-pondwater_update_files/figure-html/unnamed-chunk-29-7.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(part_three_total_diff<span class="fl">.22</span>um <span class="sc">$</span>log_diff) <span class="co"># woohoo!!</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  part_three_total_diff.22um$log_diff
W = 0.92397, p-value = 0.4262</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(part_three_total_diff<span class="fl">.22</span>um <span class="sc">$</span>log_diff) <span class="co"># sure</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="biofilm-bd-pondwater_update_files/figure-html/unnamed-chunk-29-8.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="co"># visualize the comparison I am making</span></span>
<span id="cb118-2"><a href="#cb118-2" aria-hidden="true" tabindex="-1"></a>part_three_total_diff <span class="sc">%&gt;%</span></span>
<span id="cb118-3"><a href="#cb118-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y=</span> diff, <span class="at">x =</span> filter)) <span class="sc">+</span> </span>
<span id="cb118-4"><a href="#cb118-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb118-5"><a href="#cb118-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">width =</span> <span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb118-6"><a href="#cb118-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>()<span class="sc">+</span></span>
<span id="cb118-7"><a href="#cb118-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Visualizing comparison for paired t-test on the differences"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in transformation$transform(x): NaNs produced</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in scale_y_log10(): log-10 transformation introduced infinite values.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in transformation$transform(x): NaNs produced</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in scale_y_log10(): log-10 transformation introduced infinite values.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 1 row containing non-finite outside the scale range
(`stat_boxplot()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 1 row containing missing values or values outside the scale range
(`geom_point()`).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="biofilm-bd-pondwater_update_files/figure-html/unnamed-chunk-29-9.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Stats:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 3: run the paired t-test on the difference</span></span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(part_three_total_diff_40um<span class="sc">$</span>log_diff, part_three_total_diff<span class="fl">.22</span>um<span class="sc">$</span>log_diff, <span class="at">paired =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Paired t-test

data:  part_three_total_diff_40um$log_diff and part_three_total_diff.22um$log_diff
t = -6.4535, df = 7, p-value = 0.0003491
alternative hypothesis: true mean difference is not equal to 0
95 percent confidence interval:
 -2.701740 -1.252776
sample estimates:
mean difference 
      -1.977258 </code></pre>
</div>
</div>
<p>Same trend, yay!</p>
<p><strong>Note: df = 7? It should be 8, look into any NaN’s that may have been produced during log transformation</strong></p>
</section>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>