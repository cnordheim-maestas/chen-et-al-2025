<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Caitlin Nordheim-Maestas">

<title>Biofilm Bd Update</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="biofilm-bd-pondwater_update_files/libs/clipboard/clipboard.min.js"></script>
<script src="biofilm-bd-pondwater_update_files/libs/quarto-html/quarto.js"></script>
<script src="biofilm-bd-pondwater_update_files/libs/quarto-html/popper.min.js"></script>
<script src="biofilm-bd-pondwater_update_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="biofilm-bd-pondwater_update_files/libs/quarto-html/anchor.min.js"></script>
<link href="biofilm-bd-pondwater_update_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="biofilm-bd-pondwater_update_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="biofilm-bd-pondwater_update_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="biofilm-bd-pondwater_update_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="biofilm-bd-pondwater_update_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article toc-left">
<div id="quarto-sidebar-toc-left" class="sidebar toc-left">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#part-i-effect-of-aquatic-environmental-microbes-on-bd-growth---15-sites" id="toc-part-i-effect-of-aquatic-environmental-microbes-on-bd-growth---15-sites" class="nav-link active" data-scroll-target="#part-i-effect-of-aquatic-environmental-microbes-on-bd-growth---15-sites">Part I: Effect of aquatic environmental microbes on Bd growth - 15 sites</a>
  <ul class="collapse">
  <li><a href="#pi-about-the-data" id="toc-pi-about-the-data" class="nav-link" data-scroll-target="#pi-about-the-data">PI About the data</a>
  <ul class="collapse">
  <li><a href="#statistical-questions" id="toc-statistical-questions" class="nav-link" data-scroll-target="#statistical-questions">Statistical questions:</a></li>
  </ul></li>
  <li><a href="#pi-data-visualization" id="toc-pi-data-visualization" class="nav-link" data-scroll-target="#pi-data-visualization">PI Data visualization</a>
  <ul class="collapse">
  <li><a href="#renwei-barplot" id="toc-renwei-barplot" class="nav-link" data-scroll-target="#renwei-barplot">Renwei barplot</a></li>
  </ul></li>
  <li><a href="#pi-stats-and-assumption-testing" id="toc-pi-stats-and-assumption-testing" class="nav-link" data-scroll-target="#pi-stats-and-assumption-testing">PI Stats and assumption testing</a>
  <ul class="collapse">
  <li><a href="#part-i-q1-paired-t-test-on-the-difference-in-all-of-the-bd-from-day-1-to-day-7-between-the-two-filters" id="toc-part-i-q1-paired-t-test-on-the-difference-in-all-of-the-bd-from-day-1-to-day-7-between-the-two-filters" class="nav-link" data-scroll-target="#part-i-q1-paired-t-test-on-the-difference-in-all-of-the-bd-from-day-1-to-day-7-between-the-two-filters">Part I Q1: Paired t-test on the difference in all of the Bd from day 1 to day 7 between the two filters</a></li>
  <li><a href="#part-i-q2-paired-t-test-on-the-difference-in-floating-bd-from-day-1-to-day-7-between-the-two-filters" id="toc-part-i-q2-paired-t-test-on-the-difference-in-floating-bd-from-day-1-to-day-7-between-the-two-filters" class="nav-link" data-scroll-target="#part-i-q2-paired-t-test-on-the-difference-in-floating-bd-from-day-1-to-day-7-between-the-two-filters">Part I Q2: Paired t-test on the difference in floating Bd from day 1 to day 7 between the two filters</a></li>
  <li><a href="#part-i-q3-paired-t-test-on-the-difference-in-floating-bd-from-day-1-to-day-7-between-the-two-filters" id="toc-part-i-q3-paired-t-test-on-the-difference-in-floating-bd-from-day-1-to-day-7-between-the-two-filters" class="nav-link" data-scroll-target="#part-i-q3-paired-t-test-on-the-difference-in-floating-bd-from-day-1-to-day-7-between-the-two-filters">Part I Q3: Paired t-test on the difference in FLOATING Bd from day 1 to day 7 between the two filters</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#part-ii-effect-of-the-aquatic-environmental-biofilm-on-bd-growth---9-sites" id="toc-part-ii-effect-of-the-aquatic-environmental-biofilm-on-bd-growth---9-sites" class="nav-link" data-scroll-target="#part-ii-effect-of-the-aquatic-environmental-biofilm-on-bd-growth---9-sites">Part II: Effect of the aquatic environmental biofilm on Bd growth - “9 sites”</a>
  <ul class="collapse">
  <li><a href="#statisical-questions" id="toc-statisical-questions" class="nav-link" data-scroll-target="#statisical-questions">Statisical questions</a></li>
  <li><a href="#pii-data-visualization" id="toc-pii-data-visualization" class="nav-link" data-scroll-target="#pii-data-visualization">PII Data visualization</a>
  <ul class="collapse">
  <li><a href="#renwei-barplot-1" id="toc-renwei-barplot-1" class="nav-link" data-scroll-target="#renwei-barplot-1">Renwei barplot</a></li>
  </ul></li>
  <li><a href="#pii-assumptions-testing-and-stats" id="toc-pii-assumptions-testing-and-stats" class="nav-link" data-scroll-target="#pii-assumptions-testing-and-stats">PII Assumptions testing and Stats</a>
  <ul class="collapse">
  <li><a href="#q1-in-total-bd-is-there-a-diff-across-days-0-1-7" id="toc-q1-in-total-bd-is-there-a-diff-across-days-0-1-7" class="nav-link" data-scroll-target="#q1-in-total-bd-is-there-a-diff-across-days-0-1-7">Q1: In total Bd, is there a diff across days 0, 1, 7?</a></li>
  <li><a href="#q2-in-biofilms-is-there-a-diff-across-days-0-1-7" id="toc-q2-in-biofilms-is-there-a-diff-across-days-0-1-7" class="nav-link" data-scroll-target="#q2-in-biofilms-is-there-a-diff-across-days-0-1-7">Q2: In biofilms, is there a diff across days 0, 1, 7?</a></li>
  <li><a href="#q3-in-supernatant-is-there-a-diff-across-days-0-1-7" id="toc-q3-in-supernatant-is-there-a-diff-across-days-0-1-7" class="nav-link" data-scroll-target="#q3-in-supernatant-is-there-a-diff-across-days-0-1-7">Q3: In supernatant, is there a diff across days 0, 1, 7?</a></li>
  </ul></li>
  <li><a href="#discuss-with-group-normality-assumption-how-would-we-want-to-structure-a-glm-type-model-to-properly-account-for-site-while-accounting-for-the-paired-apsect-of-the-experiment" id="toc-discuss-with-group-normality-assumption-how-would-we-want-to-structure-a-glm-type-model-to-properly-account-for-site-while-accounting-for-the-paired-apsect-of-the-experiment" class="nav-link" data-scroll-target="#discuss-with-group-normality-assumption-how-would-we-want-to-structure-a-glm-type-model-to-properly-account-for-site-while-accounting-for-the-paired-apsect-of-the-experiment">Discuss with group: normality assumption, how would we want to structure a glm type model to properly account for site while accounting for the “paired” apsect of the experiment?</a></li>
  </ul></li>
  </ul>
</nav>
</div>
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Biofilm Bd Update</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Caitlin Nordheim-Maestas </p>
          </div>
  </div>
    
  
    
  </div>
  

</header>

<section id="part-i-effect-of-aquatic-environmental-microbes-on-bd-growth---15-sites" class="level1">
<h1>Part I: Effect of aquatic environmental microbes on Bd growth - 15 sites</h1>
<section id="pi-about-the-data" class="level2">
<h2 class="anchored" data-anchor-id="pi-about-the-data">PI About the data</h2>
<p>Wrangled results file name: <a href="https://docs.google.com/spreadsheets/d/11pCxR2oeprag1EGEAtdYpSmjaPwXD9szq_029p4OB2Q/edit?usp=sharing">“fifteen-sites-PW-on-Bd.csv”</a></p>
<p>File source: “<a href="https://docs.google.com/spreadsheets/d/17QveSH4al14axf-cBsu4JEhgampQEU1E/edit?usp=sharing&amp;ouid=116930126837996341679&amp;rtpof=true&amp;sd=true">Biofilm PCR for R-studio</a>” first tab called 15 sites PW on Bd</p>
<section id="statistical-questions" class="level3">
<h3 class="anchored" data-anchor-id="statistical-questions">Statistical questions:</h3>
<p><em>NOTE: we need to discuss how we are handling adherent vs floating, I did one test combining and a test on each</em></p>
<p>Part I Q1</p>
<p>Is there a difference in the <strong>gain or loss of Bd over 7 days</strong> between the <strong>filter sizes</strong> looking at the <strong>TOTAL BD</strong></p>
<p><strong>Answer: There is a significant difference in the change in the total quantity of Bd from Day 1 to Day 7 across the filter types (t = 4.7879, df = 14, p-value = 0.000289)</strong></p>
<p>Part I Q2</p>
<p>Is there a difference in the <strong>gain or loss of Bd over 7 days</strong> between the <strong>filter sizes</strong> looking at the <strong>ADHERENT BD</strong></p>
<p><strong>Answer: There is a significant difference in the change in the adherent Bd from Day 1 to Day 7 across the filter types (t = -5.8588, df = 14, p-value = 4.155e-05)</strong></p>
<p>Part I Q3</p>
<p>Is there a difference in the <strong>gain or loss of Bd over 7 days</strong> between the <strong>filter sizes</strong> looking at the <strong>FLOATING BD</strong></p>
<p><strong>Answer: Data are not normal enough to test this question for the floating Bd according to qqPlot and shapiro</strong></p>
<p>This experiment took pond water from 15 East Bay sites in Spring 2022 back to the lab, filtered the pond water to keep or remove the microbes, and added the pond water to lab-cultured Bd-monoculture-biofilms. Two biofilms per water treatment, one destructively sampled day 1, and one destructively sampled day 7 for qPCR quantification of Bd in the supernatant and the biofilm itself.</p>
</section>
</section>
<section id="pi-data-visualization" class="level2">
<h2 class="anchored" data-anchor-id="pi-data-visualization">PI Data visualization</h2>
<section id="renwei-barplot" class="level3">
<h3 class="anchored" data-anchor-id="renwei-barplot">Renwei barplot</h3>
<p>Discussion points: Color preferences? And consider if we arent distinguishing bw floating and adherent, can make a simpler plot with just the total Bd, filter, and day, and can do a side by side boxplot with day to clearly show the difference and only one facet. Also labels: do we want it to be “with microbes” and “without microbes”?</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>fs_pw_bd <span class="sc">%&gt;%</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y=</span> <span class="fu">log10</span>(bd_qty <span class="sc">+</span> <span class="dv">1</span>), <span class="at">x =</span> site, <span class="at">fill=</span>bd_location)) <span class="sc">+</span> </span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_col</span>() <span class="sc">+</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_grid</span>(day<span class="sc">~</span>filter)<span class="sc">+</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">#theme_classic() +</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>   <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>),</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>          <span class="at">legend.position =</span> <span class="st">"bottom"</span>) <span class="sc">+</span> </span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">xlab</span>(<span class="st">"Site"</span>) <span class="sc">+</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylab</span>(<span class="st">"Bd Quantity </span><span class="sc">\n</span><span class="st"> (log + 1 transformed zoospore equivalents)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="biofilm-bd-pondwater_update_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Effect of aquatic environmental microbes on Bd growth"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$title
[1] "Effect of aquatic environmental microbes on Bd growth"

attr(,"class")
[1] "labels"</code></pre>
</div>
</div>
</section>
</section>
<section id="pi-stats-and-assumption-testing" class="level2">
<h2 class="anchored" data-anchor-id="pi-stats-and-assumption-testing">PI Stats and assumption testing</h2>
<p>Question:</p>
<p>Does the difference in Bd from day 1 to day 7 differ between the two filter types?</p>
<p>The samples are essentially paired by site, so a paired t-test is most appropriate</p>
<p><span class="math inline">\(H0:μ_{difference in Bd}=0\)</span></p>
<p>Assumptions:</p>
<p>Assumes that the observations from each group represent a random sample from the population. Assumes that the difference of the two observations follow a normal distribution.</p>
<p>Plan: 3 paired t-tests: Simplest: combining floating and not floating Bd, then more complex: One for adherent, one for floating, then let Cherie and Renwei choose which is most appropriate</p>
<section id="part-i-q1-paired-t-test-on-the-difference-in-all-of-the-bd-from-day-1-to-day-7-between-the-two-filters" class="level3">
<h3 class="anchored" data-anchor-id="part-i-q1-paired-t-test-on-the-difference-in-all-of-the-bd-from-day-1-to-day-7-between-the-two-filters">Part I Q1: Paired t-test on the difference in all of the Bd from day 1 to day 7 between the two filters</h3>
<p><strong>There is a significant difference in the change in the total quantity of Bd from Day 1 to Day 7 across the filter types (t = 4.7879, df = 14, p-value = 0.000289)</strong></p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Assumptions testing</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 1: combine floating and floating</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>fs_wider_combined <span class="ot">&lt;-</span> fs_pw_bd <span class="sc">%&gt;%</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> bd_location, <span class="at">values_from =</span> bd_qty) <span class="sc">%&gt;%</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">combined_bd =</span> adherent <span class="sc">+</span> floating)</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>fs_wider_combined <span class="ot">&lt;-</span> <span class="fu">subset</span>(fs_wider_combined, <span class="at">select =</span> <span class="sc">-</span><span class="fu">c</span>(adherent,floating) )</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>fs_wider_combined <span class="ot">&lt;-</span> fs_wider_combined <span class="sc">%&gt;%</span> </span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># calculate diff</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> day, <span class="at">values_from =</span> combined_bd) <span class="sc">%&gt;%</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">diff =</span> Day_1 <span class="sc">-</span> Day_7)</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2: create subsets for each treatment</span></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>fs_wider_combined_40um <span class="ot">&lt;-</span> fs_wider_combined <span class="sc">%&gt;%</span> </span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(filter <span class="sc">==</span><span class="st">"40um_filter"</span>)</span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>fs_wider_combined_<span class="fl">.22</span>um <span class="ot">&lt;-</span> fs_wider_combined <span class="sc">%&gt;%</span> </span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(filter <span class="sc">==</span><span class="st">"0.22um_filter"</span>)</span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 3: check normality of the differences across groups</span></span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a>fs_wider_combined_40um <span class="sc">%&gt;%</span> </span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a> <span class="fu">ggqqplot</span>(<span class="st">"diff"</span>, <span class="at">title =</span> <span class="st">"Untransformed Bd in both floating and floating diff between day 1 and 7 qqPlot"</span>) <span class="co"># good enough</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="biofilm-bd-pondwater_update_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(fs_wider_combined_40um<span class="sc">$</span>diff) <span class="co"># normal, yay!</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  fs_wider_combined_40um$diff
W = 0.9461, p-value = 0.4652</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(fs_wider_combined_40um<span class="sc">$</span>diff) <span class="co"># good enough</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="biofilm-bd-pondwater_update_files/figure-html/unnamed-chunk-3-2.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>fs_wider_combined_<span class="fl">.22</span>um <span class="sc">%&gt;%</span> </span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a> <span class="fu">ggqqplot</span>(<span class="st">"diff"</span>, <span class="at">title =</span> <span class="st">"Untransformed Bd in both floating and floating diff between day 1 and 7 qqPlot"</span>) <span class="co"># gorgeous</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="biofilm-bd-pondwater_update_files/figure-html/unnamed-chunk-3-3.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(fs_wider_combined_<span class="fl">.22</span>um<span class="sc">$</span>diff) <span class="co"># normal, yay!</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  fs_wider_combined_.22um$diff
W = 0.96225, p-value = 0.7314</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(fs_wider_combined_<span class="fl">.22</span>um<span class="sc">$</span>diff) <span class="co"># good enough</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="biofilm-bd-pondwater_update_files/figure-html/unnamed-chunk-3-4.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Stats:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 3: run the paired t-test on the difference</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(fs_wider_combined_40um<span class="sc">$</span>diff, fs_wider_combined_<span class="fl">.22</span>um<span class="sc">$</span>diff, <span class="at">paired =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Paired t-test

data:  fs_wider_combined_40um$diff and fs_wider_combined_.22um$diff
t = 4.7879, df = 14, p-value = 0.000289
alternative hypothesis: true mean difference is not equal to 0
95 percent confidence interval:
 30282.21 79427.13
sample estimates:
mean difference 
       54854.67 </code></pre>
</div>
</div>
</section>
<section id="part-i-q2-paired-t-test-on-the-difference-in-floating-bd-from-day-1-to-day-7-between-the-two-filters" class="level3">
<h3 class="anchored" data-anchor-id="part-i-q2-paired-t-test-on-the-difference-in-floating-bd-from-day-1-to-day-7-between-the-two-filters">Part I Q2: Paired t-test on the difference in floating Bd from day 1 to day 7 between the two filters</h3>
<p><strong>There is a significant difference in the change in the adherent Bd from Day 1 to Day 7 across the filter types (t = -5.8588, df = 14, p-value = 4.155e-05)</strong></p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 1: SELECT ONLY adherent BD and calculate the diff between day 1 and 7</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>fs_adherent_wide <span class="ot">&lt;-</span> fs_pw_bd <span class="sc">%&gt;%</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(bd_location <span class="sc">==</span><span class="st">"adherent"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># calculate diff</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> day, <span class="at">values_from =</span> bd_qty) <span class="sc">%&gt;%</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">diff =</span> Day_1 <span class="sc">-</span> Day_7)</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2: create subsets for each treatment</span></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>fs_adherent_wide_40 <span class="ot">&lt;-</span> fs_adherent_wide <span class="sc">%&gt;%</span> </span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(filter <span class="sc">==</span><span class="st">"40um_filter"</span>)</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>fs_adherent_wide_<span class="fl">.22</span> <span class="ot">&lt;-</span> fs_adherent_wide <span class="sc">%&gt;%</span> </span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(filter <span class="sc">==</span><span class="st">"0.22um_filter"</span>)</span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 3: check normality of the differences across groups</span></span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>fs_adherent_wide_40  <span class="sc">%&gt;%</span> </span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a> <span class="fu">ggqqplot</span>(<span class="st">"diff"</span>, <span class="at">title =</span> <span class="st">"Untransformed Bd in both adherent and adherent diff between day 1 and 7 qqPlot"</span>) <span class="co"># perf</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="biofilm-bd-pondwater_update_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(fs_adherent_wide_40 <span class="sc">$</span>diff) <span class="co"># normal, yay!</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  fs_adherent_wide_40$diff
W = 0.96911, p-value = 0.8446</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(fs_adherent_wide_40 <span class="sc">$</span>diff) <span class="co"># good enough</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="biofilm-bd-pondwater_update_files/figure-html/unnamed-chunk-5-2.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>fs_adherent_wide_<span class="fl">.22</span> <span class="sc">%&gt;%</span> </span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a> <span class="fu">ggqqplot</span>(<span class="st">"diff"</span>, <span class="at">title =</span> <span class="st">"Untransformed Bd in both adherent and adherent diff between day 1 and 7 qqPlot"</span>) <span class="co"># gorgeous</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="biofilm-bd-pondwater_update_files/figure-html/unnamed-chunk-5-3.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(fs_adherent_wide_<span class="fl">.22</span><span class="sc">$</span>diff) <span class="co"># normal, yay!</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  fs_adherent_wide_.22$diff
W = 0.97735, p-value = 0.9481</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(fs_adherent_wide_<span class="fl">.22</span><span class="sc">$</span>diff) <span class="co"># good enough</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="biofilm-bd-pondwater_update_files/figure-html/unnamed-chunk-5-4.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Stats:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 3: run the paired t-test on the difference</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(fs_adherent_wide_<span class="fl">.22</span><span class="sc">$</span>diff, fs_adherent_wide_40<span class="sc">$</span>diff, <span class="at">paired =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Paired t-test

data:  fs_adherent_wide_.22$diff and fs_adherent_wide_40$diff
t = -5.8588, df = 14, p-value = 4.155e-05
alternative hypothesis: true mean difference is not equal to 0
95 percent confidence interval:
 -75910.98 -35225.82
sample estimates:
mean difference 
       -55568.4 </code></pre>
</div>
</div>
</section>
<section id="part-i-q3-paired-t-test-on-the-difference-in-floating-bd-from-day-1-to-day-7-between-the-two-filters" class="level3">
<h3 class="anchored" data-anchor-id="part-i-q3-paired-t-test-on-the-difference-in-floating-bd-from-day-1-to-day-7-between-the-two-filters">Part I Q3: Paired t-test on the difference in FLOATING Bd from day 1 to day 7 between the two filters</h3>
<p><strong>Floating Bd alone is not normally distrubuted, violates the test assumptions</strong></p>
<p>If this is an important question, need to determine transformation (log of the neg difference (aka gain in floating Bd is throwing NaN’s)</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 1: SELECT ONLY floating BD and calculate the diff between day 1 and 7</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>fs_floating_wide <span class="ot">&lt;-</span> fs_pw_bd <span class="sc">%&gt;%</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(bd_location <span class="sc">==</span><span class="st">"floating"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># calculate diff</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> day, <span class="at">values_from =</span> bd_qty) <span class="sc">%&gt;%</span></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">diff =</span> Day_1 <span class="sc">-</span> Day_7)</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2: create subsets for each treatment</span></span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>fs_floating_wide_40 <span class="ot">&lt;-</span> fs_floating_wide <span class="sc">%&gt;%</span> </span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(filter <span class="sc">==</span><span class="st">"40um_filter"</span>)</span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>fs_floating_wide_<span class="fl">.22</span> <span class="ot">&lt;-</span> fs_floating_wide <span class="sc">%&gt;%</span> </span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(filter <span class="sc">==</span><span class="st">"0.22um_filter"</span>)</span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 3: check normality of the differences across groups</span></span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a>qq1 <span class="ot">&lt;-</span> <span class="fu">qqPlot</span>(fs_floating_wide_40<span class="sc">$</span>diff) <span class="co"># NOPE</span></span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(fs_floating_wide_40<span class="sc">$</span>diff) <span class="co"># NOPE</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  fs_floating_wide_40$diff
W = 0.69966, p-value = 0.0002465</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>hist40 <span class="ot">&lt;-</span> <span class="fu">hist</span>(fs_floating_wide_40<span class="sc">$</span>diff) <span class="co"># NOPE </span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="do">## could log transform and try again if it is of interest</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>qq2 <span class="ot">&lt;-</span> <span class="fu">qqPlot</span>(fs_floating_wide_<span class="fl">.22</span><span class="sc">$</span>diff)</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(fs_floating_wide_<span class="fl">.22</span><span class="sc">$</span>diff) <span class="co"># normal, yay!</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  fs_floating_wide_.22$diff
W = 0.9559, p-value = 0.6216</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>hist20 <span class="ot">&lt;-</span> <span class="fu">hist</span>(fs_floating_wide_<span class="fl">.22</span><span class="sc">$</span>diff) <span class="co"># good enough</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="biofilm-bd-pondwater_update_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 3: run the paired t-test on the difference</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="co">#t.test(fs_floating_wide_.22$diff, fs_floating_wide_40$diff, paired = TRUE)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
</section>
<section id="part-ii-effect-of-the-aquatic-environmental-biofilm-on-bd-growth---9-sites" class="level1">
<h1>Part II: Effect of the aquatic environmental biofilm on Bd growth - “9 sites”</h1>
<p>Wrangled results file name: <a href="https://docs.google.com/spreadsheets/d/1YCU_tCge48MhDw7cMfYAZYokpwAVHtkaY7rfrC5jUDg/edit#gid=0">“nine-sites-biofilm-on-Bd.csv”</a></p>
<p>File source: “<a href="https://docs.google.com/spreadsheets/d/17QveSH4al14axf-cBsu4JEhgampQEU1E/edit?usp=sharing&amp;ouid=116930126837996341679&amp;rtpof=true&amp;sd=true">Biofilm PCR for R-studio</a>” first tab called 9 sites Biofilm on Bd</p>
<section id="statisical-questions" class="level3">
<h3 class="anchored" data-anchor-id="statisical-questions">Statisical questions</h3>
<p>Part II Q1: Is there a difference in Bd quantity total between day 0, 1, 7? - repeated measures anova</p>
<p><strong>There is a significant difference in the amount of log Bd total across the days (p = 1.01e-11). Day 0 and Day 1 differ (p = 2.48e-05), Day 1 and Day 7 differ (p = 1.35e-05), Day 0 and Day 7 differ (p = 5.82e-07)</strong></p>
<p>Part II Q2: Is there a difference in Bd quantity in the biofilm between day 0, 1, 7? - repeated measures anova</p>
<p><strong>STOP: DOES NOT PASS NORMALITY ASSUMPTION FOR DAY 0!!!</strong> Discuss alternative tests?</p>
<p>Part II Q3: Is there a difference in Bd quantity in the supernatant between day 0, 1, 7? - repeated measures anova</p>
<p><strong>There is a significant difference in the amount of log Bd in the supernatant across the days (p = 5.15e-10). Day 0 and Day 1 differ (p = 2.06e-05), Day 1 and Day 7 differ (p = 3.75e-04 ), and Day 0 and Day 7 differ (p = 3.36e-06 )</strong></p>
</section>
<section id="pii-data-visualization" class="level2">
<h2 class="anchored" data-anchor-id="pii-data-visualization">PII Data visualization</h2>
<section id="renwei-barplot-1" class="level3">
<h3 class="anchored" data-anchor-id="renwei-barplot-1">Renwei barplot</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>ns_biofilm_bd <span class="sc">%&gt;%</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y=</span> <span class="fu">log10</span>(bd_qty), <span class="at">x =</span> site, <span class="at">fill=</span>bd_location)) <span class="sc">+</span> </span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_col</span>() <span class="sc">+</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_grid</span>(.<span class="sc">~</span>day)<span class="sc">+</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>),</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>          <span class="at">legend.position =</span> <span class="st">"bottom"</span>) <span class="sc">+</span> </span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">xlab</span>(<span class="st">"Site"</span>) <span class="sc">+</span></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>   <span class="fu">ylab</span>(<span class="st">"Bd Quantity </span><span class="sc">\n</span><span class="st"> (log transformed zoospore equivalents)"</span>) <span class="sc">+</span></span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Lab Bd innoculation on East Bay Biofilms - 9 sites"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="biofilm-bd-pondwater_update_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="pii-assumptions-testing-and-stats" class="level2">
<h2 class="anchored" data-anchor-id="pii-assumptions-testing-and-stats">PII Assumptions testing and Stats</h2>
<p>Repeated Measures ANOVA</p>
<p>Unfamiliar test and function to me, followed this tutorial: https://www.datanovia.com/en/lessons/repeated-measures-anova-in-r/</p>
<section id="q1-in-total-bd-is-there-a-diff-across-days-0-1-7" class="level3">
<h3 class="anchored" data-anchor-id="q1-in-total-bd-is-there-a-diff-across-days-0-1-7">Q1: In total Bd, is there a diff across days 0, 1, 7?</h3>
<p><strong>There is a significant difference in the amount of log Bd total across the days (p = 1.01e-11). Day 0 and Day 1 differ (p = 2.48e-05), Day 1 and Day 7 differ (p = 1.35e-05), Day 0 and Day 7 differ (p = 5.82e-07)</strong></p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 1: combine floating and floating</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>combined <span class="ot">&lt;-</span> ns_biofilm_bd <span class="sc">%&gt;%</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> bd_location, <span class="at">values_from =</span> bd_qty) <span class="sc">%&gt;%</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">combined_bd =</span> biofilm <span class="sc">+</span> supernatant) <span class="sc">%&gt;%</span> </span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">log_combined_bd =</span> <span class="fu">log</span>(combined_bd))</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a><span class="co"># assumptions</span></span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>combined <span class="sc">%&gt;%</span></span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(day) <span class="sc">%&gt;%</span></span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>  <span class="co">#shapiro_test(combined_bd) %&gt;%  # SO DAMN CLOSE without transformation</span></span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">shapiro_test</span>(log_combined_bd) <span class="co"># def normal</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 4
  day   variable        statistic     p
  &lt;fct&gt; &lt;chr&gt;               &lt;dbl&gt; &lt;dbl&gt;
1 Day_0 log_combined_bd     0.957 0.767
2 Day_1 log_combined_bd     0.959 0.790
3 Day_7 log_combined_bd     0.953 0.719</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># anova</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>res.aov <span class="ot">&lt;-</span> <span class="fu">anova_test</span>(<span class="at">data =</span> combined, <span class="at">dv =</span> log_combined_bd, <span class="at">wid =</span> site, <span class="at">within =</span> day)</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a><span class="fu">get_anova_table</span>(res.aov) <span class="co"># ges is the generalized effect size (amount of variability due to the within-subjects factor)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>ANOVA Table (type III tests)

  Effect DFn DFd       F        p p&lt;.05   ges
1    day   2  16 181.388 1.01e-11     * 0.945</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># post hoc pairwise comparison: pairwise ttest with bonferroni correction</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>pwc <span class="ot">&lt;-</span>combined <span class="sc">%&gt;%</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pairwise_t_test</span>(</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>    log_combined_bd <span class="sc">~</span> day, <span class="at">paired =</span> <span class="cn">TRUE</span>,</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">p.adjust.method =</span> <span class="st">"bonferroni"</span></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>pwc</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 10
  .y.     group1 group2    n1    n2 statistic    df       p   p.adj p.adj.signif
* &lt;chr&gt;   &lt;chr&gt;  &lt;chr&gt;  &lt;int&gt; &lt;int&gt;     &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt;       
1 log_co… Day_0  Day_1      9     9      10.0     8 8.25e-6 2.48e-5 ****        
2 log_co… Day_0  Day_7      9     9      16.4     8 1.94e-7 5.82e-7 ****        
3 log_co… Day_1  Day_7      9     9      10.9     8 4.51e-6 1.35e-5 ****        </code></pre>
</div>
</div>
</section>
<section id="q2-in-biofilms-is-there-a-diff-across-days-0-1-7" class="level3">
<h3 class="anchored" data-anchor-id="q2-in-biofilms-is-there-a-diff-across-days-0-1-7">Q2: In biofilms, is there a diff across days 0, 1, 7?</h3>
<p><strong>STOP: DOES NOT PASS NORMALITY ASSUMPTION FOR DAY 0!!!</strong></p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>biofilm_only <span class="ot">&lt;-</span> ns_biofilm_bd <span class="sc">%&gt;%</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(bd_location <span class="sc">==</span> <span class="st">"biofilm"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">log_qty =</span> <span class="fu">log</span>(bd_qty))</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a><span class="co"># assumptions tests</span></span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>biofilm_only <span class="sc">%&gt;%</span></span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(day) <span class="sc">%&gt;%</span></span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">shapiro_test</span>(log_qty) <span class="co"># day 0 does not pass</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 4
  day   variable statistic      p
  &lt;fct&gt; &lt;chr&gt;        &lt;dbl&gt;  &lt;dbl&gt;
1 Day_0 log_qty      0.780 0.0119
2 Day_1 log_qty      0.938 0.561 
3 Day_7 log_qty      0.922 0.412 </code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># anova</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>res.aov <span class="ot">&lt;-</span> <span class="fu">anova_test</span>(<span class="at">data =</span> biofilm_only, <span class="at">dv =</span> log_qty, <span class="at">wid =</span> site, <span class="at">within =</span> day)</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a><span class="fu">get_anova_table</span>(res.aov) <span class="co"># ges is the generalized effect size (amount of variability due to the within-subjects factor)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>ANOVA Table (type III tests)

  Effect DFn DFd    F       p p&lt;.05   ges
1    day   2  16 30.6 3.4e-06     * 0.739</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># post hoc pairwise comparison: pairwise ttest with bonferroni correction</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>pwc <span class="ot">&lt;-</span> ns_biofilm_bd <span class="sc">%&gt;%</span></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(bd_location <span class="sc">==</span> <span class="st">"biofilm"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">log_qty =</span> <span class="fu">log</span>(bd_qty <span class="sc">+</span><span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pairwise_t_test</span>(</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>    log_qty <span class="sc">~</span> day, <span class="at">paired =</span> <span class="cn">TRUE</span>,</span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">p.adjust.method =</span> <span class="st">"bonferroni"</span></span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a>pwc</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 10
  .y.     group1 group2    n1    n2 statistic    df       p   p.adj p.adj.signif
* &lt;chr&gt;   &lt;chr&gt;  &lt;chr&gt;  &lt;int&gt; &lt;int&gt;     &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt;       
1 log_qty Day_0  Day_1      9     9     -5.82     8 3.94e-4 1   e-3 **          
2 log_qty Day_0  Day_7      9     9      1.04     8 3.29e-1 9.87e-1 ns          
3 log_qty Day_1  Day_7      9     9     10.1      8 7.86e-6 2.36e-5 ****        </code></pre>
</div>
</div>
</section>
<section id="q3-in-supernatant-is-there-a-diff-across-days-0-1-7" class="level3">
<h3 class="anchored" data-anchor-id="q3-in-supernatant-is-there-a-diff-across-days-0-1-7">Q3: In supernatant, is there a diff across days 0, 1, 7?</h3>
<p><strong>There is a significant difference in the amount of log Bd in the supernatant across the days (p = 5.15e-10). Day 0 and Day 1 differ (p = 2.06e-05), Day 1 and Day 7 differ (p = 3.75e-04 ), and Day 0 and Day 7 differ (p = 3.36e-06 )</strong></p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>s_only <span class="ot">&lt;-</span> ns_biofilm_bd <span class="sc">%&gt;%</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(bd_location <span class="sc">==</span> <span class="st">"supernatant"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">log_qty =</span> <span class="fu">log</span>(bd_qty))</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a><span class="co"># assumptions</span></span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>s_only <span class="sc">%&gt;%</span></span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(day) <span class="sc">%&gt;%</span></span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">shapiro_test</span>(log_qty) <span class="co">#passes</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 4
  day   variable statistic     p
  &lt;fct&gt; &lt;chr&gt;        &lt;dbl&gt; &lt;dbl&gt;
1 Day_0 log_qty      0.955 0.740
2 Day_1 log_qty      0.891 0.204
3 Day_7 log_qty      0.987 0.990</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># anova</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>res.aov <span class="ot">&lt;-</span> <span class="fu">anova_test</span>(<span class="at">data =</span> s_only, <span class="at">dv =</span> log_qty, <span class="at">wid =</span> site, <span class="at">within =</span> day)</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a><span class="fu">get_anova_table</span>(res.aov) <span class="co"># ges is the generalized effect size (amount of variability due to the within-subjects factor)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>ANOVA Table (type III tests)

  Effect DFn DFd       F        p p&lt;.05   ges
1    day   2  16 107.912 5.15e-10     * 0.903</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co"># post hoc pairwise comparison: pairwise ttest with bonferroni correction</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>pwc <span class="ot">&lt;-</span>s_only <span class="sc">%&gt;%</span></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pairwise_t_test</span>(</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>    log_qty <span class="sc">~</span> day, <span class="at">paired =</span> <span class="cn">TRUE</span>,</span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">p.adjust.method =</span> <span class="st">"bonferroni"</span></span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>pwc</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 10
  .y.     group1 group2    n1    n2 statistic    df       p   p.adj p.adj.signif
* &lt;chr&gt;   &lt;chr&gt;  &lt;chr&gt;  &lt;int&gt; &lt;int&gt;     &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt;       
1 log_qty Day_0  Day_1      9     9     10.3      8 6.86e-6 2.06e-5 ****        
2 log_qty Day_0  Day_7      9     9     13.1      8 1.12e-6 3.36e-6 ****        
3 log_qty Day_1  Day_7      9     9      6.90     8 1.25e-4 3.75e-4 ***         </code></pre>
</div>
</div>
</section>
</section>
<section id="discuss-with-group-normality-assumption-how-would-we-want-to-structure-a-glm-type-model-to-properly-account-for-site-while-accounting-for-the-paired-apsect-of-the-experiment" class="level2">
<h2 class="anchored" data-anchor-id="discuss-with-group-normality-assumption-how-would-we-want-to-structure-a-glm-type-model-to-properly-account-for-site-while-accounting-for-the-paired-apsect-of-the-experiment">Discuss with group: normality assumption, how would we want to structure a glm type model to properly account for site while accounting for the “paired” apsect of the experiment?</h2>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>